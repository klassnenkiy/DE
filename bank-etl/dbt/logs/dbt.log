[0m22:06:07.574642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34588c6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3458a64390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34588c6990>]}


============================== 22:06:07.595597 | f4d173ec-8614-4f54-ab95-3745f3db2653 ==============================
[0m22:06:07.595597 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:06:07.596905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'send_anonymous_usage_stats': 'True'}
[0m22:06:07.857384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34587f8050>]}
[0m22:06:07.897934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345a4540d0>]}
[0m22:06:07.900245 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:06:07.912132 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:06:07.915071 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:06:07.915943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345867ce90>]}
[0m22:06:08.943326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3457dfc310>]}
[0m22:06:09.034993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34586b8ed0>]}
[0m22:06:09.036047 [info ] [MainThread]: Found 10 models, 4 sources, 424 macros
[0m22:06:09.036888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3457998e50>]}
[0m22:06:09.039118 [info ] [MainThread]: 
[0m22:06:09.040205 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:09.044401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:06:09.045268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:06:09.085102 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:06:09.085533 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:06:09.086530 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:06:09.087521 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:06:09.088521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:09.089257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:09.097997 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m22:06:09.098439 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m22:06:09.099909 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:06:09.101350 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:06:09.103058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now create_bank_dwh_public_ods)
[0m22:06:09.103395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now create_bank_dwh_public_raw)
[0m22:06:09.104099 [debug] [ThreadPool]: Creating schema "database: "bank_dwh"
schema: "public_ods"
"
[0m22:06:09.104946 [debug] [ThreadPool]: Creating schema "database: "bank_dwh"
schema: "public_raw"
"
[0m22:06:09.109375 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:06:09.111761 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:06:09.112486 [debug] [ThreadPool]: On create_bank_dwh_public_ods: BEGIN
[0m22:06:09.113161 [debug] [ThreadPool]: On create_bank_dwh_public_raw: BEGIN
[0m22:06:09.113792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.114533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.119971 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:09.120643 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:09.121111 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:06:09.121802 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:06:09.122479 [debug] [ThreadPool]: On create_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "create_bank_dwh_public_ods"} */
create schema if not exists "public_ods"
[0m22:06:09.123227 [debug] [ThreadPool]: On create_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "create_bank_dwh_public_raw"} */
create schema if not exists "public_raw"
[0m22:06:09.125616 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m22:06:09.125875 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.002 seconds
[0m22:06:09.126827 [debug] [ThreadPool]: On create_bank_dwh_public_ods: COMMIT
[0m22:06:09.127926 [debug] [ThreadPool]: On create_bank_dwh_public_raw: COMMIT
[0m22:06:09.128638 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:06:09.129386 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:06:09.130187 [debug] [ThreadPool]: On create_bank_dwh_public_ods: COMMIT
[0m22:06:09.130848 [debug] [ThreadPool]: On create_bank_dwh_public_raw: COMMIT
[0m22:06:09.132510 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.133121 [debug] [ThreadPool]: On create_bank_dwh_public_ods: Close
[0m22:06:09.133424 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m22:06:09.134504 [debug] [ThreadPool]: On create_bank_dwh_public_raw: Close
[0m22:06:09.136663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bank_dwh_public_raw, now list_bank_dwh_public_ods)
[0m22:06:09.137400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bank_dwh_public_ods, now list_bank_dwh_public_raw)
[0m22:06:09.141993 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:06:09.143975 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:06:09.144755 [debug] [ThreadPool]: On list_bank_dwh_public_ods: BEGIN
[0m22:06:09.145532 [debug] [ThreadPool]: On list_bank_dwh_public_raw: BEGIN
[0m22:06:09.146225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.146925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:09.152189 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:09.152509 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:09.153155 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:06:09.153902 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:06:09.154645 [debug] [ThreadPool]: On list_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_ods"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m22:06:09.155421 [debug] [ThreadPool]: On list_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_raw"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m22:06:09.164074 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m22:06:09.164469 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.008 seconds
[0m22:06:09.166040 [debug] [ThreadPool]: On list_bank_dwh_public_raw: ROLLBACK
[0m22:06:09.167535 [debug] [ThreadPool]: On list_bank_dwh_public_ods: ROLLBACK
[0m22:06:09.168500 [debug] [ThreadPool]: On list_bank_dwh_public_raw: Close
[0m22:06:09.169056 [debug] [ThreadPool]: On list_bank_dwh_public_ods: Close
[0m22:06:09.174349 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.175373 [debug] [MainThread]: On master: BEGIN
[0m22:06:09.176221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:09.182244 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:06:09.183209 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.183984 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:06:09.194261 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m22:06:09.196230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34586b9f90>]}
[0m22:06:09.197310 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:09.198251 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.199000 [debug] [MainThread]: On master: BEGIN
[0m22:06:09.199952 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:06:09.200613 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.201363 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.202062 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.202908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:09.203595 [debug] [MainThread]: On master: Close
[0m22:06:09.204491 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:09.205284 [info ] [MainThread]: 
[0m22:06:09.214096 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m22:06:09.214557 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_card
[0m22:06:09.214944 [debug] [Thread-3 (]: Began running node model.bank_dwh.raw_customer
[0m22:06:09.215366 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_terminal
[0m22:06:09.216044 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_raw.raw_account ..................... [RUN]
[0m22:06:09.217006 [info ] [Thread-2 (]: 2 of 10 START sql incremental model public_raw.raw_card ........................ [RUN]
[0m22:06:09.217851 [info ] [Thread-3 (]: 3 of 10 START sql incremental model public_raw.raw_customer .................... [RUN]
[0m22:06:09.218695 [info ] [Thread-4 (]: 4 of 10 START sql incremental model public_raw.raw_terminal .................... [RUN]
[0m22:06:09.219632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_ods, now model.bank_dwh.raw_account)
[0m22:06:09.220461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_raw, now model.bank_dwh.raw_card)
[0m22:06:09.221312 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bank_dwh.raw_customer'
[0m22:06:09.222079 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bank_dwh.raw_terminal'
[0m22:06:09.222960 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m22:06:09.223692 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_card
[0m22:06:09.224481 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.raw_customer
[0m22:06:09.225213 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_terminal
[0m22:06:09.231673 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m22:06:09.234538 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m22:06:09.237046 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m22:06:09.239583 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m22:06:09.248857 [debug] [Thread-3 (]: Began executing node model.bank_dwh.raw_customer
[0m22:06:09.255104 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m22:06:09.287834 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_terminal
[0m22:06:09.293907 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_card
[0m22:06:09.301724 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m22:06:09.302907 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m22:06:09.306521 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m22:06:09.310432 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m22:06:09.319445 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:09.320468 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: BEGIN
[0m22:06:09.320883 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:09.321612 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:06:09.322352 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:09.322918 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:09.323377 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: BEGIN
[0m22:06:09.325054 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: BEGIN
[0m22:06:09.325939 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: BEGIN
[0m22:06:09.326847 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:09.327855 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:09.328751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:09.330142 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:06:09.332325 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:09.334047 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_terminal"
  
  
    as
  
  (
    

select
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  created_at,
  updated_at,
  is_working,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."terminal_snapshot"
  );
  
  
[0m22:06:09.336264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:06:09.337037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:06:09.337486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m22:06:09.337833 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:09.338578 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:09.339318 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:09.340122 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_customer"
  
  
    as
  
  (
    

select
  customer_id,
  customer_uuid,
  full_name,
  birth_date,
  email,
  phone,
  city,
  created_at,
  updated_at,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."customer_snapshot"
  );
  
  
[0m22:06:09.340530 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.006 seconds
[0m22:06:09.341190 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_account"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'account_id')::bigint as account_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'account'
  
),
latest as (
  select distinct on (account_id)
    account_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by account_id, event_id desc
)
select
  account_id,
  row_data->>'account_number' as account_number,
  (row_data->>'customer_id')::bigint as customer_id,
  row_data->>'currency_code' as currency_code,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  row_data->>'status' as status,
  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:06:09.341962 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_card"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'card_id')::bigint as card_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'card'
  
),
latest as (
  select distinct on (card_id)
    card_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by card_id, event_id desc
)
select
  card_id,
  row_data->>'card_number' as card_number,
  (row_data->>'account_id')::bigint as account_id,
  row_data->>'status' as status,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:06:09.348439 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.006 seconds
[0m22:06:09.358196 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:06:09.362177 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:06:09.363106 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:09.363976 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:09.364772 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:06:09.365690 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0.006 seconds
[0m22:06:09.366054 [debug] [Thread-2 (]: SQL status: SELECT 160 in 0.006 seconds
[0m22:06:09.366557 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:06:09.369543 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:06:09.369917 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:06:09.371545 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:06:09.373011 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:09.373398 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.375205 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: Close
[0m22:06:09.376047 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:09.376813 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:06:09.377920 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: Close
[0m22:06:09.379852 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34586d65d0>]}
[0m22:06:09.380495 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:06:09.381922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3456d2e910>]}
[0m22:06:09.382275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.382944 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model public_raw.raw_terminal ............... [[32mSELECT 10[0m in 0.16s]
[0m22:06:09.384627 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model public_raw.raw_customer ............... [[32mSELECT 50[0m in 0.16s]
[0m22:06:09.385061 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.386038 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: Close
[0m22:06:09.386988 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_terminal
[0m22:06:09.387849 [debug] [Thread-3 (]: Finished running node model.bank_dwh.raw_customer
[0m22:06:09.388938 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: Close
[0m22:06:09.389976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3456533f10>]}
[0m22:06:09.391927 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_transaction
[0m22:06:09.392929 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_terminal
[0m22:06:09.394019 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345650e350>]}
[0m22:06:09.394849 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_raw.raw_account ................ [[32mSELECT 80[0m in 0.17s]
[0m22:06:09.395869 [info ] [Thread-4 (]: 5 of 10 START sql incremental model public_raw.raw_transaction ................. [RUN]
[0m22:06:09.396755 [info ] [Thread-3 (]: 6 of 10 START sql table model public_ods.dim_terminal .......................... [RUN]
[0m22:06:09.397796 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model public_raw.raw_card ................... [[32mSELECT 160[0m in 0.17s]
[0m22:06:09.398773 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m22:06:09.399691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m22:06:09.400547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.dim_terminal)
[0m22:06:09.401452 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_card
[0m22:06:09.402230 [debug] [Thread-1 (]: Began running node model.bank_dwh.dim_customer_scd2
[0m22:06:09.403109 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_transaction
[0m22:06:09.403935 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_terminal
[0m22:06:09.404749 [debug] [Thread-2 (]: Began running node model.bank_dwh.dim_account
[0m22:06:09.405677 [info ] [Thread-1 (]: 7 of 10 START sql table model public_ods.dim_customer_scd2 ..................... [RUN]
[0m22:06:09.408727 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m22:06:09.411648 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_terminal"
[0m22:06:09.412571 [info ] [Thread-2 (]: 8 of 10 START sql table model public_ods.dim_account ........................... [RUN]
[0m22:06:09.413468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.dim_customer_scd2)
[0m22:06:09.415300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.dim_account)
[0m22:06:09.416101 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.dim_customer_scd2
[0m22:06:09.416945 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.dim_account
[0m22:06:09.419838 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.423075 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.dim_account"
[0m22:06:09.423467 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_terminal
[0m22:06:09.423877 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_transaction
[0m22:06:09.435013 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_terminal"
[0m22:06:09.440148 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m22:06:09.441540 [debug] [Thread-1 (]: Began executing node model.bank_dwh.dim_customer_scd2
[0m22:06:09.441922 [debug] [Thread-2 (]: Began executing node model.bank_dwh.dim_account
[0m22:06:09.445647 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.449738 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.dim_account"
[0m22:06:09.451358 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:09.452652 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:09.453040 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: BEGIN
[0m22:06:09.454006 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: BEGIN
[0m22:06:09.454434 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.455055 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:09.455407 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:06:09.456258 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:09.457190 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: BEGIN
[0m22:06:09.457971 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: BEGIN
[0m22:06:09.459997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:09.460820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:09.464471 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:06:09.465269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:06:09.466084 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:09.466710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:06:09.467214 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:09.467516 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:06:09.468139 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_transaction"
  
  
    as
  
  (
    

select
  txn_id,
  card_id,
  terminal_id,
  txn_ts,
  amount,
  currency_code,
  txn_type,
  status,
  etl_upload_dttm
from "bank_dwh"."stg"."transaction_increment"
  );
  
  
[0m22:06:09.468963 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.469708 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp"
  
  
    as
  
  (
    

with x as (
  select
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    etl_upload_dttm,
    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn
  from "bank_dwh"."public_raw"."raw_terminal"
)
select
  md5(terminal_id::text) as terminal_sk,
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  is_working,
  is_deleted,
  etl_upload_dttm as asof_dttm
from x
where rn = 1
  );
  
[0m22:06:09.470637 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:09.471884 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm,
    md5(
      coalesce(customer_uuid::text,'') || '|' ||
      coalesce(full_name,'') || '|' ||
      coalesce(birth_date::text,'') || '|' ||
      coalesce(email,'') || '|' ||
      coalesce(phone,'') || '|' ||
      coalesce(city,'') || '|' ||
      coalesce(is_deleted::text,'')
    ) as diff
  from "bank_dwh"."public_raw"."raw_customer"
),
chg as (
  select
    *,
    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff
  from base
),
filt as (
  select
    *
  from chg
  where prev_diff is distinct from diff
),
scd as (
  select
    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm as valid_from,
    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,
    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current
  from filt
)
select * from scd
  );
  
[0m22:06:09.473115 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_account__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(account_id::text) as account_sk,
  account_id,
  account_number,
  customer_id,
  currency_code,
  opened_at,
  closed_at,
  status,
  daily_transfer_limit,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_account"
  );
  
[0m22:06:09.474402 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.003 seconds
[0m22:06:09.476252 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:06:09.477061 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:09.477844 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:06:09.478225 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.006 seconds
[0m22:06:09.478545 [debug] [Thread-2 (]: SQL status: SELECT 80 in 0.004 seconds
[0m22:06:09.479350 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m22:06:09.484180 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:09.484579 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m22:06:09.487425 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:09.489936 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.490757 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp" rename to "dim_terminal"
[0m22:06:09.491765 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: Close
[0m22:06:09.492611 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account__dbt_tmp" rename to "dim_account"
[0m22:06:09.493357 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp" rename to "dim_customer_scd2"
[0m22:06:09.494783 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345694ddd0>]}
[0m22:06:09.495211 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:06:09.495992 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:09.496697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:09.497396 [info ] [Thread-4 (]: 5 of 10 OK created sql incremental model public_raw.raw_transaction ............ [[32mSELECT 0[0m in 0.10s]
[0m22:06:09.499153 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:06:09.500935 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:06:09.502532 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:06:09.503436 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_transaction
[0m22:06:09.504242 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:09.504985 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:09.505676 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.506521 [debug] [Thread-4 (]: Began running node model.bank_dwh.dim_card
[0m22:06:09.507282 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:06:09.508031 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:06:09.508755 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:06:09.509547 [info ] [Thread-4 (]: 9 of 10 START sql table model public_ods.dim_card .............................. [RUN]
[0m22:06:09.511328 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.511920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.512426 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_transaction, now model.bank_dwh.dim_card)
[0m22:06:09.512771 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.517926 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_terminal__dbt_backup"
[0m22:06:09.520498 [debug] [Thread-2 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_account__dbt_backup"
[0m22:06:09.521287 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.dim_card
[0m22:06:09.523351 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup"
[0m22:06:09.528016 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:09.529168 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:09.531656 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.dim_card"
[0m22:06:09.532742 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:09.533507 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
drop table if exists "bank_dwh"."public_ods"."dim_terminal__dbt_backup" cascade
[0m22:06:09.534259 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
drop table if exists "bank_dwh"."public_ods"."dim_account__dbt_backup" cascade
[0m22:06:09.535596 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
drop table if exists "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup" cascade
[0m22:06:09.537064 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:06:09.537395 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:06:09.538088 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:06:09.539370 [debug] [Thread-2 (]: On model.bank_dwh.dim_account: Close
[0m22:06:09.541083 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: Close
[0m22:06:09.541502 [debug] [Thread-4 (]: Began executing node model.bank_dwh.dim_card
[0m22:06:09.542850 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: Close
[0m22:06:09.543903 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3456948590>]}
[0m22:06:09.544835 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3457900850>]}
[0m22:06:09.549374 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.dim_card"
[0m22:06:09.550582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34565f7290>]}
[0m22:06:09.551486 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public_ods.dim_account ...................... [[32mSELECT 80[0m in 0.13s]
[0m22:06:09.552462 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public_ods.dim_terminal ..................... [[32mSELECT 10[0m in 0.14s]
[0m22:06:09.553836 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public_ods.dim_customer_scd2 ................ [[32mSELECT 50[0m in 0.14s]
[0m22:06:09.554655 [debug] [Thread-2 (]: Finished running node model.bank_dwh.dim_account
[0m22:06:09.555576 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_terminal
[0m22:06:09.556372 [debug] [Thread-1 (]: Finished running node model.bank_dwh.dim_customer_scd2
[0m22:06:09.558236 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:09.559096 [debug] [Thread-2 (]: Began running node model.bank_dwh.fct_transactions
[0m22:06:09.559578 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: BEGIN
[0m22:06:09.560475 [info ] [Thread-2 (]: 10 of 10 START sql table model public_ods.fct_transactions ..................... [RUN]
[0m22:06:09.561320 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:06:09.562153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_account, now model.bank_dwh.fct_transactions)
[0m22:06:09.563515 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.fct_transactions
[0m22:06:09.567096 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.fct_transactions"
[0m22:06:09.567993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:06:09.568957 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:09.569669 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_card__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(card_id::text) as card_sk,
  card_id,
  card_number,
  account_id,
  status,
  opened_at,
  closed_at,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_card"
  );
  
[0m22:06:09.573273 [debug] [Thread-2 (]: Began executing node model.bank_dwh.fct_transactions
[0m22:06:09.573873 [debug] [Thread-4 (]: SQL status: SELECT 160 in 0.004 seconds
[0m22:06:09.576860 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.fct_transactions"
[0m22:06:09.579671 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:09.581076 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card__dbt_tmp" rename to "dim_card"
[0m22:06:09.582172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:09.583883 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:06:09.584614 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:09.585493 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:06:09.585970 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:09.587042 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: BEGIN
[0m22:06:09.587567 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.588006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:09.590597 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_card__dbt_backup"
[0m22:06:09.592685 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:09.593548 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
drop table if exists "bank_dwh"."public_ods"."dim_card__dbt_backup" cascade
[0m22:06:09.594550 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:06:09.596148 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: Close
[0m22:06:09.596779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m22:06:09.597588 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34586d65d0>]}
[0m22:06:09.598218 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:09.599160 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public_ods.dim_card ......................... [[32mSELECT 160[0m in 0.09s]
[0m22:06:09.599977 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */

  
    

  create  table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp"
  
  
    as
  
  (
    

with t as (
  select
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status
  from "bank_dwh"."public_raw"."raw_transaction"
),
c as (
  select card_id, md5(card_id::text) as card_sk, account_id
  from "bank_dwh"."public_raw"."raw_card"
  where is_deleted = false
),
a as (
  select account_id, md5(account_id::text) as account_sk, customer_id
  from "bank_dwh"."public_raw"."raw_account"
  where is_deleted = false
),
cust as (
  select customer_id, customer_sk
  from "bank_dwh"."public_ods"."dim_customer_scd2"
  where is_current = true
),
term as (
  select terminal_id, terminal_sk
  from "bank_dwh"."public_ods"."dim_terminal"
)
select
  t.txn_id,
  t.txn_ts,
  t.amount,
  t.currency_code,
  t.txn_type,
  t.status,
  c.card_sk,
  a.account_sk,
  cust.customer_sk,
  term.terminal_sk
from t
left join c on c.card_id = t.card_id
left join a on a.account_id = c.account_id
left join cust on cust.customer_id = a.customer_id
left join term on term.terminal_id = t.terminal_id
  );
  
[0m22:06:09.600946 [debug] [Thread-4 (]: Finished running node model.bank_dwh.dim_card
[0m22:06:09.605473 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m22:06:09.608344 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:09.609086 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp" rename to "fct_transactions"
[0m22:06:09.609951 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:09.611586 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:06:09.612217 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:09.612964 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:06:09.614621 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:09.616781 [debug] [Thread-2 (]: Applying DROP to: "bank_dwh"."public_ods"."fct_transactions__dbt_backup"
[0m22:06:09.617801 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:09.618465 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
drop table if exists "bank_dwh"."public_ods"."fct_transactions__dbt_backup" cascade
[0m22:06:09.619318 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:06:09.620645 [debug] [Thread-2 (]: On model.bank_dwh.fct_transactions: Close
[0m22:06:09.621514 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4d173ec-8614-4f54-ab95-3745f3db2653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34565f5110>]}
[0m22:06:09.622299 [info ] [Thread-2 (]: 10 of 10 OK created sql table model public_ods.fct_transactions ................ [[32mSELECT 0[0m in 0.06s]
[0m22:06:09.623230 [debug] [Thread-2 (]: Finished running node model.bank_dwh.fct_transactions
[0m22:06:09.625305 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.626081 [debug] [MainThread]: On master: BEGIN
[0m22:06:09.626803 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:09.632025 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:06:09.632844 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.633615 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:09.634245 [debug] [MainThread]: On master: COMMIT
[0m22:06:09.635064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:09.635746 [debug] [MainThread]: On master: Close
[0m22:06:09.636507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:09.637113 [debug] [MainThread]: Connection 'model.bank_dwh.dim_customer_scd2' was properly closed.
[0m22:06:09.638508 [debug] [MainThread]: Connection 'model.bank_dwh.fct_transactions' was properly closed.
[0m22:06:09.639237 [debug] [MainThread]: Connection 'model.bank_dwh.dim_terminal' was properly closed.
[0m22:06:09.639939 [debug] [MainThread]: Connection 'model.bank_dwh.dim_card' was properly closed.
[0m22:06:09.640718 [info ] [MainThread]: 
[0m22:06:09.641470 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m22:06:09.643184 [debug] [MainThread]: Command end result
[0m22:06:09.678670 [info ] [MainThread]: 
[0m22:06:09.679708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:09.680666 [info ] [MainThread]: 
[0m22:06:09.681479 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m22:06:09.683217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.161492, "process_user_time": 3.057199, "process_kernel_time": 0.621056, "process_mem_max_rss": "196228", "process_in_blocks": "76592", "process_out_blocks": "4152"}
[0m22:06:09.684151 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:09.684046 after 2.16 seconds
[0m22:06:09.684955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3458747c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3459d4dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345c5475d0>]}
[0m22:06:09.685824 [debug] [MainThread]: Flushing usage events
[0m22:06:20.679039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa3670b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa3671f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa3671650>]}


============================== 22:06:20.684366 | b3d28e3c-214c-498c-9a63-651017e55b95 ==============================
[0m22:06:20.684366 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:06:20.685456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:20.831220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa367ce50>]}
[0m22:06:20.869077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa3641650>]}
[0m22:06:20.870827 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:06:20.880710 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:06:21.060277 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:06:21.061303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:06:21.086686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa34e04d0>]}
[0m22:06:21.167002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa1d39690>]}
[0m22:06:21.167960 [info ] [MainThread]: Found 10 models, 4 sources, 424 macros
[0m22:06:21.168759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa253b190>]}
[0m22:06:21.170976 [info ] [MainThread]: 
[0m22:06:21.172025 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:06:21.176131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:06:21.176798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:06:21.206901 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:06:21.207306 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:06:21.208092 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:06:21.208950 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:06:21.209986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.210683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:21.217372 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m22:06:21.217798 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m22:06:21.219237 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:06:21.220720 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:06:21.223332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_raw)
[0m22:06:21.223885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_ods)
[0m22:06:21.228696 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:06:21.230623 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:06:21.231420 [debug] [ThreadPool]: On list_bank_dwh_public_raw: BEGIN
[0m22:06:21.232126 [debug] [ThreadPool]: On list_bank_dwh_public_ods: BEGIN
[0m22:06:21.232804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.233504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:21.239286 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:21.239942 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:06:21.240440 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:06:21.241180 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:06:21.241813 [debug] [ThreadPool]: On list_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_raw"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m22:06:21.242547 [debug] [ThreadPool]: On list_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_ods"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m22:06:21.245406 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:06:21.245763 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:06:21.247138 [debug] [ThreadPool]: On list_bank_dwh_public_raw: ROLLBACK
[0m22:06:21.248734 [debug] [ThreadPool]: On list_bank_dwh_public_ods: ROLLBACK
[0m22:06:21.249684 [debug] [ThreadPool]: On list_bank_dwh_public_raw: Close
[0m22:06:21.250345 [debug] [ThreadPool]: On list_bank_dwh_public_ods: Close
[0m22:06:21.256183 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.257024 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.257675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:21.263114 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:06:21.263882 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.264642 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:06:21.267759 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m22:06:21.269269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa1d85510>]}
[0m22:06:21.270056 [debug] [MainThread]: On master: ROLLBACK
[0m22:06:21.270904 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.271492 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.272569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.273276 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.273938 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.274602 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.275401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:21.276047 [debug] [MainThread]: On master: Close
[0m22:06:21.276910 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:21.277585 [info ] [MainThread]: 
[0m22:06:21.285392 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m22:06:21.285860 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_card
[0m22:06:21.286234 [debug] [Thread-3 (]: Began running node model.bank_dwh.raw_customer
[0m22:06:21.286641 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_terminal
[0m22:06:21.287270 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_raw.raw_account ..................... [RUN]
[0m22:06:21.288236 [info ] [Thread-2 (]: 2 of 10 START sql incremental model public_raw.raw_card ........................ [RUN]
[0m22:06:21.289105 [info ] [Thread-3 (]: 3 of 10 START sql incremental model public_raw.raw_customer .................... [RUN]
[0m22:06:21.289956 [info ] [Thread-4 (]: 4 of 10 START sql incremental model public_raw.raw_terminal .................... [RUN]
[0m22:06:21.290919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_ods, now model.bank_dwh.raw_account)
[0m22:06:21.291662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_raw, now model.bank_dwh.raw_card)
[0m22:06:21.292537 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bank_dwh.raw_customer'
[0m22:06:21.293372 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bank_dwh.raw_terminal'
[0m22:06:21.294155 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m22:06:21.294866 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_card
[0m22:06:21.295579 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.raw_customer
[0m22:06:21.296326 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_terminal
[0m22:06:21.307436 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m22:06:21.310436 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m22:06:21.313248 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m22:06:21.315834 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m22:06:21.319826 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_card
[0m22:06:21.320253 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m22:06:21.320978 [debug] [Thread-3 (]: Began executing node model.bank_dwh.raw_customer
[0m22:06:21.326524 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_terminal
[0m22:06:21.368188 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.370341 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.373831 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.377654 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.378774 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    
  
    

  create temporary table "raw_account__dbt_tmp220621350516"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'account_id')::bigint as account_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'account'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_account")
  
),
latest as (
  select distinct on (account_id)
    account_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by account_id, event_id desc
)
select
  account_id,
  row_data->>'account_number' as account_number,
  (row_data->>'customer_id')::bigint as customer_id,
  row_data->>'currency_code' as currency_code,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  row_data->>'status' as status,
  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:06:21.379780 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    
  
    

  create temporary table "raw_card__dbt_tmp220621343020"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'card_id')::bigint as card_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'card'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_card")
  
),
latest as (
  select distinct on (card_id)
    card_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by card_id, event_id desc
)
select
  card_id,
  row_data->>'card_number' as card_number,
  (row_data->>'account_id')::bigint as account_id,
  row_data->>'status' as status,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:06:21.380673 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    
  
    

  create temporary table "raw_customer__dbt_tmp220621372456"
  
  
    as
  
  (
    

select
  customer_id,
  customer_uuid,
  full_name,
  birth_date,
  email,
  phone,
  city,
  created_at,
  updated_at,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."customer_snapshot"
  );
  
  
[0m22:06:21.381664 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    
  
    

  create temporary table "raw_terminal__dbt_tmp220621376353"
  
  
    as
  
  (
    

select
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  created_at,
  updated_at,
  is_working,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."terminal_snapshot"
  );
  
  
[0m22:06:21.382516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.383371 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:21.384268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:21.385118 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:06:21.393294 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.009 seconds
[0m22:06:21.394633 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.009 seconds
[0m22:06:21.394971 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m22:06:21.395311 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.012 seconds
[0m22:06:21.407320 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.410265 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.413159 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.415613 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.416424 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: BEGIN
[0m22:06:21.417182 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: BEGIN
[0m22:06:21.417970 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: BEGIN
[0m22:06:21.418663 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: BEGIN
[0m22:06:21.419722 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.420270 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.420903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.421679 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.422260 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.423040 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.423795 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.424530 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.425320 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer__dbt_tmp220621372456'
        
      order by ordinal_position

  
[0m22:06:21.426081 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal__dbt_tmp220621376353'
        
      order by ordinal_position

  
[0m22:06:21.426790 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_account__dbt_tmp220621350516'
        
      order by ordinal_position

  
[0m22:06:21.427506 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_card__dbt_tmp220621343020'
        
      order by ordinal_position

  
[0m22:06:21.447105 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.017 seconds
[0m22:06:21.447718 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.019 seconds
[0m22:06:21.448187 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.020 seconds
[0m22:06:21.448544 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.019 seconds
[0m22:06:21.453309 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.456395 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.459166 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.461902 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.462723 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.463522 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.464299 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.465074 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.468129 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:06:21.476790 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.477212 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.008 seconds
[0m22:06:21.477560 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.008 seconds
[0m22:06:21.477904 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.009 seconds
[0m22:06:21.478596 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.481441 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.484146 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.486838 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.489521 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:06:21.490218 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.491013 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.491785 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.503478 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m22:06:21.506594 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.002 seconds
[0m22:06:21.506998 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.002 seconds
[0m22:06:21.507356 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.002 seconds
[0m22:06:21.509284 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m22:06:21.511385 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m22:06:21.511792 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.513724 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m22:06:21.515560 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_card"
            where (
                card_id) in (
                select (card_id)
                from "raw_card__dbt_tmp220621343020"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_card" ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_card__dbt_tmp220621343020"
    )
  
[0m22:06:21.517507 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:06:21.518155 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.571839 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.572313 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.579246 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:06:21.580152 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_customer"
            using "raw_customer__dbt_tmp220621372456"
            where (
                
                    "raw_customer__dbt_tmp220621372456".customer_id = "bank_dwh"."public_raw"."raw_customer".customer_id
                    and 
                
                    "raw_customer__dbt_tmp220621372456".batch_id = "bank_dwh"."public_raw"."raw_customer".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_customer" ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_customer__dbt_tmp220621372456"
    )
  
[0m22:06:21.581473 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_terminal"
            using "raw_terminal__dbt_tmp220621376353"
            where (
                
                    "raw_terminal__dbt_tmp220621376353".terminal_id = "bank_dwh"."public_raw"."raw_terminal".terminal_id
                    and 
                
                    "raw_terminal__dbt_tmp220621376353".batch_id = "bank_dwh"."public_raw"."raw_terminal".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_terminal" ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_terminal__dbt_tmp220621376353"
    )
  
[0m22:06:21.582526 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_account"
            where (
                account_id) in (
                select (account_id)
                from "raw_account__dbt_tmp220621350516"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_account" ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_account__dbt_tmp220621350516"
    )
  
[0m22:06:21.583342 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:06:21.585288 [debug] [Thread-3 (]: SQL status: INSERT 0 50 in 0.001 seconds
[0m22:06:21.585666 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m22:06:21.585984 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:06:21.586508 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:06:21.588207 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:06:21.589931 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:06:21.591532 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:06:21.592880 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:06:21.593725 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:06:21.594425 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:06:21.594778 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:06:21.595564 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:06:21.596264 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:06:21.598147 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: Close
[0m22:06:21.598942 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:06:21.600567 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.601875 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a9969ee50>]}
[0m22:06:21.602206 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m22:06:21.603635 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: Close
[0m22:06:21.603952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.604726 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model public_raw.raw_card ................... [[32mINSERT 0 0[0m in 0.31s]
[0m22:06:21.605777 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: Close
[0m22:06:21.606693 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa0140f90>]}
[0m22:06:21.607567 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: Close
[0m22:06:21.608404 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_card
[0m22:06:21.609352 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a99676d90>]}
[0m22:06:21.610182 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model public_raw.raw_customer ............... [[32mINSERT 0 50[0m in 0.31s]
[0m22:06:21.611158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a99676d50>]}
[0m22:06:21.611920 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_transaction
[0m22:06:21.613068 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model public_raw.raw_terminal ............... [[32mINSERT 0 10[0m in 0.32s]
[0m22:06:21.613765 [debug] [Thread-3 (]: Finished running node model.bank_dwh.raw_customer
[0m22:06:21.614691 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_raw.raw_account ................ [[32mINSERT 0 0[0m in 0.32s]
[0m22:06:21.615569 [info ] [Thread-2 (]: 5 of 10 START sql incremental model public_raw.raw_transaction ................. [RUN]
[0m22:06:21.616435 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_terminal
[0m22:06:21.617212 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_card
[0m22:06:21.618245 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m22:06:21.619048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.raw_transaction)
[0m22:06:21.619932 [debug] [Thread-4 (]: Began running node model.bank_dwh.dim_customer_scd2
[0m22:06:21.620767 [info ] [Thread-3 (]: 6 of 10 START sql table model public_ods.dim_card .............................. [RUN]
[0m22:06:21.621655 [debug] [Thread-1 (]: Began running node model.bank_dwh.dim_terminal
[0m22:06:21.622379 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_transaction
[0m22:06:21.623318 [info ] [Thread-4 (]: 7 of 10 START sql table model public_ods.dim_customer_scd2 ..................... [RUN]
[0m22:06:21.624222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.dim_card)
[0m22:06:21.625076 [info ] [Thread-1 (]: 8 of 10 START sql table model public_ods.dim_terminal .......................... [RUN]
[0m22:06:21.627888 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m22:06:21.628728 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.dim_customer_scd2)
[0m22:06:21.629514 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_card
[0m22:06:21.630300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.dim_terminal)
[0m22:06:21.631539 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.dim_customer_scd2
[0m22:06:21.634358 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_card"
[0m22:06:21.635204 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.dim_terminal
[0m22:06:21.637824 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.638884 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_transaction
[0m22:06:21.641228 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.dim_terminal"
[0m22:06:21.645532 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.646637 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_card
[0m22:06:21.647343 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    
  
    

  create temporary table "raw_transaction__dbt_tmp220621644083"
  
  
    as
  
  (
    

select
  txn_id,
  card_id,
  terminal_id,
  txn_ts,
  amount,
  currency_code,
  txn_type,
  status,
  etl_upload_dttm
from "bank_dwh"."stg"."transaction_increment"
  );
  
  
[0m22:06:21.647696 [debug] [Thread-4 (]: Began executing node model.bank_dwh.dim_customer_scd2
[0m22:06:21.653531 [debug] [Thread-1 (]: Began executing node model.bank_dwh.dim_terminal
[0m22:06:21.657759 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_card"
[0m22:06:21.658546 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:06:21.661746 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.664810 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.dim_terminal"
[0m22:06:21.668864 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.669389 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.670051 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: BEGIN
[0m22:06:21.670434 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.671205 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: BEGIN
[0m22:06:21.671964 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:06:21.672341 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.014 seconds
[0m22:06:21.672944 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: BEGIN
[0m22:06:21.673753 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:06:21.677048 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.677859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.679162 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:06:21.679500 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: BEGIN
[0m22:06:21.681272 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.682163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m22:06:21.682667 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm,
    md5(
      coalesce(customer_uuid::text,'') || '|' ||
      coalesce(full_name,'') || '|' ||
      coalesce(birth_date::text,'') || '|' ||
      coalesce(email,'') || '|' ||
      coalesce(phone,'') || '|' ||
      coalesce(city,'') || '|' ||
      coalesce(is_deleted::text,'')
    ) as diff
  from "bank_dwh"."public_raw"."raw_customer"
),
chg as (
  select
    *,
    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff
  from base
),
filt as (
  select
    *
  from chg
  where prev_diff is distinct from diff
),
scd as (
  select
    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm as valid_from,
    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,
    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current
  from filt
)
select * from scd
  );
  
[0m22:06:21.683360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m22:06:21.683836 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.684826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:06:21.685452 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.686232 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction__dbt_tmp220621644083'
        
      order by ordinal_position

  
[0m22:06:21.687056 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.687862 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_card__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(card_id::text) as card_sk,
  card_id,
  card_number,
  account_id,
  status,
  opened_at,
  closed_at,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_card"
  );
  
[0m22:06:21.689081 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp"
  
  
    as
  
  (
    

with x as (
  select
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    etl_upload_dttm,
    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn
  from "bank_dwh"."public_raw"."raw_terminal"
)
select
  md5(terminal_id::text) as terminal_sk,
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  is_working,
  is_deleted,
  etl_upload_dttm as asof_dttm
from x
where rn = 1
  );
  
[0m22:06:21.689465 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.005 seconds
[0m22:06:21.697014 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.697478 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.009 seconds
[0m22:06:21.697838 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m22:06:21.698199 [debug] [Thread-3 (]: SQL status: SELECT 160 in 0.008 seconds
[0m22:06:21.698712 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2" rename to "dim_customer_scd2__dbt_backup"
[0m22:06:21.701597 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.704246 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.707311 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.708530 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.708899 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.709655 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal" rename to "dim_terminal__dbt_backup"
[0m22:06:21.710446 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card" rename to "dim_card__dbt_backup"
[0m22:06:21.712937 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.714521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.715408 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.715742 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp" rename to "dim_customer_scd2"
[0m22:06:21.716130 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m22:06:21.718753 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.721580 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.722862 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.725216 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.726035 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp" rename to "dim_terminal"
[0m22:06:21.726869 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card__dbt_tmp" rename to "dim_card"
[0m22:06:21.732426 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:06:21.733202 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:06:21.734348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.734985 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.735482 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.737816 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:06:21.738160 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.002 seconds
[0m22:06:21.739954 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:06:21.740745 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:06:21.741572 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.743627 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m22:06:21.744365 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.745695 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:06:21.746410 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.747314 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:06:21.752804 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup"
[0m22:06:21.753254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:06:21.758268 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:06:21.758695 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m22:06:21.761037 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_terminal__dbt_backup"
[0m22:06:21.761852 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
drop table if exists "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup" cascade
[0m22:06:21.762209 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.764383 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_card__dbt_backup"
[0m22:06:21.765585 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:06:21.766942 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_transaction"
            where (
                txn_id) in (
                select (txn_id)
                from "raw_transaction__dbt_tmp220621644083"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_transaction" ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm")
    (
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm"
        from "raw_transaction__dbt_tmp220621644083"
    )
  
[0m22:06:21.768083 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:06:21.768440 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:06:21.769299 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
drop table if exists "bank_dwh"."public_ods"."dim_terminal__dbt_backup" cascade
[0m22:06:21.770631 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
drop table if exists "bank_dwh"."public_ods"."dim_card__dbt_backup" cascade
[0m22:06:21.770969 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:06:21.774102 [debug] [Thread-4 (]: On model.bank_dwh.dim_customer_scd2: Close
[0m22:06:21.776979 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:06:21.777391 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:06:21.777728 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:06:21.778616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa1577ed0>]}
[0m22:06:21.779233 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:06:21.780668 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: Close
[0m22:06:21.782196 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: Close
[0m22:06:21.783214 [info ] [Thread-4 (]: 7 of 10 OK created sql table model public_ods.dim_customer_scd2 ................ [[32mSELECT 50[0m in 0.15s]
[0m22:06:21.784071 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:06:21.785003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa35c06d0>]}
[0m22:06:21.785840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa38c8650>]}
[0m22:06:21.786602 [debug] [Thread-4 (]: Finished running node model.bank_dwh.dim_customer_scd2
[0m22:06:21.788441 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.788137 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public_ods.dim_terminal ..................... [[32mSELECT 10[0m in 0.15s]
[0m22:06:21.789333 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public_ods.dim_card ......................... [[32mSELECT 160[0m in 0.16s]
[0m22:06:21.790273 [debug] [Thread-4 (]: Began running node model.bank_dwh.dim_account
[0m22:06:21.791341 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: Close
[0m22:06:21.792169 [debug] [Thread-1 (]: Finished running node model.bank_dwh.dim_terminal
[0m22:06:21.793053 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_card
[0m22:06:21.793947 [info ] [Thread-4 (]: 9 of 10 START sql table model public_ods.dim_account ........................... [RUN]
[0m22:06:21.794989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a9bfb9750>]}
[0m22:06:21.796619 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_customer_scd2, now model.bank_dwh.dim_account)
[0m22:06:21.797662 [info ] [Thread-2 (]: 5 of 10 OK created sql incremental model public_raw.raw_transaction ............ [[32mINSERT 0 0[0m in 0.18s]
[0m22:06:21.798450 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.dim_account
[0m22:06:21.799335 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_transaction
[0m22:06:21.802075 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.dim_account"
[0m22:06:21.803268 [debug] [Thread-1 (]: Began running node model.bank_dwh.fct_transactions
[0m22:06:21.804497 [info ] [Thread-1 (]: 10 of 10 START sql table model public_ods.fct_transactions ..................... [RUN]
[0m22:06:21.805321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_terminal, now model.bank_dwh.fct_transactions)
[0m22:06:21.806061 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.fct_transactions
[0m22:06:21.809414 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.fct_transactions"
[0m22:06:21.810287 [debug] [Thread-4 (]: Began executing node model.bank_dwh.dim_account
[0m22:06:21.813318 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.dim_account"
[0m22:06:21.814615 [debug] [Thread-1 (]: Began executing node model.bank_dwh.fct_transactions
[0m22:06:21.817630 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.fct_transactions"
[0m22:06:21.820531 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.821328 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: BEGIN
[0m22:06:21.821678 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.822252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:06:21.823059 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: BEGIN
[0m22:06:21.824339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:06:21.828551 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m22:06:21.829328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m22:06:21.829689 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.830396 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.831123 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_account__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(account_id::text) as account_sk,
  account_id,
  account_number,
  customer_id,
  currency_code,
  opened_at,
  closed_at,
  status,
  daily_transfer_limit,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_account"
  );
  
[0m22:06:21.831992 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */

  
    

  create  table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp"
  
  
    as
  
  (
    

with t as (
  select
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status
  from "bank_dwh"."public_raw"."raw_transaction"
),
c as (
  select card_id, md5(card_id::text) as card_sk, account_id
  from "bank_dwh"."public_raw"."raw_card"
  where is_deleted = false
),
a as (
  select account_id, md5(account_id::text) as account_sk, customer_id
  from "bank_dwh"."public_raw"."raw_account"
  where is_deleted = false
),
cust as (
  select customer_id, customer_sk
  from "bank_dwh"."public_ods"."dim_customer_scd2"
  where is_current = true
),
term as (
  select terminal_id, terminal_sk
  from "bank_dwh"."public_ods"."dim_terminal"
)
select
  t.txn_id,
  t.txn_ts,
  t.amount,
  t.currency_code,
  t.txn_type,
  t.status,
  c.card_sk,
  a.account_sk,
  cust.customer_sk,
  term.terminal_sk
from t
left join c on c.card_id = t.card_id
left join a on a.account_id = c.account_id
left join cust on cust.customer_id = a.customer_id
left join term on term.terminal_id = t.terminal_id
  );
  
[0m22:06:21.836701 [debug] [Thread-4 (]: SQL status: SELECT 80 in 0.004 seconds
[0m22:06:21.837598 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m22:06:21.840197 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.843070 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.843867 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account" rename to "dim_account__dbt_backup"
[0m22:06:21.844634 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions" rename to "fct_transactions__dbt_backup"
[0m22:06:21.845769 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.846318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.848580 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.851087 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.851847 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account__dbt_tmp" rename to "dim_account"
[0m22:06:21.852544 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp" rename to "fct_transactions"
[0m22:06:21.853592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.854284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:06:21.855781 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:06:21.857618 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:06:21.858366 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.859085 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.859823 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:06:21.860465 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:06:21.862306 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.862957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:06:21.864724 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_account__dbt_backup"
[0m22:06:21.866946 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."fct_transactions__dbt_backup"
[0m22:06:21.868095 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:06:21.869133 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:06:21.869814 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
drop table if exists "bank_dwh"."public_ods"."dim_account__dbt_backup" cascade
[0m22:06:21.870523 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
drop table if exists "bank_dwh"."public_ods"."fct_transactions__dbt_backup" cascade
[0m22:06:21.872808 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:06:21.873327 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:06:21.874515 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: Close
[0m22:06:21.875891 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: Close
[0m22:06:21.876853 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa361c1d0>]}
[0m22:06:21.877718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3d28e3c-214c-498c-9a63-651017e55b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a99667f90>]}
[0m22:06:21.878604 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public_ods.dim_account ...................... [[32mSELECT 80[0m in 0.08s]
[0m22:06:21.879652 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public_ods.fct_transactions ................ [[32mSELECT 0[0m in 0.07s]
[0m22:06:21.880596 [debug] [Thread-4 (]: Finished running node model.bank_dwh.dim_account
[0m22:06:21.881471 [debug] [Thread-1 (]: Finished running node model.bank_dwh.fct_transactions
[0m22:06:21.883799 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.884576 [debug] [MainThread]: On master: BEGIN
[0m22:06:21.885263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:06:21.890871 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:06:21.891850 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.892630 [debug] [MainThread]: Using postgres connection "master"
[0m22:06:21.893317 [debug] [MainThread]: On master: COMMIT
[0m22:06:21.894109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:06:21.894775 [debug] [MainThread]: On master: Close
[0m22:06:21.895658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:21.896484 [debug] [MainThread]: Connection 'model.bank_dwh.fct_transactions' was properly closed.
[0m22:06:21.897158 [debug] [MainThread]: Connection 'model.bank_dwh.raw_transaction' was properly closed.
[0m22:06:21.897832 [debug] [MainThread]: Connection 'model.bank_dwh.dim_card' was properly closed.
[0m22:06:21.898515 [debug] [MainThread]: Connection 'model.bank_dwh.dim_account' was properly closed.
[0m22:06:21.899302 [info ] [MainThread]: 
[0m22:06:21.900059 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m22:06:21.902446 [debug] [MainThread]: Command end result
[0m22:06:21.937868 [info ] [MainThread]: 
[0m22:06:21.938926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:06:21.939779 [info ] [MainThread]: 
[0m22:06:21.940567 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m22:06:21.941779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3076919, "process_user_time": 2.20816, "process_kernel_time": 0.2011, "process_mem_max_rss": "196260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:21.942688 [debug] [MainThread]: Command `dbt run` succeeded at 22:06:21.942598 after 1.31 seconds
[0m22:06:21.943445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa7401550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa56f1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778aa744e690>]}
[0m22:06:21.944233 [debug] [MainThread]: Flushing usage events
[0m22:34:13.148813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff23f3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff2436b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff2436610>]}


============================== 22:34:13.168255 | e1339a01-54c2-4ad7-8117-e31d6effc139 ==============================
[0m22:34:13.168255 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:34:13.169357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '.', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:34:13.370010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff22873d0>]}
[0m22:34:13.410560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff3f60b50>]}
[0m22:34:13.412453 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:34:13.422670 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:34:13.628213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:13.629205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:13.653473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff1a8da90>]}
[0m22:34:13.755165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff177be90>]}
[0m22:34:13.756187 [info ] [MainThread]: Found 10 models, 4 sources, 424 macros
[0m22:34:13.757012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff2130f90>]}
[0m22:34:13.759202 [info ] [MainThread]: 
[0m22:34:13.760262 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:13.764457 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:34:13.765173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:34:13.799113 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:34:13.799520 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:34:13.800155 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:13.800970 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:13.801671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:13.802466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:13.809034 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m22:34:13.809382 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m22:34:13.810794 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:34:13.812285 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:34:13.814006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now create_bank_dwh_public_raw)
[0m22:34:13.814386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now create_bank_dwh_public_ods)
[0m22:34:13.815122 [debug] [ThreadPool]: Creating schema "database: "bank_dwh"
schema: "public_raw"
"
[0m22:34:13.816000 [debug] [ThreadPool]: Creating schema "database: "bank_dwh"
schema: "public_ods"
"
[0m22:34:13.820545 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:34:13.822761 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:34:13.823556 [debug] [ThreadPool]: On create_bank_dwh_public_raw: BEGIN
[0m22:34:13.824371 [debug] [ThreadPool]: On create_bank_dwh_public_ods: BEGIN
[0m22:34:13.825052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:13.825773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:13.831180 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:34:13.831509 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:34:13.832029 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:34:13.832723 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:34:13.833437 [debug] [ThreadPool]: On create_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "create_bank_dwh_public_raw"} */
create schema if not exists "public_raw"
[0m22:34:13.834111 [debug] [ThreadPool]: On create_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "create_bank_dwh_public_ods"} */
create schema if not exists "public_ods"
[0m22:34:13.835197 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m22:34:13.835747 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m22:34:13.836724 [debug] [ThreadPool]: On create_bank_dwh_public_raw: COMMIT
[0m22:34:13.837960 [debug] [ThreadPool]: On create_bank_dwh_public_ods: COMMIT
[0m22:34:13.838727 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_raw"
[0m22:34:13.839476 [debug] [ThreadPool]: Using postgres connection "create_bank_dwh_public_ods"
[0m22:34:13.840174 [debug] [ThreadPool]: On create_bank_dwh_public_raw: COMMIT
[0m22:34:13.840845 [debug] [ThreadPool]: On create_bank_dwh_public_ods: COMMIT
[0m22:34:13.842393 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:34:13.843021 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m22:34:13.843336 [debug] [ThreadPool]: On create_bank_dwh_public_raw: Close
[0m22:34:13.844107 [debug] [ThreadPool]: On create_bank_dwh_public_ods: Close
[0m22:34:13.846924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bank_dwh_public_ods, now list_bank_dwh_public_raw)
[0m22:34:13.847457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_bank_dwh_public_raw, now list_bank_dwh_public_ods)
[0m22:34:13.852647 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:34:13.854621 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:34:13.855401 [debug] [ThreadPool]: On list_bank_dwh_public_raw: BEGIN
[0m22:34:13.856114 [debug] [ThreadPool]: On list_bank_dwh_public_ods: BEGIN
[0m22:34:13.856901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:13.857604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:13.862970 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:34:13.863305 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:34:13.863838 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:34:13.864537 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:34:13.865216 [debug] [ThreadPool]: On list_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_ods"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m22:34:13.865907 [debug] [ThreadPool]: On list_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_raw"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m22:34:13.869253 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:34:13.869614 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m22:34:13.870775 [debug] [ThreadPool]: On list_bank_dwh_public_ods: ROLLBACK
[0m22:34:13.872144 [debug] [ThreadPool]: On list_bank_dwh_public_raw: ROLLBACK
[0m22:34:13.873059 [debug] [ThreadPool]: On list_bank_dwh_public_ods: Close
[0m22:34:13.873872 [debug] [ThreadPool]: On list_bank_dwh_public_raw: Close
[0m22:34:13.878605 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:13.879447 [debug] [MainThread]: On master: BEGIN
[0m22:34:13.880192 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:13.885581 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:34:13.886891 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:13.887670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:34:13.891382 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m22:34:13.892852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff2584490>]}
[0m22:34:13.893764 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:13.894646 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:13.895365 [debug] [MainThread]: On master: BEGIN
[0m22:34:13.896360 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:13.897052 [debug] [MainThread]: On master: COMMIT
[0m22:34:13.897779 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:13.898446 [debug] [MainThread]: On master: COMMIT
[0m22:34:13.899251 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:13.899960 [debug] [MainThread]: On master: Close
[0m22:34:13.900863 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:13.901654 [info ] [MainThread]: 
[0m22:34:13.908897 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m22:34:13.909462 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_card
[0m22:34:13.909851 [debug] [Thread-3 (]: Began running node model.bank_dwh.raw_customer
[0m22:34:13.910278 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_terminal
[0m22:34:13.910964 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_raw.raw_account ..................... [RUN]
[0m22:34:13.912013 [info ] [Thread-2 (]: 2 of 10 START sql incremental model public_raw.raw_card ........................ [RUN]
[0m22:34:13.912824 [info ] [Thread-3 (]: 3 of 10 START sql incremental model public_raw.raw_customer .................... [RUN]
[0m22:34:13.913769 [info ] [Thread-4 (]: 4 of 10 START sql incremental model public_raw.raw_terminal .................... [RUN]
[0m22:34:13.914662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_raw, now model.bank_dwh.raw_account)
[0m22:34:13.915512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_ods, now model.bank_dwh.raw_card)
[0m22:34:13.916397 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bank_dwh.raw_customer'
[0m22:34:13.917299 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bank_dwh.raw_terminal'
[0m22:34:13.918149 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m22:34:13.918986 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_card
[0m22:34:13.919730 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.raw_customer
[0m22:34:13.920545 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_terminal
[0m22:34:13.935568 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m22:34:13.939766 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m22:34:13.943441 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m22:34:13.946815 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m22:34:13.951678 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_terminal
[0m22:34:13.952467 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m22:34:13.958307 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_card
[0m22:34:13.968929 [debug] [Thread-3 (]: Began executing node model.bank_dwh.raw_customer
[0m22:34:14.003761 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m22:34:14.005055 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m22:34:14.008088 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m22:34:14.011484 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m22:34:14.016076 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:14.016583 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:14.017221 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:14.017589 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: BEGIN
[0m22:34:14.018349 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:14.018678 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: BEGIN
[0m22:34:14.019417 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: BEGIN
[0m22:34:14.020271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:14.021035 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: BEGIN
[0m22:34:14.021801 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:34:14.022509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:14.023766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:14.028791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.029783 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:14.030210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.030789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.031377 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.031719 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_terminal"
  
  
    as
  
  (
    

select
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  created_at,
  updated_at,
  is_working,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."terminal_snapshot"
  );
  
  
[0m22:34:14.032540 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:14.033263 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:14.034173 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:14.035400 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_customer"
  
  
    as
  
  (
    

select
  customer_id,
  customer_uuid,
  full_name,
  birth_date,
  email,
  phone,
  city,
  created_at,
  updated_at,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."customer_snapshot"
  );
  
  
[0m22:34:14.036211 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_account"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'account_id')::bigint as account_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'account'
  
),
latest as (
  select distinct on (account_id)
    account_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by account_id, event_id desc
)
select
  account_id,
  row_data->>'account_number' as account_number,
  (row_data->>'customer_id')::bigint as customer_id,
  row_data->>'currency_code' as currency_code,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  row_data->>'status' as status,
  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:34:14.036984 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_card"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'card_id')::bigint as card_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'card'
  
),
latest as (
  select distinct on (card_id)
    card_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by card_id, event_id desc
)
select
  card_id,
  row_data->>'card_number' as card_number,
  (row_data->>'account_id')::bigint as account_id,
  row_data->>'status' as status,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:34:14.039117 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.004 seconds
[0m22:34:14.040616 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.003 seconds
[0m22:34:14.046313 [debug] [Thread-1 (]: SQL status: SELECT 80 in 0.008 seconds
[0m22:34:14.046647 [debug] [Thread-2 (]: SQL status: SELECT 160 in 0.008 seconds
[0m22:34:14.054317 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:34:14.055929 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:34:14.057632 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:34:14.059300 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:34:14.060040 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:14.060803 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:14.061645 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:14.062336 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:14.063057 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:34:14.063756 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:34:14.064522 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:34:14.065256 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:34:14.067037 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.067583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.067923 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.068324 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.069818 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: Close
[0m22:34:14.070862 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: Close
[0m22:34:14.071837 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: Close
[0m22:34:14.072841 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: Close
[0m22:34:14.074521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff1711350>]}
[0m22:34:14.075331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff0b67fd0>]}
[0m22:34:14.076131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff4c15890>]}
[0m22:34:14.076832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff0baa810>]}
[0m22:34:14.078668 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model public_raw.raw_terminal ............... [[32mSELECT 10[0m in 0.16s]
[0m22:34:14.079620 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_raw.raw_account ................ [[32mSELECT 80[0m in 0.16s]
[0m22:34:14.080604 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model public_raw.raw_customer ............... [[32mSELECT 50[0m in 0.16s]
[0m22:34:14.081333 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model public_raw.raw_card ................... [[32mSELECT 160[0m in 0.16s]
[0m22:34:14.082274 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_terminal
[0m22:34:14.083268 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m22:34:14.084204 [debug] [Thread-3 (]: Finished running node model.bank_dwh.raw_customer
[0m22:34:14.085149 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_card
[0m22:34:14.086037 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_transaction
[0m22:34:14.087026 [debug] [Thread-1 (]: Began running node model.bank_dwh.dim_terminal
[0m22:34:14.087882 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_account
[0m22:34:14.088772 [debug] [Thread-2 (]: Began running node model.bank_dwh.dim_customer_scd2
[0m22:34:14.089693 [info ] [Thread-4 (]: 5 of 10 START sql incremental model public_raw.raw_transaction ................. [RUN]
[0m22:34:14.090629 [info ] [Thread-1 (]: 6 of 10 START sql table model public_ods.dim_terminal .......................... [RUN]
[0m22:34:14.091536 [info ] [Thread-3 (]: 7 of 10 START sql table model public_ods.dim_account ........................... [RUN]
[0m22:34:14.092584 [info ] [Thread-2 (]: 8 of 10 START sql table model public_ods.dim_customer_scd2 ..................... [RUN]
[0m22:34:14.093578 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m22:34:14.094714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.dim_terminal)
[0m22:34:14.095797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.dim_account)
[0m22:34:14.096879 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.dim_customer_scd2)
[0m22:34:14.097769 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_transaction
[0m22:34:14.098689 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.dim_terminal
[0m22:34:14.099668 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_account
[0m22:34:14.100665 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.dim_customer_scd2
[0m22:34:14.104295 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m22:34:14.107810 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.dim_terminal"
[0m22:34:14.111361 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_account"
[0m22:34:14.114736 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.119712 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_account
[0m22:34:14.120172 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_transaction
[0m22:34:14.120613 [debug] [Thread-1 (]: Began executing node model.bank_dwh.dim_terminal
[0m22:34:14.132083 [debug] [Thread-2 (]: Began executing node model.bank_dwh.dim_customer_scd2
[0m22:34:14.133631 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_account"
[0m22:34:14.137706 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m22:34:14.143706 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.dim_terminal"
[0m22:34:14.204934 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.209590 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:14.210260 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:14.210784 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:14.211303 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: BEGIN
[0m22:34:14.211819 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.212436 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: BEGIN
[0m22:34:14.213162 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: BEGIN
[0m22:34:14.213998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:14.214735 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: BEGIN
[0m22:34:14.215535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:14.216276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:14.217896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:14.223334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m22:34:14.224403 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.225033 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m22:34:14.225443 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:34:14.225827 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:14.226721 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:14.227552 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:14.228351 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.229183 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp"
  
  
    as
  
  (
    

with x as (
  select
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    etl_upload_dttm,
    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn
  from "bank_dwh"."public_raw"."raw_terminal"
)
select
  md5(terminal_id::text) as terminal_sk,
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  is_working,
  is_deleted,
  etl_upload_dttm as asof_dttm
from x
where rn = 1
  );
  
[0m22:34:14.229961 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_account__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(account_id::text) as account_sk,
  account_id,
  account_number,
  customer_id,
  currency_code,
  opened_at,
  closed_at,
  status,
  daily_transfer_limit,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_account"
  );
  
[0m22:34:14.230849 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      
  
    

  create  table "bank_dwh"."public_raw"."raw_transaction"
  
  
    as
  
  (
    

select
  txn_id,
  card_id,
  terminal_id,
  txn_ts,
  amount,
  currency_code,
  txn_type,
  status,
  etl_upload_dttm
from "bank_dwh"."stg"."transaction_increment"
  );
  
  
[0m22:34:14.231721 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm,
    md5(
      coalesce(customer_uuid::text,'') || '|' ||
      coalesce(full_name,'') || '|' ||
      coalesce(birth_date::text,'') || '|' ||
      coalesce(email,'') || '|' ||
      coalesce(phone,'') || '|' ||
      coalesce(city,'') || '|' ||
      coalesce(is_deleted::text,'')
    ) as diff
  from "bank_dwh"."public_raw"."raw_customer"
),
chg as (
  select
    *,
    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff
  from base
),
filt as (
  select
    *
  from chg
  where prev_diff is distinct from diff
),
scd as (
  select
    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm as valid_from,
    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,
    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current
  from filt
)
select * from scd
  );
  
[0m22:34:14.238538 [debug] [Thread-3 (]: SQL status: SELECT 80 in 0.005 seconds
[0m22:34:14.239567 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m22:34:14.245962 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:14.246403 [debug] [Thread-4 (]: SQL status: SELECT 500 in 0.013 seconds
[0m22:34:14.246848 [debug] [Thread-2 (]: SQL status: SELECT 50 in 0.013 seconds
[0m22:34:14.249976 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:14.250912 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account__dbt_tmp" rename to "dim_account"
[0m22:34:14.253015 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:34:14.256413 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.257522 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp" rename to "dim_terminal"
[0m22:34:14.258947 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:14.259409 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:34:14.260082 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp" rename to "dim_customer_scd2"
[0m22:34:14.261361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:14.261776 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:34:14.263942 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:34:14.265269 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:14.267119 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:34:14.268437 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:14.270368 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:34:14.270753 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:34:14.271396 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:14.272192 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:34:14.272889 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.274002 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: Close
[0m22:34:14.274751 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:34:14.276056 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:34:14.276534 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.277744 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff1778ad0>]}
[0m22:34:14.279428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.280034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.285598 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_account__dbt_backup"
[0m22:34:14.286838 [info ] [Thread-4 (]: 5 of 10 OK created sql incremental model public_raw.raw_transaction ............ [[32mSELECT 500[0m in 0.18s]
[0m22:34:14.289562 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_terminal__dbt_backup"
[0m22:34:14.291942 [debug] [Thread-2 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup"
[0m22:34:14.297020 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:14.298263 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_transaction
[0m22:34:14.299682 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:14.300877 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:14.301701 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
drop table if exists "bank_dwh"."public_ods"."dim_account__dbt_backup" cascade
[0m22:34:14.302665 [debug] [Thread-4 (]: Began running node model.bank_dwh.dim_card
[0m22:34:14.303449 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
drop table if exists "bank_dwh"."public_ods"."dim_terminal__dbt_backup" cascade
[0m22:34:14.304284 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
drop table if exists "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup" cascade
[0m22:34:14.305743 [info ] [Thread-4 (]: 9 of 10 START sql table model public_ods.dim_card .............................. [RUN]
[0m22:34:14.306202 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:34:14.307111 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:34:14.307881 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:34:14.308487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_transaction, now model.bank_dwh.dim_card)
[0m22:34:14.310240 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: Close
[0m22:34:14.311769 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: Close
[0m22:34:14.313518 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: Close
[0m22:34:14.314450 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.dim_card
[0m22:34:14.315670 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff0bab010>]}
[0m22:34:14.316738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff0be09d0>]}
[0m22:34:14.317747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff0be3e90>]}
[0m22:34:14.321654 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.dim_card"
[0m22:34:14.322885 [info ] [Thread-3 (]: 7 of 10 OK created sql table model public_ods.dim_account ...................... [[32mSELECT 80[0m in 0.22s]
[0m22:34:14.324021 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public_ods.dim_terminal ..................... [[32mSELECT 10[0m in 0.22s]
[0m22:34:14.325050 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public_ods.dim_customer_scd2 ................ [[32mSELECT 50[0m in 0.22s]
[0m22:34:14.326586 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_account
[0m22:34:14.327570 [debug] [Thread-1 (]: Finished running node model.bank_dwh.dim_terminal
[0m22:34:14.328496 [debug] [Thread-2 (]: Finished running node model.bank_dwh.dim_customer_scd2
[0m22:34:14.331491 [debug] [Thread-3 (]: Began running node model.bank_dwh.fct_transactions
[0m22:34:14.331987 [debug] [Thread-4 (]: Began executing node model.bank_dwh.dim_card
[0m22:34:14.332804 [info ] [Thread-3 (]: 10 of 10 START sql table model public_ods.fct_transactions ..................... [RUN]
[0m22:34:14.336755 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.dim_card"
[0m22:34:14.337824 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_account, now model.bank_dwh.fct_transactions)
[0m22:34:14.339176 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.fct_transactions
[0m22:34:14.344362 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.fct_transactions"
[0m22:34:14.349192 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:14.350566 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: BEGIN
[0m22:34:14.351072 [debug] [Thread-3 (]: Began executing node model.bank_dwh.fct_transactions
[0m22:34:14.351855 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:14.355549 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.fct_transactions"
[0m22:34:14.362280 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m22:34:14.362886 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:14.363668 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:14.364471 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: BEGIN
[0m22:34:14.365268 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_card__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(card_id::text) as card_sk,
  card_id,
  card_number,
  account_id,
  status,
  opened_at,
  closed_at,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_card"
  );
  
[0m22:34:14.366036 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:14.371264 [debug] [Thread-4 (]: SQL status: SELECT 160 in 0.004 seconds
[0m22:34:14.374740 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:14.375570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:34:14.376181 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card__dbt_tmp" rename to "dim_card"
[0m22:34:14.377119 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:14.378253 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:14.378790 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */

  
    

  create  table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp"
  
  
    as
  
  (
    

with t as (
  select
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status
  from "bank_dwh"."public_raw"."raw_transaction"
),
c as (
  select card_id, md5(card_id::text) as card_sk, account_id
  from "bank_dwh"."public_raw"."raw_card"
  where is_deleted = false
),
a as (
  select account_id, md5(account_id::text) as account_sk, customer_id
  from "bank_dwh"."public_raw"."raw_account"
  where is_deleted = false
),
cust as (
  select customer_id, customer_sk
  from "bank_dwh"."public_ods"."dim_customer_scd2"
  where is_current = true
),
term as (
  select terminal_id, terminal_sk
  from "bank_dwh"."public_ods"."dim_terminal"
)
select
  t.txn_id,
  t.txn_ts,
  t.amount,
  t.currency_code,
  t.txn_type,
  t.status,
  c.card_sk,
  a.account_sk,
  cust.customer_sk,
  term.terminal_sk
from t
left join c on c.card_id = t.card_id
left join a on a.account_id = c.account_id
left join cust on cust.customer_id = a.customer_id
left join term on term.terminal_id = t.terminal_id
  );
  
[0m22:34:14.380772 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:34:14.382110 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:14.382878 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:34:14.384560 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.387064 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_card__dbt_backup"
[0m22:34:14.387412 [debug] [Thread-3 (]: SQL status: SELECT 500 in 0.006 seconds
[0m22:34:14.388483 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:14.391522 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:14.392398 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
drop table if exists "bank_dwh"."public_ods"."dim_card__dbt_backup" cascade
[0m22:34:14.393163 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp" rename to "fct_transactions"
[0m22:34:14.394386 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:34:14.394995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:14.396211 [debug] [Thread-4 (]: On model.bank_dwh.dim_card: Close
[0m22:34:14.397957 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:34:14.399013 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff2232d50>]}
[0m22:34:14.399604 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:14.400611 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public_ods.dim_card ......................... [[32mSELECT 160[0m in 0.09s]
[0m22:34:14.401342 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:34:14.402350 [debug] [Thread-4 (]: Finished running node model.bank_dwh.dim_card
[0m22:34:14.404174 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:14.406619 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."fct_transactions__dbt_backup"
[0m22:34:14.407704 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:14.408370 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
drop table if exists "bank_dwh"."public_ods"."fct_transactions__dbt_backup" cascade
[0m22:34:14.409316 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:34:14.410765 [debug] [Thread-3 (]: On model.bank_dwh.fct_transactions: Close
[0m22:34:14.411699 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1339a01-54c2-4ad7-8117-e31d6effc139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff4c15890>]}
[0m22:34:14.412737 [info ] [Thread-3 (]: 10 of 10 OK created sql table model public_ods.fct_transactions ................ [[32mSELECT 500[0m in 0.07s]
[0m22:34:14.413809 [debug] [Thread-3 (]: Finished running node model.bank_dwh.fct_transactions
[0m22:34:14.415874 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:14.416653 [debug] [MainThread]: On master: BEGIN
[0m22:34:14.417357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:14.422837 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:34:14.423774 [debug] [MainThread]: On master: COMMIT
[0m22:34:14.424608 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:14.425285 [debug] [MainThread]: On master: COMMIT
[0m22:34:14.426152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:14.426842 [debug] [MainThread]: On master: Close
[0m22:34:14.427711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:14.428335 [debug] [MainThread]: Connection 'model.bank_dwh.dim_terminal' was properly closed.
[0m22:34:14.429016 [debug] [MainThread]: Connection 'model.bank_dwh.dim_customer_scd2' was properly closed.
[0m22:34:14.429662 [debug] [MainThread]: Connection 'model.bank_dwh.fct_transactions' was properly closed.
[0m22:34:14.430447 [debug] [MainThread]: Connection 'model.bank_dwh.dim_card' was properly closed.
[0m22:34:14.431203 [info ] [MainThread]: 
[0m22:34:14.432149 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m22:34:14.433901 [debug] [MainThread]: Command end result
[0m22:34:14.471717 [info ] [MainThread]: 
[0m22:34:14.472884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:14.473748 [info ] [MainThread]: 
[0m22:34:14.474512 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m22:34:14.475900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3709006, "process_user_time": 2.34441, "process_kernel_time": 0.338368, "process_mem_max_rss": "194952", "process_in_blocks": "36264", "process_out_blocks": "4152"}
[0m22:34:14.476977 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:14.476877 after 1.37 seconds
[0m22:34:14.477731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff62c7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff623d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7afff623e7d0>]}
[0m22:34:14.478661 [debug] [MainThread]: Flushing usage events
[0m22:34:46.276615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a94d4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a94d67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a94d3990>]}


============================== 22:34:46.281635 | 448fd185-e3e7-4165-8686-c4102ae1ad70 ==============================
[0m22:34:46.281635 [info ] [MainThread]: Running with dbt=1.8.8
[0m22:34:46.282651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:34:46.439249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a94d6dd0>]}
[0m22:34:46.479142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ab2987d0>]}
[0m22:34:46.480530 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m22:34:46.490556 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m22:34:46.670022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:46.670879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:46.696842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a87d0290>]}
[0m22:34:46.784735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a7f21750>]}
[0m22:34:46.785733 [info ] [MainThread]: Found 10 models, 4 sources, 424 macros
[0m22:34:46.786553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a9511150>]}
[0m22:34:46.788540 [info ] [MainThread]: 
[0m22:34:46.789512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:34:46.793610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:34:46.794322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m22:34:46.825567 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:34:46.825933 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m22:34:46.826777 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:46.827820 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m22:34:46.828600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:46.829249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:46.836654 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.007 seconds
[0m22:34:46.836943 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.008 seconds
[0m22:34:46.838292 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:34:46.839763 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m22:34:46.842698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_ods)
[0m22:34:46.843245 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_raw)
[0m22:34:46.847863 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:34:46.849659 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:34:46.850418 [debug] [ThreadPool]: On list_bank_dwh_public_ods: BEGIN
[0m22:34:46.851018 [debug] [ThreadPool]: On list_bank_dwh_public_raw: BEGIN
[0m22:34:46.851670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:46.852244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:46.857224 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:34:46.857545 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m22:34:46.858132 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m22:34:46.858855 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m22:34:46.859584 [debug] [ThreadPool]: On list_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_ods"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m22:34:46.860307 [debug] [ThreadPool]: On list_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_raw"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m22:34:46.862937 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:34:46.863331 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m22:34:46.864712 [debug] [ThreadPool]: On list_bank_dwh_public_ods: ROLLBACK
[0m22:34:46.866254 [debug] [ThreadPool]: On list_bank_dwh_public_raw: ROLLBACK
[0m22:34:46.867159 [debug] [ThreadPool]: On list_bank_dwh_public_ods: Close
[0m22:34:46.867879 [debug] [ThreadPool]: On list_bank_dwh_public_raw: Close
[0m22:34:46.873291 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.874065 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.874678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:46.879500 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m22:34:46.880131 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.880785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:34:46.883454 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m22:34:46.884768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a73bfe10>]}
[0m22:34:46.885666 [debug] [MainThread]: On master: ROLLBACK
[0m22:34:46.886565 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.887252 [debug] [MainThread]: On master: BEGIN
[0m22:34:46.888071 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:34:46.888716 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.889385 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:46.890015 [debug] [MainThread]: On master: COMMIT
[0m22:34:46.890822 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:46.891475 [debug] [MainThread]: On master: Close
[0m22:34:46.892278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:46.892981 [info ] [MainThread]: 
[0m22:34:46.900132 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m22:34:46.900614 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_card
[0m22:34:46.900990 [debug] [Thread-3 (]: Began running node model.bank_dwh.raw_customer
[0m22:34:46.901411 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_terminal
[0m22:34:46.902060 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_raw.raw_account ..................... [RUN]
[0m22:34:46.903006 [info ] [Thread-2 (]: 2 of 10 START sql incremental model public_raw.raw_card ........................ [RUN]
[0m22:34:46.903786 [info ] [Thread-3 (]: 3 of 10 START sql incremental model public_raw.raw_customer .................... [RUN]
[0m22:34:46.904577 [info ] [Thread-4 (]: 4 of 10 START sql incremental model public_raw.raw_terminal .................... [RUN]
[0m22:34:46.905449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_raw, now model.bank_dwh.raw_account)
[0m22:34:46.906330 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_ods, now model.bank_dwh.raw_card)
[0m22:34:46.907234 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bank_dwh.raw_customer'
[0m22:34:46.907953 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bank_dwh.raw_terminal'
[0m22:34:46.908670 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m22:34:46.909406 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_card
[0m22:34:46.910114 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.raw_customer
[0m22:34:46.910901 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_terminal
[0m22:34:46.922059 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m22:34:46.925052 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m22:34:46.927725 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m22:34:46.930312 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m22:34:46.934445 [debug] [Thread-3 (]: Began executing node model.bank_dwh.raw_customer
[0m22:34:46.934881 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m22:34:46.940806 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_card
[0m22:34:46.941122 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_terminal
[0m22:34:46.978658 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:46.979676 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:46.983340 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:46.986843 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:46.987858 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    
  
    

  create temporary table "raw_customer__dbt_tmp223446956796"
  
  
    as
  
  (
    

select
  customer_id,
  customer_uuid,
  full_name,
  birth_date,
  email,
  phone,
  city,
  created_at,
  updated_at,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."customer_snapshot"
  );
  
  
[0m22:34:46.988751 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    
  
    

  create temporary table "raw_account__dbt_tmp223446968829"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'account_id')::bigint as account_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'account'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_account")
  
),
latest as (
  select distinct on (account_id)
    account_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by account_id, event_id desc
)
select
  account_id,
  row_data->>'account_number' as account_number,
  (row_data->>'customer_id')::bigint as customer_id,
  row_data->>'currency_code' as currency_code,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  row_data->>'status' as status,
  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:34:46.989525 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    
  
    

  create temporary table "raw_card__dbt_tmp223446981970"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'card_id')::bigint as card_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'card'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_card")
  
),
latest as (
  select distinct on (card_id)
    card_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by card_id, event_id desc
)
select
  card_id,
  row_data->>'card_number' as card_number,
  (row_data->>'account_id')::bigint as account_id,
  row_data->>'status' as status,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m22:34:46.990338 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    
  
    

  create temporary table "raw_terminal__dbt_tmp223446985599"
  
  
    as
  
  (
    

select
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  created_at,
  updated_at,
  is_working,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."terminal_snapshot"
  );
  
  
[0m22:34:46.991088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:34:46.991790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:46.992554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:46.993235 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:47.002037 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.011 seconds
[0m22:34:47.002561 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.009 seconds
[0m22:34:47.003086 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m22:34:47.003491 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m22:34:47.016873 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.020236 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.024100 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.027325 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.029315 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: BEGIN
[0m22:34:47.030275 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: BEGIN
[0m22:34:47.031258 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: BEGIN
[0m22:34:47.032064 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: BEGIN
[0m22:34:47.033259 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m22:34:47.034290 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m22:34:47.035373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m22:34:47.036122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m22:34:47.036783 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.037455 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.038279 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.039085 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.039860 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer__dbt_tmp223446956796'
        
      order by ordinal_position

  
[0m22:34:47.040906 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal__dbt_tmp223446985599'
        
      order by ordinal_position

  
[0m22:34:47.041756 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_card__dbt_tmp223446981970'
        
      order by ordinal_position

  
[0m22:34:47.042664 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_account__dbt_tmp223446968829'
        
      order by ordinal_position

  
[0m22:34:47.050702 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.006 seconds
[0m22:34:47.051336 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.008 seconds
[0m22:34:47.051886 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.006 seconds
[0m22:34:47.052272 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.008 seconds
[0m22:34:47.057774 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.062253 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.065721 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.069350 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.070263 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.071568 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.072678 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.073489 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.076829 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:34:47.077440 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.003 seconds
[0m22:34:47.077893 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m22:34:47.085136 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.006 seconds
[0m22:34:47.086838 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.090518 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.094021 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.098422 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.099487 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.100342 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.101228 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.102410 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.105886 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.002 seconds
[0m22:34:47.106502 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.002 seconds
[0m22:34:47.107050 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.003 seconds
[0m22:34:47.114000 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.006 seconds
[0m22:34:47.122857 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m22:34:47.126317 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m22:34:47.129325 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m22:34:47.132277 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m22:34:47.136618 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.137540 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.139010 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.139411 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_card"
            where (
                card_id) in (
                select (card_id)
                from "raw_card__dbt_tmp223446981970"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_card" ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_card__dbt_tmp223446981970"
    )
  
[0m22:34:47.139843 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.140498 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_customer"
            using "raw_customer__dbt_tmp223446956796"
            where (
                
                    "raw_customer__dbt_tmp223446956796".customer_id = "bank_dwh"."public_raw"."raw_customer".customer_id
                    and 
                
                    "raw_customer__dbt_tmp223446956796".batch_id = "bank_dwh"."public_raw"."raw_customer".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_customer" ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_customer__dbt_tmp223446956796"
    )
  
[0m22:34:47.141397 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_account"
            where (
                account_id) in (
                select (account_id)
                from "raw_account__dbt_tmp223446968829"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_account" ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_account__dbt_tmp223446968829"
    )
  
[0m22:34:47.142718 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_terminal"
            using "raw_terminal__dbt_tmp223446985599"
            where (
                
                    "raw_terminal__dbt_tmp223446985599".terminal_id = "bank_dwh"."public_raw"."raw_terminal".terminal_id
                    and 
                
                    "raw_terminal__dbt_tmp223446985599".batch_id = "bank_dwh"."public_raw"."raw_terminal".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_terminal" ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_terminal__dbt_tmp223446985599"
    )
  
[0m22:34:47.143186 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:34:47.147081 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m22:34:47.148054 [debug] [Thread-3 (]: SQL status: INSERT 0 50 in 0.004 seconds
[0m22:34:47.154708 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.006 seconds
[0m22:34:47.243581 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:34:47.244932 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:34:47.247141 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:34:47.249115 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:34:47.250151 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m22:34:47.250959 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m22:34:47.251714 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m22:34:47.252518 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m22:34:47.253252 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m22:34:47.254034 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m22:34:47.254796 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m22:34:47.255517 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m22:34:47.257327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.258030 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.258357 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:34:47.258733 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.259987 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: Close
[0m22:34:47.260946 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: Close
[0m22:34:47.261921 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: Close
[0m22:34:47.262976 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: Close
[0m22:34:47.264691 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a4694290>]}
[0m22:34:47.265451 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a4697e50>]}
[0m22:34:47.266221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96abd65c10>]}
[0m22:34:47.267173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ab52ba90>]}
[0m22:34:47.269305 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model public_raw.raw_card ................... [[32mINSERT 0 0[0m in 0.36s]
[0m22:34:47.270215 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model public_raw.raw_customer ............... [[32mINSERT 0 50[0m in 0.36s]
[0m22:34:47.271058 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_raw.raw_account ................ [[32mINSERT 0 0[0m in 0.36s]
[0m22:34:47.272019 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model public_raw.raw_terminal ............... [[32mINSERT 0 10[0m in 0.36s]
[0m22:34:47.272951 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_card
[0m22:34:47.273826 [debug] [Thread-3 (]: Finished running node model.bank_dwh.raw_customer
[0m22:34:47.274747 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m22:34:47.275610 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_terminal
[0m22:34:47.276514 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_transaction
[0m22:34:47.277437 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_card
[0m22:34:47.278238 [debug] [Thread-1 (]: Began running node model.bank_dwh.dim_customer_scd2
[0m22:34:47.279010 [debug] [Thread-4 (]: Began running node model.bank_dwh.dim_account
[0m22:34:47.279869 [info ] [Thread-2 (]: 5 of 10 START sql incremental model public_raw.raw_transaction ................. [RUN]
[0m22:34:47.280776 [info ] [Thread-3 (]: 6 of 10 START sql table model public_ods.dim_card .............................. [RUN]
[0m22:34:47.281611 [info ] [Thread-1 (]: 7 of 10 START sql table model public_ods.dim_customer_scd2 ..................... [RUN]
[0m22:34:47.282449 [info ] [Thread-4 (]: 8 of 10 START sql table model public_ods.dim_account ........................... [RUN]
[0m22:34:47.283184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.raw_transaction)
[0m22:34:47.284038 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.dim_card)
[0m22:34:47.284843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.dim_customer_scd2)
[0m22:34:47.285603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.dim_account)
[0m22:34:47.286405 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_transaction
[0m22:34:47.287173 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_card
[0m22:34:47.287865 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.dim_customer_scd2
[0m22:34:47.288624 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.dim_account
[0m22:34:47.291769 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m22:34:47.294227 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_card"
[0m22:34:47.296775 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.299237 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.dim_account"
[0m22:34:47.303015 [debug] [Thread-1 (]: Began executing node model.bank_dwh.dim_customer_scd2
[0m22:34:47.303384 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_transaction
[0m22:34:47.303757 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_card
[0m22:34:47.309483 [debug] [Thread-4 (]: Began executing node model.bank_dwh.dim_account
[0m22:34:47.313674 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.317263 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.320341 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_card"
[0m22:34:47.323206 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.dim_account"
[0m22:34:47.324709 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    
  
    

  create temporary table "raw_transaction__dbt_tmp223447315868"
  
  
    as
  
  (
    

select
  txn_id,
  card_id,
  terminal_id,
  txn_ts,
  amount,
  currency_code,
  txn_type,
  status,
  etl_upload_dttm
from "bank_dwh"."stg"."transaction_increment"
  );
  
  
[0m22:34:47.326456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:34:47.327625 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.327970 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.328332 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.328822 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: BEGIN
[0m22:34:47.329635 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: BEGIN
[0m22:34:47.330365 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: BEGIN
[0m22:34:47.331094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:47.331812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:47.332573 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:47.333790 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.007 seconds
[0m22:34:47.337414 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.338008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:47.338448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:47.338811 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: BEGIN
[0m22:34:47.339192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m22:34:47.339788 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.340484 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.341369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m22:34:47.341993 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.342790 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm,
    md5(
      coalesce(customer_uuid::text,'') || '|' ||
      coalesce(full_name,'') || '|' ||
      coalesce(birth_date::text,'') || '|' ||
      coalesce(email,'') || '|' ||
      coalesce(phone,'') || '|' ||
      coalesce(city,'') || '|' ||
      coalesce(is_deleted::text,'')
    ) as diff
  from "bank_dwh"."public_raw"."raw_customer"
),
chg as (
  select
    *,
    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff
  from base
),
filt as (
  select
    *
  from chg
  where prev_diff is distinct from diff
),
scd as (
  select
    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm as valid_from,
    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,
    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current
  from filt
)
select * from scd
  );
  
[0m22:34:47.343574 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_card__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(card_id::text) as card_sk,
  card_id,
  card_number,
  account_id,
  status,
  opened_at,
  closed_at,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_card"
  );
  
[0m22:34:47.344260 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.345055 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_account__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(account_id::text) as account_sk,
  account_id,
  account_number,
  customer_id,
  currency_code,
  opened_at,
  closed_at,
  status,
  daily_transfer_limit,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_account"
  );
  
[0m22:34:47.347810 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction__dbt_tmp223447315868'
        
      order by ordinal_position

  
[0m22:34:47.349695 [debug] [Thread-3 (]: SQL status: SELECT 160 in 0.003 seconds
[0m22:34:47.356019 [debug] [Thread-4 (]: SQL status: SELECT 80 in 0.007 seconds
[0m22:34:47.356349 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.007 seconds
[0m22:34:47.355728 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.357018 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.011 seconds
[0m22:34:47.359650 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.362292 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.363088 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card" rename to "dim_card__dbt_backup"
[0m22:34:47.365590 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.366431 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account" rename to "dim_account__dbt_backup"
[0m22:34:47.367225 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.368292 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.368838 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2" rename to "dim_customer_scd2__dbt_backup"
[0m22:34:47.369837 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.372501 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.372904 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.003 seconds
[0m22:34:47.373773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.376150 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.376950 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card__dbt_tmp" rename to "dim_card"
[0m22:34:47.379765 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.382185 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.383013 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account__dbt_tmp" rename to "dim_account"
[0m22:34:47.383980 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.384627 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m22:34:47.385418 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp" rename to "dim_customer_scd2"
[0m22:34:47.386408 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.392289 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:34:47.393629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.395116 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:34:47.395455 [debug] [Thread-2 (]: SQL status: SELECT 9 in 0.003 seconds
[0m22:34:47.395968 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.397714 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:34:47.398562 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.400545 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m22:34:47.401334 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m22:34:47.402050 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.402762 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: COMMIT
[0m22:34:47.404560 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m22:34:47.405111 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.406305 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.410845 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_card__dbt_backup"
[0m22:34:47.411224 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m22:34:47.413401 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_account__dbt_backup"
[0m22:34:47.417913 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m22:34:47.418325 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.420398 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup"
[0m22:34:47.421462 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m22:34:47.422275 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
drop table if exists "bank_dwh"."public_ods"."dim_card__dbt_backup" cascade
[0m22:34:47.423127 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_transaction"
            where (
                txn_id) in (
                select (txn_id)
                from "raw_transaction__dbt_tmp223447315868"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_transaction" ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm")
    (
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm"
        from "raw_transaction__dbt_tmp223447315868"
    )
  
[0m22:34:47.424374 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m22:34:47.425306 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
drop table if exists "bank_dwh"."public_ods"."dim_account__dbt_backup" cascade
[0m22:34:47.427811 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m22:34:47.428120 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
drop table if exists "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup" cascade
[0m22:34:47.428463 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:47.431953 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:34:47.432361 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:34:47.434162 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: Close
[0m22:34:47.434521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:47.435110 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m22:34:47.436839 [debug] [Thread-4 (]: On model.bank_dwh.dim_account: Close
[0m22:34:47.437863 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a5f9d750>]}
[0m22:34:47.440193 [debug] [Thread-1 (]: On model.bank_dwh.dim_customer_scd2: Close
[0m22:34:47.440900 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m22:34:47.441911 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a9882790>]}
[0m22:34:47.442761 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public_ods.dim_card ......................... [[32mSELECT 160[0m in 0.15s]
[0m22:34:47.443573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ab256350>]}
[0m22:34:47.445086 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.444763 [info ] [Thread-4 (]: 8 of 10 OK created sql table model public_ods.dim_account ...................... [[32mSELECT 80[0m in 0.16s]
[0m22:34:47.445951 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_card
[0m22:34:47.446769 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public_ods.dim_customer_scd2 ................ [[32mSELECT 50[0m in 0.16s]
[0m22:34:47.447785 [debug] [Thread-2 (]: On model.bank_dwh.raw_transaction: Close
[0m22:34:47.448667 [debug] [Thread-4 (]: Finished running node model.bank_dwh.dim_account
[0m22:34:47.449501 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_terminal
[0m22:34:47.450445 [debug] [Thread-1 (]: Finished running node model.bank_dwh.dim_customer_scd2
[0m22:34:47.451225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a99dbb90>]}
[0m22:34:47.452488 [info ] [Thread-3 (]: 9 of 10 START sql table model public_ods.dim_terminal .......................... [RUN]
[0m22:34:47.453773 [info ] [Thread-2 (]: 5 of 10 OK created sql incremental model public_raw.raw_transaction ............ [[32mINSERT 0 0[0m in 0.17s]
[0m22:34:47.454322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_card, now model.bank_dwh.dim_terminal)
[0m22:34:47.455170 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_transaction
[0m22:34:47.455951 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_terminal
[0m22:34:47.459004 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_terminal"
[0m22:34:47.463842 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_terminal
[0m22:34:47.467154 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_terminal"
[0m22:34:47.471815 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.472512 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: BEGIN
[0m22:34:47.473213 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:47.478540 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m22:34:47.479279 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.479945 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp"
  
  
    as
  
  (
    

with x as (
  select
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    etl_upload_dttm,
    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn
  from "bank_dwh"."public_raw"."raw_terminal"
)
select
  md5(terminal_id::text) as terminal_sk,
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  is_working,
  is_deleted,
  etl_upload_dttm as asof_dttm
from x
where rn = 1
  );
  
[0m22:34:47.484166 [debug] [Thread-3 (]: SQL status: SELECT 10 in 0.003 seconds
[0m22:34:47.487001 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.487761 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal" rename to "dim_terminal__dbt_backup"
[0m22:34:47.488795 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.491245 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.491968 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp" rename to "dim_terminal"
[0m22:34:47.492802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.494586 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:34:47.495257 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.495946 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m22:34:47.497512 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.499941 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_terminal__dbt_backup"
[0m22:34:47.501213 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m22:34:47.502060 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
drop table if exists "bank_dwh"."public_ods"."dim_terminal__dbt_backup" cascade
[0m22:34:47.504475 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:47.506064 [debug] [Thread-3 (]: On model.bank_dwh.dim_terminal: Close
[0m22:34:47.507093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96a5f82690>]}
[0m22:34:47.508085 [info ] [Thread-3 (]: 9 of 10 OK created sql table model public_ods.dim_terminal ..................... [[32mSELECT 10[0m in 0.05s]
[0m22:34:47.509154 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_terminal
[0m22:34:47.510503 [debug] [Thread-4 (]: Began running node model.bank_dwh.fct_transactions
[0m22:34:47.511499 [info ] [Thread-4 (]: 10 of 10 START sql table model public_ods.fct_transactions ..................... [RUN]
[0m22:34:47.512448 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_account, now model.bank_dwh.fct_transactions)
[0m22:34:47.513192 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.fct_transactions
[0m22:34:47.516376 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.fct_transactions"
[0m22:34:47.521427 [debug] [Thread-4 (]: Began executing node model.bank_dwh.fct_transactions
[0m22:34:47.524770 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.fct_transactions"
[0m22:34:47.529916 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.530719 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: BEGIN
[0m22:34:47.531490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:34:47.537106 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m22:34:47.537893 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.538759 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */

  
    

  create  table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp"
  
  
    as
  
  (
    

with t as (
  select
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status
  from "bank_dwh"."public_raw"."raw_transaction"
),
c as (
  select card_id, md5(card_id::text) as card_sk, account_id
  from "bank_dwh"."public_raw"."raw_card"
  where is_deleted = false
),
a as (
  select account_id, md5(account_id::text) as account_sk, customer_id
  from "bank_dwh"."public_raw"."raw_account"
  where is_deleted = false
),
cust as (
  select customer_id, customer_sk
  from "bank_dwh"."public_ods"."dim_customer_scd2"
  where is_current = true
),
term as (
  select terminal_id, terminal_sk
  from "bank_dwh"."public_ods"."dim_terminal"
)
select
  t.txn_id,
  t.txn_ts,
  t.amount,
  t.currency_code,
  t.txn_type,
  t.status,
  c.card_sk,
  a.account_sk,
  cust.customer_sk,
  term.terminal_sk
from t
left join c on c.card_id = t.card_id
left join a on a.account_id = c.account_id
left join cust on cust.customer_id = a.customer_id
left join term on term.terminal_id = t.terminal_id
  );
  
[0m22:34:47.545007 [debug] [Thread-4 (]: SQL status: SELECT 500 in 0.005 seconds
[0m22:34:47.549003 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.549883 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions" rename to "fct_transactions__dbt_backup"
[0m22:34:47.551061 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.554273 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.555164 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp" rename to "fct_transactions"
[0m22:34:47.556191 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:34:47.558140 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:34:47.558915 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.559629 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m22:34:47.561500 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m22:34:47.564181 [debug] [Thread-4 (]: Applying DROP to: "bank_dwh"."public_ods"."fct_transactions__dbt_backup"
[0m22:34:47.565350 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m22:34:47.566096 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
drop table if exists "bank_dwh"."public_ods"."fct_transactions__dbt_backup" cascade
[0m22:34:47.568545 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:34:47.570176 [debug] [Thread-4 (]: On model.bank_dwh.fct_transactions: Close
[0m22:34:47.571143 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '448fd185-e3e7-4165-8686-c4102ae1ad70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96abe08950>]}
[0m22:34:47.572176 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public_ods.fct_transactions ................ [[32mSELECT 500[0m in 0.06s]
[0m22:34:47.573252 [debug] [Thread-4 (]: Finished running node model.bank_dwh.fct_transactions
[0m22:34:47.575394 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:47.576149 [debug] [MainThread]: On master: BEGIN
[0m22:34:47.577148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:47.583005 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:34:47.583960 [debug] [MainThread]: On master: COMMIT
[0m22:34:47.584778 [debug] [MainThread]: Using postgres connection "master"
[0m22:34:47.585545 [debug] [MainThread]: On master: COMMIT
[0m22:34:47.586348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:34:47.587038 [debug] [MainThread]: On master: Close
[0m22:34:47.587952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:47.588622 [debug] [MainThread]: Connection 'model.bank_dwh.raw_transaction' was properly closed.
[0m22:34:47.589272 [debug] [MainThread]: Connection 'model.bank_dwh.dim_customer_scd2' was properly closed.
[0m22:34:47.590029 [debug] [MainThread]: Connection 'model.bank_dwh.dim_terminal' was properly closed.
[0m22:34:47.590626 [debug] [MainThread]: Connection 'model.bank_dwh.fct_transactions' was properly closed.
[0m22:34:47.591466 [info ] [MainThread]: 
[0m22:34:47.592184 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m22:34:47.594051 [debug] [MainThread]: Command end result
[0m22:34:47.630444 [info ] [MainThread]: 
[0m22:34:47.631399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:34:47.632169 [info ] [MainThread]: 
[0m22:34:47.632836 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m22:34:47.634056 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4011744, "process_user_time": 2.239973, "process_kernel_time": 0.257515, "process_mem_max_rss": "194988", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:34:47.634940 [debug] [MainThread]: Command `dbt run` succeeded at 22:34:47.634839 after 1.40 seconds
[0m22:34:47.635762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ad2fa550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ad372e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96ad372850>]}
[0m22:34:47.636610 [debug] [MainThread]: Flushing usage events
[0m23:00:06.586910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402db4ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402db7d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402db7e890>]}


============================== 23:00:06.593228 | ce74d062-9105-4077-9add-7dabc8d5a568 ==============================
[0m23:00:06.593228 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:00:06.594396 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '.', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir . --project-dir .', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:06.816477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402db83810>]}
[0m23:00:06.855733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402d19d650>]}
[0m23:00:06.857629 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m23:00:06.868752 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:00:07.071656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:07.072850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:07.098896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402cd9da90>]}
[0m23:00:07.187103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402c538ed0>]}
[0m23:00:07.188070 [info ] [MainThread]: Found 10 models, 4 sources, 424 macros
[0m23:00:07.188862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402cdd2610>]}
[0m23:00:07.191025 [info ] [MainThread]: 
[0m23:00:07.192099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:00:07.195886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m23:00:07.196793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bank_dwh'
[0m23:00:07.234770 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m23:00:07.235241 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh"
[0m23:00:07.236091 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:00:07.237094 [debug] [ThreadPool]: On list_bank_dwh: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh"} */

    select distinct nspname from pg_namespace
  
[0m23:00:07.237820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:07.238790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:07.246877 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.008 seconds
[0m23:00:07.247315 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.009 seconds
[0m23:00:07.248953 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m23:00:07.250390 [debug] [ThreadPool]: On list_bank_dwh: Close
[0m23:00:07.253266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_ods)
[0m23:00:07.253800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_bank_dwh, now list_bank_dwh_public_raw)
[0m23:00:07.259010 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m23:00:07.261046 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m23:00:07.261758 [debug] [ThreadPool]: On list_bank_dwh_public_ods: BEGIN
[0m23:00:07.262402 [debug] [ThreadPool]: On list_bank_dwh_public_raw: BEGIN
[0m23:00:07.263398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:07.264240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:00:07.270296 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:00:07.270691 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:00:07.271276 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_raw"
[0m23:00:07.272044 [debug] [ThreadPool]: Using postgres connection "list_bank_dwh_public_ods"
[0m23:00:07.272742 [debug] [ThreadPool]: On list_bank_dwh_public_raw: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_raw"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_raw'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_raw'
  
[0m23:00:07.273497 [debug] [ThreadPool]: On list_bank_dwh_public_ods: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "list_bank_dwh_public_ods"} */
select
      'bank_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_ods'
    union all
    select
      'bank_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_ods'
  
[0m23:00:07.276715 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m23:00:07.277096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m23:00:07.278384 [debug] [ThreadPool]: On list_bank_dwh_public_raw: ROLLBACK
[0m23:00:07.279872 [debug] [ThreadPool]: On list_bank_dwh_public_ods: ROLLBACK
[0m23:00:07.280773 [debug] [ThreadPool]: On list_bank_dwh_public_raw: Close
[0m23:00:07.281466 [debug] [ThreadPool]: On list_bank_dwh_public_ods: Close
[0m23:00:07.287216 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.287958 [debug] [MainThread]: On master: BEGIN
[0m23:00:07.288582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:00:07.294164 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:00:07.294957 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.295612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m23:00:07.299283 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:00:07.300782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402f8eed50>]}
[0m23:00:07.301812 [debug] [MainThread]: On master: ROLLBACK
[0m23:00:07.302649 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.303255 [debug] [MainThread]: On master: BEGIN
[0m23:00:07.304060 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.304703 [debug] [MainThread]: On master: COMMIT
[0m23:00:07.305552 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.306499 [debug] [MainThread]: On master: COMMIT
[0m23:00:07.307232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:07.307825 [debug] [MainThread]: On master: Close
[0m23:00:07.308609 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:07.309508 [info ] [MainThread]: 
[0m23:00:07.318881 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m23:00:07.319451 [debug] [Thread-2 (]: Began running node model.bank_dwh.raw_card
[0m23:00:07.320030 [debug] [Thread-3 (]: Began running node model.bank_dwh.raw_customer
[0m23:00:07.320464 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_terminal
[0m23:00:07.321172 [info ] [Thread-1 (]: 1 of 10 START sql incremental model public_raw.raw_account ..................... [RUN]
[0m23:00:07.322221 [info ] [Thread-2 (]: 2 of 10 START sql incremental model public_raw.raw_card ........................ [RUN]
[0m23:00:07.323540 [info ] [Thread-3 (]: 3 of 10 START sql incremental model public_raw.raw_customer .................... [RUN]
[0m23:00:07.324512 [info ] [Thread-4 (]: 4 of 10 START sql incremental model public_raw.raw_terminal .................... [RUN]
[0m23:00:07.325408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_ods, now model.bank_dwh.raw_account)
[0m23:00:07.326276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_bank_dwh_public_raw, now model.bank_dwh.raw_card)
[0m23:00:07.327134 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.bank_dwh.raw_customer'
[0m23:00:07.327977 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.bank_dwh.raw_terminal'
[0m23:00:07.328695 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m23:00:07.329570 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.raw_card
[0m23:00:07.330342 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.raw_customer
[0m23:00:07.331015 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_terminal
[0m23:00:07.342792 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m23:00:07.345961 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m23:00:07.348779 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m23:00:07.351693 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m23:00:07.356451 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m23:00:07.356974 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_terminal
[0m23:00:07.357704 [debug] [Thread-3 (]: Began executing node model.bank_dwh.raw_customer
[0m23:00:07.363274 [debug] [Thread-2 (]: Began executing node model.bank_dwh.raw_card
[0m23:00:07.413145 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.414684 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.418156 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.422261 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.423166 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    
  
    

  create temporary table "raw_terminal__dbt_tmp230007386619"
  
  
    as
  
  (
    

select
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  created_at,
  updated_at,
  is_working,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."terminal_snapshot"
  );
  
  
[0m23:00:07.424897 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    
  
    

  create temporary table "raw_account__dbt_tmp230007380557"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'account_id')::bigint as account_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'account'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_account")
  
),
latest as (
  select distinct on (account_id)
    account_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by account_id, event_id desc
)
select
  account_id,
  row_data->>'account_number' as account_number,
  (row_data->>'customer_id')::bigint as customer_id,
  row_data->>'currency_code' as currency_code,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  row_data->>'status' as status,
  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m23:00:07.426042 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    
  
    

  create temporary table "raw_customer__dbt_tmp230007416847"
  
  
    as
  
  (
    

select
  customer_id,
  customer_uuid,
  full_name,
  birth_date,
  email,
  phone,
  city,
  created_at,
  updated_at,
  is_deleted,
  batch_id,
  etl_upload_dttm
from "bank_dwh"."stg"."customer_snapshot"
  );
  
  
[0m23:00:07.427189 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    
  
    

  create temporary table "raw_card__dbt_tmp230007420877"
  
  
    as
  
  (
    

with ev as (
  select
    (pk->>'card_id')::bigint as card_id,
    op,
    event_id,
    event_ts,
    row_data
  from "bank_dwh"."stg"."cdc_events"
  where table_name = 'card'
  
    and event_id > (select coalesce(max(src_event_id), 0) from "bank_dwh"."public_raw"."raw_card")
  
),
latest as (
  select distinct on (card_id)
    card_id,
    op,
    event_id as src_event_id,
    event_ts as src_event_ts,
    row_data
  from ev
  order by card_id, event_id desc
)
select
  card_id,
  row_data->>'card_number' as card_number,
  (row_data->>'account_id')::bigint as account_id,
  row_data->>'status' as status,
  (row_data->>'opened_at')::timestamptz as opened_at,
  (row_data->>'closed_at')::timestamptz as closed_at,
  (row_data->>'created_at')::timestamptz as created_at,
  (row_data->>'updated_at')::timestamptz as updated_at,
  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,
  src_event_id,
  src_event_ts
from latest
  );
  
  
[0m23:00:07.428087 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:00:07.428958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:07.429778 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:00:07.430761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:07.439390 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.011 seconds
[0m23:00:07.439911 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.010 seconds
[0m23:00:07.440286 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m23:00:07.440626 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.010 seconds
[0m23:00:07.453200 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.456142 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.459156 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.461731 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.462760 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: BEGIN
[0m23:00:07.463659 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: BEGIN
[0m23:00:07.464422 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: BEGIN
[0m23:00:07.465275 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: BEGIN
[0m23:00:07.466335 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.467087 [debug] [Thread-3 (]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.468023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.468714 [debug] [Thread-2 (]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.469257 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.470127 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.470905 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.471684 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.472380 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal__dbt_tmp230007386619'
        
      order by ordinal_position

  
[0m23:00:07.473172 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer__dbt_tmp230007416847'
        
      order by ordinal_position

  
[0m23:00:07.473942 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_account__dbt_tmp230007380557'
        
      order by ordinal_position

  
[0m23:00:07.474756 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_card__dbt_tmp230007420877'
        
      order by ordinal_position

  
[0m23:00:07.482069 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.007 seconds
[0m23:00:07.482462 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.006 seconds
[0m23:00:07.487409 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.487870 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.007 seconds
[0m23:00:07.488339 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.007 seconds
[0m23:00:07.491260 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.492196 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.495123 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.497940 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.498695 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.500294 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.501219 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.502511 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.003 seconds
[0m23:00:07.504497 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.002 seconds
[0m23:00:07.511870 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.006 seconds
[0m23:00:07.513694 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.514113 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.009 seconds
[0m23:00:07.516974 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.519856 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.520681 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_terminal'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.523547 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.524459 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_customer'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.525261 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_card'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.526632 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_account'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.528385 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.002 seconds
[0m23:00:07.529427 [debug] [Thread-3 (]: SQL status: SELECT 12 in 0.002 seconds
[0m23:00:07.542425 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m23:00:07.542968 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.012 seconds
[0m23:00:07.543449 [debug] [Thread-2 (]: SQL status: SELECT 11 in 0.013 seconds
[0m23:00:07.545479 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m23:00:07.548678 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m23:00:07.599875 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m23:00:07.601249 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.602773 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.604493 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_terminal"
            using "raw_terminal__dbt_tmp230007386619"
            where (
                
                    "raw_terminal__dbt_tmp230007386619".terminal_id = "bank_dwh"."public_raw"."raw_terminal".terminal_id
                    and 
                
                    "raw_terminal__dbt_tmp230007386619".batch_id = "bank_dwh"."public_raw"."raw_terminal".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_terminal" ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_terminal__dbt_tmp230007386619"
    )
  
[0m23:00:07.604943 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.605705 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_customer"
            using "raw_customer__dbt_tmp230007416847"
            where (
                
                    "raw_customer__dbt_tmp230007416847".customer_id = "bank_dwh"."public_raw"."raw_customer".customer_id
                    and 
                
                    "raw_customer__dbt_tmp230007416847".batch_id = "bank_dwh"."public_raw"."raw_customer".batch_id
                    
                
                
            );
        
    

    insert into "bank_dwh"."public_raw"."raw_customer" ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm")
    (
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "batch_id", "etl_upload_dttm"
        from "raw_customer__dbt_tmp230007416847"
    )
  
[0m23:00:07.606421 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.607297 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_account"
            where (
                account_id) in (
                select (account_id)
                from "raw_account__dbt_tmp230007380557"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_account" ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_account__dbt_tmp230007380557"
    )
  
[0m23:00:07.607760 [debug] [Thread-4 (]: SQL status: INSERT 0 10 in 0.001 seconds
[0m23:00:07.609977 [debug] [Thread-3 (]: SQL status: INSERT 0 50 in 0.001 seconds
[0m23:00:07.610980 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_card"
            where (
                card_id) in (
                select (card_id)
                from "raw_card__dbt_tmp230007420877"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_card" ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts")
    (
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "src_event_id", "src_event_ts"
        from "raw_card__dbt_tmp230007420877"
    )
  
[0m23:00:07.612649 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:00:07.624670 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m23:00:07.626236 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m23:00:07.628530 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m23:00:07.628961 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m23:00:07.629593 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_terminal"
[0m23:00:07.630356 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.raw_customer"
[0m23:00:07.631087 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.raw_account"
[0m23:00:07.632764 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m23:00:07.633546 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: COMMIT
[0m23:00:07.634271 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: COMMIT
[0m23:00:07.635150 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: COMMIT
[0m23:00:07.636036 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.raw_card"
[0m23:00:07.638319 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.638793 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: COMMIT
[0m23:00:07.639118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.639448 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m23:00:07.641227 [debug] [Thread-4 (]: On model.bank_dwh.raw_terminal: Close
[0m23:00:07.642929 [debug] [Thread-1 (]: On model.bank_dwh.raw_account: Close
[0m23:00:07.643285 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.644222 [debug] [Thread-3 (]: On model.bank_dwh.raw_customer: Close
[0m23:00:07.646260 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40284953d0>]}
[0m23:00:07.647216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402dc6b7d0>]}
[0m23:00:07.648192 [debug] [Thread-2 (]: On model.bank_dwh.raw_card: Close
[0m23:00:07.649189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402b9672d0>]}
[0m23:00:07.650147 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model public_raw.raw_terminal ............... [[32mINSERT 0 10[0m in 0.32s]
[0m23:00:07.652741 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model public_raw.raw_account ................ [[32mINSERT 0 0[0m in 0.32s]
[0m23:00:07.653653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402db3a6d0>]}
[0m23:00:07.654510 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model public_raw.raw_customer ............... [[32mINSERT 0 50[0m in 0.32s]
[0m23:00:07.655627 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_terminal
[0m23:00:07.656559 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m23:00:07.657443 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model public_raw.raw_card ................... [[32mINSERT 0 0[0m in 0.33s]
[0m23:00:07.658429 [debug] [Thread-3 (]: Finished running node model.bank_dwh.raw_customer
[0m23:00:07.659283 [debug] [Thread-4 (]: Began running node model.bank_dwh.raw_transaction
[0m23:00:07.660224 [debug] [Thread-1 (]: Began running node model.bank_dwh.dim_terminal
[0m23:00:07.661191 [debug] [Thread-2 (]: Finished running node model.bank_dwh.raw_card
[0m23:00:07.662051 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_account
[0m23:00:07.662957 [info ] [Thread-4 (]: 5 of 10 START sql incremental model public_raw.raw_transaction ................. [RUN]
[0m23:00:07.663995 [info ] [Thread-1 (]: 6 of 10 START sql table model public_ods.dim_terminal .......................... [RUN]
[0m23:00:07.664927 [debug] [Thread-2 (]: Began running node model.bank_dwh.dim_customer_scd2
[0m23:00:07.665848 [info ] [Thread-3 (]: 7 of 10 START sql table model public_ods.dim_account ........................... [RUN]
[0m23:00:07.666679 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m23:00:07.667531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.dim_terminal)
[0m23:00:07.668353 [info ] [Thread-2 (]: 8 of 10 START sql table model public_ods.dim_customer_scd2 ..................... [RUN]
[0m23:00:07.669356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.dim_account)
[0m23:00:07.670320 [debug] [Thread-4 (]: Began compiling node model.bank_dwh.raw_transaction
[0m23:00:07.671148 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.dim_terminal
[0m23:00:07.671978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.dim_customer_scd2)
[0m23:00:07.672754 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_account
[0m23:00:07.676197 [debug] [Thread-4 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m23:00:07.679142 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.dim_terminal"
[0m23:00:07.680017 [debug] [Thread-2 (]: Began compiling node model.bank_dwh.dim_customer_scd2
[0m23:00:07.682584 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_account"
[0m23:00:07.686508 [debug] [Thread-2 (]: Writing injected SQL for node "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.690208 [debug] [Thread-1 (]: Began executing node model.bank_dwh.dim_terminal
[0m23:00:07.690643 [debug] [Thread-4 (]: Began executing node model.bank_dwh.raw_transaction
[0m23:00:07.690988 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_account
[0m23:00:07.691295 [debug] [Thread-2 (]: Began executing node model.bank_dwh.dim_customer_scd2
[0m23:00:07.701695 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.dim_terminal"
[0m23:00:07.705952 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.709177 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_account"
[0m23:00:07.712531 [debug] [Thread-2 (]: Writing runtime sql for node "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.714057 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    
  
    

  create temporary table "raw_transaction__dbt_tmp230007704299"
  
  
    as
  
  (
    

select
  txn_id,
  card_id,
  terminal_id,
  txn_ts,
  amount,
  currency_code,
  txn_type,
  status,
  etl_upload_dttm
from "bank_dwh"."stg"."transaction_increment"
  );
  
  
[0m23:00:07.716199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:00:07.717364 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.717744 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.718473 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: BEGIN
[0m23:00:07.718895 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.719533 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: BEGIN
[0m23:00:07.720324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:07.721227 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: BEGIN
[0m23:00:07.722055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:07.723473 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:00:07.723874 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.008 seconds
[0m23:00:07.728028 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.730319 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m23:00:07.730664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m23:00:07.731081 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m23:00:07.731402 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: BEGIN
[0m23:00:07.732221 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.733022 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.733792 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.734800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.000 seconds
[0m23:00:07.735367 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_account__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(account_id::text) as account_sk,
  account_id,
  account_number,
  customer_id,
  currency_code,
  opened_at,
  closed_at,
  status,
  daily_transfer_limit,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_account"
  );
  
[0m23:00:07.736135 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp"
  
  
    as
  
  (
    

with x as (
  select
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    etl_upload_dttm,
    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn
  from "bank_dwh"."public_raw"."raw_terminal"
)
select
  md5(terminal_id::text) as terminal_sk,
  terminal_id,
  terminal_code,
  city,
  country,
  latitude,
  longitude,
  is_working,
  is_deleted,
  etl_upload_dttm as asof_dttm
from x
where rn = 1
  );
  
[0m23:00:07.736926 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm,
    md5(
      coalesce(customer_uuid::text,'') || '|' ||
      coalesce(full_name,'') || '|' ||
      coalesce(birth_date::text,'') || '|' ||
      coalesce(email,'') || '|' ||
      coalesce(phone,'') || '|' ||
      coalesce(city,'') || '|' ||
      coalesce(is_deleted::text,'')
    ) as diff
  from "bank_dwh"."public_raw"."raw_customer"
),
chg as (
  select
    *,
    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff
  from base
),
filt as (
  select
    *
  from chg
  where prev_diff is distinct from diff
),
scd as (
  select
    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    etl_upload_dttm as valid_from,
    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,
    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current
  from filt
)
select * from scd
  );
  
[0m23:00:07.737738 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.741200 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction__dbt_tmp230007704299'
        
      order by ordinal_position

  
[0m23:00:07.743160 [debug] [Thread-3 (]: SQL status: SELECT 80 in 0.005 seconds
[0m23:00:07.743980 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.005 seconds
[0m23:00:07.749662 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.750017 [debug] [Thread-2 (]: SQL status: SELECT 50 in 0.011 seconds
[0m23:00:07.750371 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.008 seconds
[0m23:00:07.753246 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.754033 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account" rename to "dim_account__dbt_backup"
[0m23:00:07.757066 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.759897 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.760799 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal" rename to "dim_terminal__dbt_backup"
[0m23:00:07.761959 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2" rename to "dim_customer_scd2__dbt_backup"
[0m23:00:07.762310 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m23:00:07.763028 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.764104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.764935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.767230 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.770364 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.770740 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.003 seconds
[0m23:00:07.773231 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.774056 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
alter table "bank_dwh"."public_ods"."dim_account__dbt_tmp" rename to "dim_account"
[0m23:00:07.774798 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
alter table "bank_dwh"."public_ods"."dim_terminal__dbt_tmp" rename to "dim_terminal"
[0m23:00:07.777664 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.778528 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
alter table "bank_dwh"."public_ods"."dim_customer_scd2__dbt_tmp" rename to "dim_customer_scd2"
[0m23:00:07.779610 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.780288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.780613 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "bank_dwh".INFORMATION_SCHEMA.columns
      where table_name = 'raw_transaction'
        
        and table_schema = 'public_raw'
        
      order by ordinal_position

  
[0m23:00:07.781679 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.787181 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: COMMIT
[0m23:00:07.788907 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m23:00:07.791499 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m23:00:07.791947 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.002 seconds
[0m23:00:07.792538 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.793339 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.794187 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.796393 [debug] [Thread-4 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m23:00:07.797258 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: COMMIT
[0m23:00:07.798062 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: COMMIT
[0m23:00:07.798893 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: COMMIT
[0m23:00:07.801127 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.801739 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.802255 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.807153 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_account__dbt_backup"
[0m23:00:07.809894 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_terminal__dbt_backup"
[0m23:00:07.810313 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.813937 [debug] [Thread-2 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup"
[0m23:00:07.818766 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_account"
[0m23:00:07.820363 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.dim_terminal"
[0m23:00:07.821279 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

      
        
            delete from "bank_dwh"."public_raw"."raw_transaction"
            where (
                txn_id) in (
                select (txn_id)
                from "raw_transaction__dbt_tmp230007704299"
            );

        
    

    insert into "bank_dwh"."public_raw"."raw_transaction" ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm")
    (
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "etl_upload_dttm"
        from "raw_transaction__dbt_tmp230007704299"
    )
  
[0m23:00:07.822455 [debug] [Thread-2 (]: Using postgres connection "model.bank_dwh.dim_customer_scd2"
[0m23:00:07.823258 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_account"} */
drop table if exists "bank_dwh"."public_ods"."dim_account__dbt_backup" cascade
[0m23:00:07.823953 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_terminal"} */
drop table if exists "bank_dwh"."public_ods"."dim_terminal__dbt_backup" cascade
[0m23:00:07.825251 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_customer_scd2"} */
drop table if exists "bank_dwh"."public_ods"."dim_customer_scd2__dbt_backup" cascade
[0m23:00:07.825697 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m23:00:07.829053 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m23:00:07.829442 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:07.829752 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:07.830144 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:07.830649 [debug] [Thread-4 (]: Using postgres connection "model.bank_dwh.raw_transaction"
[0m23:00:07.832077 [debug] [Thread-3 (]: On model.bank_dwh.dim_account: Close
[0m23:00:07.833889 [debug] [Thread-1 (]: On model.bank_dwh.dim_terminal: Close
[0m23:00:07.835440 [debug] [Thread-2 (]: On model.bank_dwh.dim_customer_scd2: Close
[0m23:00:07.836271 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: COMMIT
[0m23:00:07.837329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402e03d290>]}
[0m23:00:07.838256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402cdf9c50>]}
[0m23:00:07.839328 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402a5aa310>]}
[0m23:00:07.841237 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.840774 [info ] [Thread-3 (]: 7 of 10 OK created sql table model public_ods.dim_account ...................... [[32mSELECT 80[0m in 0.17s]
[0m23:00:07.842259 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public_ods.dim_terminal ..................... [[32mSELECT 10[0m in 0.17s]
[0m23:00:07.843323 [info ] [Thread-2 (]: 8 of 10 OK created sql table model public_ods.dim_customer_scd2 ................ [[32mSELECT 50[0m in 0.17s]
[0m23:00:07.844275 [debug] [Thread-4 (]: On model.bank_dwh.raw_transaction: Close
[0m23:00:07.845221 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_account
[0m23:00:07.846133 [debug] [Thread-1 (]: Finished running node model.bank_dwh.dim_terminal
[0m23:00:07.847019 [debug] [Thread-2 (]: Finished running node model.bank_dwh.dim_customer_scd2
[0m23:00:07.847995 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402cd3b550>]}
[0m23:00:07.848678 [debug] [Thread-3 (]: Began running node model.bank_dwh.dim_card
[0m23:00:07.850711 [info ] [Thread-4 (]: 5 of 10 OK created sql incremental model public_raw.raw_transaction ............ [[32mINSERT 0 0[0m in 0.18s]
[0m23:00:07.851536 [info ] [Thread-3 (]: 9 of 10 START sql table model public_ods.dim_card .............................. [RUN]
[0m23:00:07.852471 [debug] [Thread-4 (]: Finished running node model.bank_dwh.raw_transaction
[0m23:00:07.853368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_account, now model.bank_dwh.dim_card)
[0m23:00:07.854482 [debug] [Thread-1 (]: Began running node model.bank_dwh.fct_transactions
[0m23:00:07.854985 [debug] [Thread-3 (]: Began compiling node model.bank_dwh.dim_card
[0m23:00:07.855712 [info ] [Thread-1 (]: 10 of 10 START sql table model public_ods.fct_transactions ..................... [RUN]
[0m23:00:07.858599 [debug] [Thread-3 (]: Writing injected SQL for node "model.bank_dwh.dim_card"
[0m23:00:07.859464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.dim_terminal, now model.bank_dwh.fct_transactions)
[0m23:00:07.860549 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.fct_transactions
[0m23:00:07.863833 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.fct_transactions"
[0m23:00:07.866863 [debug] [Thread-3 (]: Began executing node model.bank_dwh.dim_card
[0m23:00:07.870856 [debug] [Thread-3 (]: Writing runtime sql for node "model.bank_dwh.dim_card"
[0m23:00:07.871258 [debug] [Thread-1 (]: Began executing node model.bank_dwh.fct_transactions
[0m23:00:07.874477 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.fct_transactions"
[0m23:00:07.877560 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.878473 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.878826 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: BEGIN
[0m23:00:07.879521 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: BEGIN
[0m23:00:07.880263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:00:07.881201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:00:07.887145 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m23:00:07.887679 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m23:00:07.888507 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.889616 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.890454 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */

  
    

  create  table "bank_dwh"."public_ods"."dim_card__dbt_tmp"
  
  
    as
  
  (
    

select
  md5(card_id::text) as card_sk,
  card_id,
  card_number,
  account_id,
  status,
  opened_at,
  closed_at,
  created_at,
  updated_at,
  is_deleted,
  src_event_id,
  src_event_ts
from "bank_dwh"."public_raw"."raw_card"
  );
  
[0m23:00:07.891312 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */

  
    

  create  table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp"
  
  
    as
  
  (
    

with t as (
  select
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status
  from "bank_dwh"."public_raw"."raw_transaction"
),
c as (
  select card_id, md5(card_id::text) as card_sk, account_id
  from "bank_dwh"."public_raw"."raw_card"
  where is_deleted = false
),
a as (
  select account_id, md5(account_id::text) as account_sk, customer_id
  from "bank_dwh"."public_raw"."raw_account"
  where is_deleted = false
),
cust as (
  select customer_id, customer_sk
  from "bank_dwh"."public_ods"."dim_customer_scd2"
  where is_current = true
),
term as (
  select terminal_id, terminal_sk
  from "bank_dwh"."public_ods"."dim_terminal"
)
select
  t.txn_id,
  t.txn_ts,
  t.amount,
  t.currency_code,
  t.txn_type,
  t.status,
  c.card_sk,
  a.account_sk,
  cust.customer_sk,
  term.terminal_sk
from t
left join c on c.card_id = t.card_id
left join a on a.account_id = c.account_id
left join cust on cust.customer_id = a.customer_id
left join term on term.terminal_id = t.terminal_id
  );
  
[0m23:00:07.896140 [debug] [Thread-3 (]: SQL status: SELECT 160 in 0.004 seconds
[0m23:00:07.899481 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.899883 [debug] [Thread-1 (]: SQL status: SELECT 500 in 0.007 seconds
[0m23:00:07.900509 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card" rename to "dim_card__dbt_backup"
[0m23:00:07.903439 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.904509 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.904841 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions" rename to "fct_transactions__dbt_backup"
[0m23:00:07.907725 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.908888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.909199 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
alter table "bank_dwh"."public_ods"."dim_card__dbt_tmp" rename to "dim_card"
[0m23:00:07.911877 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.912980 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.913324 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
alter table "bank_dwh"."public_ods"."fct_transactions__dbt_tmp" rename to "fct_transactions"
[0m23:00:07.915127 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m23:00:07.916136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m23:00:07.916574 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.918525 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m23:00:07.919281 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: COMMIT
[0m23:00:07.919932 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.921004 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: COMMIT
[0m23:00:07.921840 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m23:00:07.924251 [debug] [Thread-3 (]: Applying DROP to: "bank_dwh"."public_ods"."dim_card__dbt_backup"
[0m23:00:07.924613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m23:00:07.925639 [debug] [Thread-3 (]: Using postgres connection "model.bank_dwh.dim_card"
[0m23:00:07.927941 [debug] [Thread-1 (]: Applying DROP to: "bank_dwh"."public_ods"."fct_transactions__dbt_backup"
[0m23:00:07.928659 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.dim_card"} */
drop table if exists "bank_dwh"."public_ods"."dim_card__dbt_backup" cascade
[0m23:00:07.929865 [debug] [Thread-1 (]: Using postgres connection "model.bank_dwh.fct_transactions"
[0m23:00:07.931269 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "bank_dwh", "target_name": "dev", "node_id": "model.bank_dwh.fct_transactions"} */
drop table if exists "bank_dwh"."public_ods"."fct_transactions__dbt_backup" cascade
[0m23:00:07.932914 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m23:00:07.934732 [debug] [Thread-3 (]: On model.bank_dwh.dim_card: Close
[0m23:00:07.935142 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m23:00:07.936146 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402b99fa10>]}
[0m23:00:07.937932 [debug] [Thread-1 (]: On model.bank_dwh.fct_transactions: Close
[0m23:00:07.938907 [info ] [Thread-3 (]: 9 of 10 OK created sql table model public_ods.dim_card ......................... [[32mSELECT 160[0m in 0.08s]
[0m23:00:07.939846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce74d062-9105-4077-9add-7dabc8d5a568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a402cdf9f10>]}
[0m23:00:07.940583 [debug] [Thread-3 (]: Finished running node model.bank_dwh.dim_card
[0m23:00:07.941530 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public_ods.fct_transactions ................ [[32mSELECT 500[0m in 0.08s]
[0m23:00:07.942953 [debug] [Thread-1 (]: Finished running node model.bank_dwh.fct_transactions
[0m23:00:07.944949 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.945731 [debug] [MainThread]: On master: BEGIN
[0m23:00:07.946411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:00:07.951856 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:00:07.952590 [debug] [MainThread]: On master: COMMIT
[0m23:00:07.953281 [debug] [MainThread]: Using postgres connection "master"
[0m23:00:07.954140 [debug] [MainThread]: On master: COMMIT
[0m23:00:07.954899 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:00:07.955486 [debug] [MainThread]: On master: Close
[0m23:00:07.956267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:07.956878 [debug] [MainThread]: Connection 'model.bank_dwh.fct_transactions' was properly closed.
[0m23:00:07.957563 [debug] [MainThread]: Connection 'model.bank_dwh.dim_customer_scd2' was properly closed.
[0m23:00:07.958213 [debug] [MainThread]: Connection 'model.bank_dwh.dim_card' was properly closed.
[0m23:00:07.958738 [debug] [MainThread]: Connection 'model.bank_dwh.raw_transaction' was properly closed.
[0m23:00:07.959419 [info ] [MainThread]: 
[0m23:00:07.960137 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m23:00:07.962063 [debug] [MainThread]: Command end result
[0m23:00:07.999085 [info ] [MainThread]: 
[0m23:00:08.000007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:08.000863 [info ] [MainThread]: 
[0m23:00:08.001556 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m23:00:08.003818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4686593, "process_user_time": 2.347755, "process_kernel_time": 0.291948, "process_mem_max_rss": "195000", "process_in_blocks": "74744", "process_out_blocks": "0"}
[0m23:00:08.004698 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:08.004602 after 1.47 seconds
[0m23:00:08.005555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4031a57010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40319cd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a40319ce7d0>]}
[0m23:00:08.006248 [debug] [MainThread]: Flushing usage events
