{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.8", "generated_at": "2025-12-19T23:00:07.960888Z", "invocation_id": "ce74d062-9105-4077-9add-7dabc8d5a568", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.349600Z", "completed_at": "2025-12-19T23:00:07.356787Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.384513Z", "completed_at": "2025-12-19T23:00:07.641128Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3174126148223877, "adapter_response": {"_message": "INSERT 0 10", "code": "INSERT", "rows_affected": 10}, "message": "INSERT 0 10", "failures": null, "unique_id": "model.bank_dwh.raw_terminal", "compiled": true, "compiled_code": "\n\nselect\n  terminal_id,\n  terminal_code,\n  city,\n  country,\n  latitude,\n  longitude,\n  created_at,\n  updated_at,\n  is_working,\n  is_deleted,\n  batch_id,\n  etl_upload_dttm\nfrom \"bank_dwh\".\"stg\".\"terminal_snapshot\"", "relation_name": "\"bank_dwh\".\"public_raw\".\"raw_terminal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.331622Z", "completed_at": "2025-12-19T23:00:07.356316Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.357956Z", "completed_at": "2025-12-19T23:00:07.642854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32185816764831543, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.bank_dwh.raw_account", "compiled": true, "compiled_code": "\n\nwith ev as (\n  select\n    (pk->>'account_id')::bigint as account_id,\n    op,\n    event_id,\n    event_ts,\n    row_data\n  from \"bank_dwh\".\"stg\".\"cdc_events\"\n  where table_name = 'account'\n  \n    and event_id > (select coalesce(max(src_event_id), 0) from \"bank_dwh\".\"public_raw\".\"raw_account\")\n  \n),\nlatest as (\n  select distinct on (account_id)\n    account_id,\n    op,\n    event_id as src_event_id,\n    event_ts as src_event_ts,\n    row_data\n  from ev\n  order by account_id, event_id desc\n)\nselect\n  account_id,\n  row_data->>'account_number' as account_number,\n  (row_data->>'customer_id')::bigint as customer_id,\n  row_data->>'currency_code' as currency_code,\n  (row_data->>'opened_at')::timestamptz as opened_at,\n  (row_data->>'closed_at')::timestamptz as closed_at,\n  row_data->>'status' as status,\n  (row_data->>'daily_transfer_limit')::numeric as daily_transfer_limit,\n  (row_data->>'created_at')::timestamptz as created_at,\n  (row_data->>'updated_at')::timestamptz as updated_at,\n  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,\n  src_event_id,\n  src_event_ts\nfrom latest", "relation_name": "\"bank_dwh\".\"public_raw\".\"raw_account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.346678Z", "completed_at": "2025-12-19T23:00:07.357615Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.415159Z", "completed_at": "2025-12-19T23:00:07.644149Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3221592903137207, "adapter_response": {"_message": "INSERT 0 50", "code": "INSERT", "rows_affected": 50}, "message": "INSERT 0 50", "failures": null, "unique_id": "model.bank_dwh.raw_customer", "compiled": true, "compiled_code": "\n\nselect\n  customer_id,\n  customer_uuid,\n  full_name,\n  birth_date,\n  email,\n  phone,\n  city,\n  created_at,\n  updated_at,\n  is_deleted,\n  batch_id,\n  etl_upload_dttm\nfrom \"bank_dwh\".\"stg\".\"customer_snapshot\"", "relation_name": "\"bank_dwh\".\"public_raw\".\"raw_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.343340Z", "completed_at": "2025-12-19T23:00:07.363128Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.419280Z", "completed_at": "2025-12-19T23:00:07.648114Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3274059295654297, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.bank_dwh.raw_card", "compiled": true, "compiled_code": "\n\nwith ev as (\n  select\n    (pk->>'card_id')::bigint as card_id,\n    op,\n    event_id,\n    event_ts,\n    row_data\n  from \"bank_dwh\".\"stg\".\"cdc_events\"\n  where table_name = 'card'\n  \n    and event_id > (select coalesce(max(src_event_id), 0) from \"bank_dwh\".\"public_raw\".\"raw_card\")\n  \n),\nlatest as (\n  select distinct on (card_id)\n    card_id,\n    op,\n    event_id as src_event_id,\n    event_ts as src_event_ts,\n    row_data\n  from ev\n  order by card_id, event_id desc\n)\nselect\n  card_id,\n  row_data->>'card_number' as card_number,\n  (row_data->>'account_id')::bigint as account_id,\n  row_data->>'status' as status,\n  (row_data->>'opened_at')::timestamptz as opened_at,\n  (row_data->>'closed_at')::timestamptz as closed_at,\n  (row_data->>'created_at')::timestamptz as created_at,\n  (row_data->>'updated_at')::timestamptz as updated_at,\n  case when op = 'd' then true else coalesce((row_data->>'is_deleted')::boolean, false) end as is_deleted,\n  src_event_id,\n  src_event_ts\nfrom latest", "relation_name": "\"bank_dwh\".\"public_raw\".\"raw_card\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.680686Z", "completed_at": "2025-12-19T23:00:07.690899Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.706744Z", "completed_at": "2025-12-19T23:00:07.832007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1679689884185791, "adapter_response": {"_message": "SELECT 80", "code": "SELECT", "rows_affected": 80}, "message": "SELECT 80", "failures": null, "unique_id": "model.bank_dwh.dim_account", "compiled": true, "compiled_code": "\n\nselect\n  md5(account_id::text) as account_sk,\n  account_id,\n  account_number,\n  customer_id,\n  currency_code,\n  opened_at,\n  closed_at,\n  status,\n  daily_transfer_limit,\n  created_at,\n  updated_at,\n  is_deleted,\n  src_event_id,\n  src_event_ts\nfrom \"bank_dwh\".\"public_raw\".\"raw_account\"", "relation_name": "\"bank_dwh\".\"public_ods\".\"dim_account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.677055Z", "completed_at": "2025-12-19T23:00:07.690082Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.691731Z", "completed_at": "2025-12-19T23:00:07.833788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17070317268371582, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.bank_dwh.dim_terminal", "compiled": true, "compiled_code": "\n\nwith x as (\n  select\n    terminal_id,\n    terminal_code,\n    city,\n    country,\n    latitude,\n    longitude,\n    is_working,\n    is_deleted,\n    etl_upload_dttm,\n    row_number() over (partition by terminal_id order by etl_upload_dttm desc) as rn\n  from \"bank_dwh\".\"public_raw\".\"raw_terminal\"\n)\nselect\n  md5(terminal_id::text) as terminal_sk,\n  terminal_id,\n  terminal_code,\n  city,\n  country,\n  latitude,\n  longitude,\n  is_working,\n  is_deleted,\n  etl_upload_dttm as asof_dttm\nfrom x\nwhere rn = 1", "relation_name": "\"bank_dwh\".\"public_ods\".\"dim_terminal\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.684366Z", "completed_at": "2025-12-19T23:00:07.691218Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.710104Z", "completed_at": "2025-12-19T23:00:07.835370Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16735172271728516, "adapter_response": {"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}, "message": "SELECT 50", "failures": null, "unique_id": "model.bank_dwh.dim_customer_scd2", "compiled": true, "compiled_code": "\n\nwith base as (\n  select\n    customer_id,\n    customer_uuid,\n    full_name,\n    birth_date,\n    email,\n    phone,\n    city,\n    is_deleted,\n    etl_upload_dttm,\n    md5(\n      coalesce(customer_uuid::text,'') || '|' ||\n      coalesce(full_name,'') || '|' ||\n      coalesce(birth_date::text,'') || '|' ||\n      coalesce(email,'') || '|' ||\n      coalesce(phone,'') || '|' ||\n      coalesce(city,'') || '|' ||\n      coalesce(is_deleted::text,'')\n    ) as diff\n  from \"bank_dwh\".\"public_raw\".\"raw_customer\"\n),\nchg as (\n  select\n    *,\n    lag(diff) over (partition by customer_id order by etl_upload_dttm) as prev_diff\n  from base\n),\nfilt as (\n  select\n    *\n  from chg\n  where prev_diff is distinct from diff\n),\nscd as (\n  select\n    md5(customer_id::text || '|' || etl_upload_dttm::text) as customer_sk,\n    customer_id,\n    customer_uuid,\n    full_name,\n    birth_date,\n    email,\n    phone,\n    city,\n    is_deleted,\n    etl_upload_dttm as valid_from,\n    coalesce(lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) - interval '1 second', timestamptz '9999-12-31') as valid_to,\n    case when lead(etl_upload_dttm) over (partition by customer_id order by etl_upload_dttm) is null then true else false end as is_current\n  from filt\n)\nselect * from scd", "relation_name": "\"bank_dwh\".\"public_ods\".\"dim_customer_scd2\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.673488Z", "completed_at": "2025-12-19T23:00:07.690499Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.702590Z", "completed_at": "2025-12-19T23:00:07.844199Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.18135666847229004, "adapter_response": {"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}, "message": "INSERT 0 0", "failures": null, "unique_id": "model.bank_dwh.raw_transaction", "compiled": true, "compiled_code": "\n\nselect\n  txn_id,\n  card_id,\n  terminal_id,\n  txn_ts,\n  amount,\n  currency_code,\n  txn_type,\n  status,\n  etl_upload_dttm\nfrom \"bank_dwh\".\"stg\".\"transaction_increment\"", "relation_name": "\"bank_dwh\".\"public_raw\".\"raw_transaction\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.856254Z", "completed_at": "2025-12-19T23:00:07.866758Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.867670Z", "completed_at": "2025-12-19T23:00:07.934655Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08275294303894043, "adapter_response": {"_message": "SELECT 160", "code": "SELECT", "rows_affected": 160}, "message": "SELECT 160", "failures": null, "unique_id": "model.bank_dwh.dim_card", "compiled": true, "compiled_code": "\n\nselect\n  md5(card_id::text) as card_sk,\n  card_id,\n  card_number,\n  account_id,\n  status,\n  opened_at,\n  closed_at,\n  created_at,\n  updated_at,\n  is_deleted,\n  src_event_id,\n  src_event_ts\nfrom \"bank_dwh\".\"public_raw\".\"raw_card\"", "relation_name": "\"bank_dwh\".\"public_ods\".\"dim_card\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-19T23:00:07.861226Z", "completed_at": "2025-12-19T23:00:07.871158Z"}, {"name": "execute", "started_at": "2025-12-19T23:00:07.872251Z", "completed_at": "2025-12-19T23:00:07.937857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08041930198669434, "adapter_response": {"_message": "SELECT 500", "code": "SELECT", "rows_affected": 500}, "message": "SELECT 500", "failures": null, "unique_id": "model.bank_dwh.fct_transactions", "compiled": true, "compiled_code": "\n\nwith t as (\n  select\n    txn_id,\n    card_id,\n    terminal_id,\n    txn_ts,\n    amount,\n    currency_code,\n    txn_type,\n    status\n  from \"bank_dwh\".\"public_raw\".\"raw_transaction\"\n),\nc as (\n  select card_id, md5(card_id::text) as card_sk, account_id\n  from \"bank_dwh\".\"public_raw\".\"raw_card\"\n  where is_deleted = false\n),\na as (\n  select account_id, md5(account_id::text) as account_sk, customer_id\n  from \"bank_dwh\".\"public_raw\".\"raw_account\"\n  where is_deleted = false\n),\ncust as (\n  select customer_id, customer_sk\n  from \"bank_dwh\".\"public_ods\".\"dim_customer_scd2\"\n  where is_current = true\n),\nterm as (\n  select terminal_id, terminal_sk\n  from \"bank_dwh\".\"public_ods\".\"dim_terminal\"\n)\nselect\n  t.txn_id,\n  t.txn_ts,\n  t.amount,\n  t.currency_code,\n  t.txn_type,\n  t.status,\n  c.card_sk,\n  a.account_sk,\n  cust.customer_sk,\n  term.terminal_sk\nfrom t\nleft join c on c.card_id = t.card_id\nleft join a on a.account_id = c.account_id\nleft join cust on cust.customer_id = a.customer_id\nleft join term on term.terminal_id = t.terminal_id", "relation_name": "\"bank_dwh\".\"public_ods\".\"fct_transactions\""}], "elapsed_time": 0.7673873901367188, "args": {"require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "enable_legacy_logger": false, "log_format_file": "debug", "project_dir": ".", "invocation_command": "dbt run --profiles-dir . --project-dir .", "static_parser": true, "empty": false, "cache_selected_only": false, "use_colors": true, "indirect_selection": "eager", "show_resource_report": false, "log_path": "logs", "which": "run", "log_file_max_bytes": 10485760, "write_json": true, "log_format": "default", "favor_state": false, "select": [], "warn_error_options": {"include": [], "exclude": []}, "defer": false, "vars": {}, "source_freshness_run_project_hooks": false, "version_check": true, "partial_parse_file_diff": true, "strict_mode": false, "partial_parse": true, "log_level_file": "debug", "quiet": false, "printer_width": 80, "send_anonymous_usage_stats": true, "print": true, "exclude": [], "macro_debugging": false, "profiles_dir": ".", "use_colors_file": true, "introspect": true, "log_level": "info", "populate_cache": true}}