[0m07:30:47.625474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87944b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87944c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c93650>]}


============================== 07:30:47.630685 | c6830dae-ecbf-4c69-902c-2a7588be0079 ==============================
[0m07:30:47.630685 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:30:47.631536 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'warn_error': 'None', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'invocation_command': 'dbt run --select raw_* ods_*', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m07:30:47.662924 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "bank_clickhouse", target "dev" invalid: False is not of type 'string'
[0m07:30:47.663968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0810925, "process_in_blocks": "1152", "process_kernel_time": 0.274175, "process_mem_max_rss": "106252", "process_out_blocks": "1195", "process_user_time": 1.305836}
[0m07:30:47.664450 [debug] [MainThread]: Command `dbt run` failed at 07:30:47.664381 after 0.08 seconds
[0m07:30:47.664825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c81a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8797be90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87903810>]}
[0m07:30:47.665194 [debug] [MainThread]: Flushing usage events
[0m07:30:48.267189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:59.756774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d64990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d655d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d65190>]}


============================== 07:34:59.762391 | dbe0e22f-87a0-489a-9496-0d4d4d5bcb18 ==============================
[0m07:34:59.762391 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:34:59.763125 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select raw_* ods_*', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None'}
[0m07:34:59.910932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ce1390>]}
[0m07:34:59.945359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a216d0>]}
[0m07:34:59.946223 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m07:34:59.998112 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:34:59.998847 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:34:59.999498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92aadf90>]}
[0m07:35:00.855795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9270d9d0>]}
[0m07:35:00.905615 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:35:00.907101 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:35:00.936611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b389d0>]}
[0m07:35:00.940986 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m07:35:00.971835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbe0e22f-87a0-489a-9496-0d4d4d5bcb18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f220d0>]}
[0m07:35:00.973799 [warn ] [MainThread]: The selection criterion 'raw_*' does not match any enabled nodes
[0m07:35:00.975150 [warn ] [MainThread]: The selection criterion 'ods_*' does not match any enabled nodes
[0m07:35:00.978057 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:35:00.983927 [debug] [MainThread]: Command end result
[0m07:35:01.015905 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:35:01.017270 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:35:01.019530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:35:01.020407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2988224, "process_in_blocks": "168", "process_kernel_time": 0.441664, "process_mem_max_rss": "119932", "process_out_blocks": "3347", "process_user_time": 2.677652}
[0m07:35:01.020858 [debug] [MainThread]: Command `dbt run` succeeded at 07:35:01.020777 after 1.30 seconds
[0m07:35:01.021170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97a6d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953746d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ad72d0>]}
[0m07:35:01.021515 [debug] [MainThread]: Flushing usage events
[0m07:35:01.633193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:39:32.013567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97600c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97634490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97600e10>]}


============================== 07:39:32.018726 | b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd ==============================
[0m07:39:32.018726 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:39:32.019482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'debug': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'no_print': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt ls'}
[0m07:39:32.131202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9757e5d0>]}
[0m07:39:32.171473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff976c3b90>]}
[0m07:39:32.172593 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m07:39:32.228015 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:39:32.300518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:39:32.300878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:39:32.322160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97113c90>]}
[0m07:39:32.374783 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:39:32.376635 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:39:32.389840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975dd5d0>]}
[0m07:39:32.390261 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m07:39:32.390722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0e8ff4a-3c74-4ffe-afcd-a3083fbbedfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979e2d10>]}
[0m07:39:32.391521 [info ] [MainThread]: bank_dwh.ods.ods_dim_account
[0m07:39:32.391944 [info ] [MainThread]: bank_dwh.ods.ods_dim_card
[0m07:39:32.392250 [info ] [MainThread]: bank_dwh.ods.ods_dim_customer
[0m07:39:32.392713 [info ] [MainThread]: bank_dwh.ods.ods_dim_terminal
[0m07:39:32.393112 [info ] [MainThread]: bank_dwh.ods.ods_fact_atm_transaction
[0m07:39:32.393416 [info ] [MainThread]: bank_dwh.raw.raw_account
[0m07:39:32.393839 [info ] [MainThread]: bank_dwh.raw.raw_card
[0m07:39:32.394205 [info ] [MainThread]: bank_dwh.raw.raw_customer
[0m07:39:32.394524 [info ] [MainThread]: bank_dwh.raw.raw_terminal
[0m07:39:32.394852 [info ] [MainThread]: bank_dwh.raw.raw_transaction
[0m07:39:32.395177 [info ] [MainThread]: bank_dwh.stg.stg_account
[0m07:39:32.395558 [info ] [MainThread]: bank_dwh.stg.stg_card
[0m07:39:32.395864 [info ] [MainThread]: bank_dwh.stg.stg_customer
[0m07:39:32.396179 [info ] [MainThread]: bank_dwh.stg.stg_terminal
[0m07:39:32.396495 [info ] [MainThread]: bank_dwh.stg.stg_transaction
[0m07:39:32.396828 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_account
[0m07:39:32.397132 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_card
[0m07:39:32.397429 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_customer
[0m07:39:32.397894 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_terminal
[0m07:39:32.398207 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_transaction
[0m07:39:32.399202 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4189034, "process_in_blocks": "0", "process_kernel_time": 0.271473, "process_mem_max_rss": "114864", "process_out_blocks": "1155", "process_user_time": 1.479129}
[0m07:39:32.399892 [debug] [MainThread]: Command `dbt ls` succeeded at 07:39:32.399770 after 0.42 seconds
[0m07:39:32.400350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97676510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ac32450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c66c2d0>]}
[0m07:39:32.400931 [debug] [MainThread]: Flushing usage events
[0m07:39:33.027309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:40:07.599645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d18bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d181d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d18d50>]}


============================== 07:40:07.606240 | 46ad3de9-7629-4b92-b9d9-ae433aa2fe49 ==============================
[0m07:40:07.606240 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:40:07.606898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select raw_* ods_*', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'version_check': 'True', 'warn_error': 'None', 'log_format': 'default', 'target_path': 'None', 'empty': 'False'}
[0m07:40:07.712471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46ad3de9-7629-4b92-b9d9-ae433aa2fe49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ca6dd0>]}
[0m07:40:07.746567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46ad3de9-7629-4b92-b9d9-ae433aa2fe49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8ad98d0>]}
[0m07:40:07.747203 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m07:40:07.791085 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:40:07.861395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:40:07.861778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:40:07.883849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46ad3de9-7629-4b92-b9d9-ae433aa2fe49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7849310>]}
[0m07:40:07.956808 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:40:07.958925 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:40:08.007909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46ad3de9-7629-4b92-b9d9-ae433aa2fe49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7af0250>]}
[0m07:40:08.008685 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m07:40:08.009327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46ad3de9-7629-4b92-b9d9-ae433aa2fe49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bba910>]}
[0m07:40:08.010304 [warn ] [MainThread]: The selection criterion 'raw_*' does not match any enabled nodes
[0m07:40:08.010836 [warn ] [MainThread]: The selection criterion 'ods_*' does not match any enabled nodes
[0m07:40:08.011995 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:40:08.013522 [debug] [MainThread]: Command end result
[0m07:40:08.045275 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:40:08.046829 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:40:08.049659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:40:08.051022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48333704, "process_in_blocks": "0", "process_kernel_time": 0.203235, "process_mem_max_rss": "114920", "process_out_blocks": "2261", "process_user_time": 1.515756}
[0m07:40:08.051498 [debug] [MainThread]: Command `dbt run` succeeded at 07:40:08.051420 after 0.48 seconds
[0m07:40:08.051868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcae57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc9b7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcc2ee10>]}
[0m07:40:08.052201 [debug] [MainThread]: Flushing usage events
[0m07:40:08.617144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:46:43.161485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c0f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3fd2d50>]}


============================== 07:46:43.166566 | 0055b10e-55bf-4780-b665-67d2f16022e5 ==============================
[0m07:46:43.166566 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:46:43.167242 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'invocation_command': 'dbt ls', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True'}
[0m07:46:43.284302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0055b10e-55bf-4780-b665-67d2f16022e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a4fad0>]}
[0m07:46:43.318506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0055b10e-55bf-4780-b665-67d2f16022e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4985590>]}
[0m07:46:43.319238 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m07:46:43.363939 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:46:43.440210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:43.440705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:43.465335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0055b10e-55bf-4780-b665-67d2f16022e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a4f750>]}
[0m07:46:43.518237 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:46:43.519896 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:46:43.535070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0055b10e-55bf-4780-b665-67d2f16022e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39a2b90>]}
[0m07:46:43.535539 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m07:46:43.535882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0055b10e-55bf-4780-b665-67d2f16022e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c62ed0>]}
[0m07:46:43.536577 [info ] [MainThread]: bank_dwh.ods.ods_dim_account
[0m07:46:43.536870 [info ] [MainThread]: bank_dwh.ods.ods_dim_card
[0m07:46:43.537107 [info ] [MainThread]: bank_dwh.ods.ods_dim_customer
[0m07:46:43.537312 [info ] [MainThread]: bank_dwh.ods.ods_dim_terminal
[0m07:46:43.537542 [info ] [MainThread]: bank_dwh.ods.ods_fact_atm_transaction
[0m07:46:43.537730 [info ] [MainThread]: bank_dwh.raw.raw_account
[0m07:46:43.537935 [info ] [MainThread]: bank_dwh.raw.raw_card
[0m07:46:43.538162 [info ] [MainThread]: bank_dwh.raw.raw_customer
[0m07:46:43.538366 [info ] [MainThread]: bank_dwh.raw.raw_terminal
[0m07:46:43.538604 [info ] [MainThread]: bank_dwh.raw.raw_transaction
[0m07:46:43.538901 [info ] [MainThread]: bank_dwh.stg.stg_account
[0m07:46:43.539194 [info ] [MainThread]: bank_dwh.stg.stg_card
[0m07:46:43.539476 [info ] [MainThread]: bank_dwh.stg.stg_customer
[0m07:46:43.539728 [info ] [MainThread]: bank_dwh.stg.stg_terminal
[0m07:46:43.539932 [info ] [MainThread]: bank_dwh.stg.stg_transaction
[0m07:46:43.540186 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_account
[0m07:46:43.540460 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_card
[0m07:46:43.540758 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_customer
[0m07:46:43.540997 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_terminal
[0m07:46:43.541218 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_transaction
[0m07:46:43.541904 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.41292378, "process_in_blocks": "0", "process_kernel_time": 0.417879, "process_mem_max_rss": "114708", "process_out_blocks": "1155", "process_user_time": 1.537556}
[0m07:46:43.542291 [debug] [MainThread]: Command `dbt ls` succeeded at 07:46:43.542234 after 0.41 seconds
[0m07:46:43.542608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89d2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89e34d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8918550>]}
[0m07:46:43.542883 [debug] [MainThread]: Flushing usage events
[0m07:46:44.103523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:46:45.613163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b5c990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b5cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b5ecd0>]}


============================== 07:46:45.617489 | cf0bdb30-8699-40ff-be51-db2a50434e18 ==============================
[0m07:46:45.617489 [info ] [MainThread]: Running with dbt=1.10.15
[0m07:46:45.618011 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt run --select path:models/raw path:models/ods', 'indirect_selection': 'eager', 'log_path': '/opt/airflow/dbt/logs', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'introspect': 'True', 'use_colors': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False'}
[0m07:46:45.722631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a91cd0>]}
[0m07:46:45.756351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93809610>]}
[0m07:46:45.757044 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m07:46:45.798486 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m07:46:45.861690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:45.862085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:45.883713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a0de10>]}
[0m07:46:45.935568 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:46:45.937044 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:46:45.950199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927db690>]}
[0m07:46:45.950671 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m07:46:45.951037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92992f50>]}
[0m07:46:45.952694 [info ] [MainThread]: 
[0m07:46:45.953016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:46:45.953286 [info ] [MainThread]: 
[0m07:46:45.953652 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:46:45.957629 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m07:46:45.964970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:46:46.075032 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m07:46:46.076455 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.127846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bank_dwh)
[0m07:46:46.131919 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bank_dwh: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list__bank_dwh"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bank_dwh'
      

  ...
[0m07:46:46.141059 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.143478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b3a4d0>]}
[0m07:46:46.147643 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m07:46:46.148081 [info ] [Thread-1 (]: 1 of 10 START sql incremental model `bank_dwh`.`raw_account` ................... [RUN]
[0m07:46:46.148541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__bank_dwh, now model.bank_dwh.raw_account)
[0m07:46:46.148862 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m07:46:46.157078 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m07:46:46.158814 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m07:46:46.196706 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m07:46:46.197782 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.215492 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

            

    
        create table `bank_dwh`.`raw_account__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

          )
        
        ...
[0m07:46:46.221667 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.232856 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.237192 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.239361 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_account__dbt_new_data`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

  
      ...
[0m07:46:46.255717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m07:46:46.256600 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m07:46:46.257936 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

          create table `bank_dwh`.`raw_account__dbt_tmp` 
   as `bank_dwh`.`raw_account__dbt_new_data`
      ...
[0m07:46:46.261508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.263350 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.265120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.266048 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account`
          where (account_id) not in (
            select account_id
            from `bank_dwh`.`raw_account__dbt_new_data`
          )
       
    ...
[0m07:46:46.270980 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.271687 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

     insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account__dbt_new_data`
      
    ...
[0m07:46:46.274774 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.276705 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m07:46:46.277584 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.281436 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m07:46:46.282150 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.282869 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    rename table `bank_dwh`.`raw_account__dbt_tmp` to `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m07:46:46.283941 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.286749 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
EXCHANGE TABLES `bank_dwh`.`raw_account__dbt_backup` AND `bank_dwh`.`raw_account` 
  
  ...
[0m07:46:46.287767 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.300275 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  ...
[0m07:46:46.301286 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.303457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90178dd0>]}
[0m07:46:46.303971 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model `bank_dwh`.`raw_account` .............. [[32mOK[0m in 0.15s]
[0m07:46:46.304491 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m07:46:46.304827 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_card
[0m07:46:46.305376 [info ] [Thread-1 (]: 2 of 10 START sql incremental model `bank_dwh`.`raw_card` ...................... [RUN]
[0m07:46:46.305800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.raw_card)
[0m07:46:46.306170 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_card
[0m07:46:46.309881 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m07:46:46.311137 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_card
[0m07:46:46.314337 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m07:46:46.315142 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.316549 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

            

    
        create table `bank_dwh`.`raw_card__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

          )
        
        ...
[0m07:46:46.321855 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.324507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.326340 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.327310 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_card__dbt_new_data`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

  
      ...
[0m07:46:46.332863 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.333614 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m07:46:46.334420 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

          create table `bank_dwh`.`raw_card__dbt_tmp` 
   as `bank_dwh`.`raw_card__dbt_new_data`
      ...
[0m07:46:46.337790 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.339624 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.341618 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.342722 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card`
          where (card_id) not in (
            select card_id
            from `bank_dwh`.`raw_card__dbt_new_data`
          )
       
    ...
[0m07:46:46.346759 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.347614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

     insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card__dbt_new_data`
      
    ...
[0m07:46:46.351402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.353532 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m07:46:46.354635 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.356747 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m07:46:46.357570 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.358256 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    rename table `bank_dwh`.`raw_card__dbt_tmp` to `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m07:46:46.359066 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.359801 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
EXCHANGE TABLES `bank_dwh`.`raw_card__dbt_backup` AND `bank_dwh`.`raw_card` 
  
  ...
[0m07:46:46.360650 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.362939 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  ...
[0m07:46:46.364191 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.365237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90176c10>]}
[0m07:46:46.365742 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model `bank_dwh`.`raw_card` ................. [[32mOK[0m in 0.06s]
[0m07:46:46.366236 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_card
[0m07:46:46.366589 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_customer
[0m07:46:46.367156 [info ] [Thread-1 (]: 3 of 10 START sql incremental model `bank_dwh`.`raw_customer` .................. [RUN]
[0m07:46:46.367552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.raw_customer)
[0m07:46:46.367861 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_customer
[0m07:46:46.370514 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m07:46:46.371471 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_customer
[0m07:46:46.376287 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m07:46:46.377166 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.378307 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

            

    
        create table `bank_dwh`.`raw_customer__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

          )
        
        ...
[0m07:46:46.382933 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.385587 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.387569 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.388511 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_customer__dbt_new_data`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

  
      ...
[0m07:46:46.393444 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.394144 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m07:46:46.394867 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

          create table `bank_dwh`.`raw_customer__dbt_tmp` 
   as `bank_dwh`.`raw_customer__dbt_new_data`
      ...
[0m07:46:46.398871 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.400461 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.401972 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.402924 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer`
          where (customer_id) not in (
            select customer_id
            from `bank_dwh`.`raw_customer__dbt_new_data`
          )
       
    ...
[0m07:46:46.406174 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.406930 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

     insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer__dbt_new_data`
      
    ...
[0m07:46:46.409246 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.410994 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m07:46:46.411788 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.413511 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m07:46:46.414119 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.414720 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    rename table `bank_dwh`.`raw_customer__dbt_tmp` to `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m07:46:46.415450 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.416187 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
EXCHANGE TABLES `bank_dwh`.`raw_customer__dbt_backup` AND `bank_dwh`.`raw_customer` 
  
  ...
[0m07:46:46.416912 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.418932 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  ...
[0m07:46:46.419688 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.420545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92890990>]}
[0m07:46:46.421003 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model `bank_dwh`.`raw_customer` ............. [[32mOK[0m in 0.05s]
[0m07:46:46.421458 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_customer
[0m07:46:46.421777 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_terminal
[0m07:46:46.422299 [info ] [Thread-1 (]: 4 of 10 START sql incremental model `bank_dwh`.`raw_terminal` .................. [RUN]
[0m07:46:46.422653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.raw_terminal)
[0m07:46:46.422966 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_terminal
[0m07:46:46.425363 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m07:46:46.426187 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_terminal
[0m07:46:46.429440 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m07:46:46.430183 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.431333 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

            

    
        create table `bank_dwh`.`raw_terminal__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

          )
        
        ...
[0m07:46:46.435874 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.439834 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.441527 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.442449 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_terminal__dbt_new_data`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

  
      ...
[0m07:46:46.490273 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:46:46.491162 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m07:46:46.491991 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

          create table `bank_dwh`.`raw_terminal__dbt_tmp` 
   as `bank_dwh`.`raw_terminal__dbt_new_data`
      ...
[0m07:46:46.497539 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.499480 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.501532 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.502670 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal`
          where (terminal_id) not in (
            select terminal_id
            from `bank_dwh`.`raw_terminal__dbt_new_data`
          )
       
    ...
[0m07:46:46.508562 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.509534 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

     insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal__dbt_new_data`
      
    ...
[0m07:46:46.511997 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.514084 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m07:46:46.515343 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.517943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m07:46:46.519329 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.521353 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    rename table `bank_dwh`.`raw_terminal__dbt_tmp` to `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m07:46:46.523300 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.524661 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
EXCHANGE TABLES `bank_dwh`.`raw_terminal__dbt_backup` AND `bank_dwh`.`raw_terminal` 
  
  ...
[0m07:46:46.526314 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.529360 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  ...
[0m07:46:46.530888 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.532109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903abfd0>]}
[0m07:46:46.532637 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model `bank_dwh`.`raw_terminal` ............. [[32mOK[0m in 0.11s]
[0m07:46:46.533344 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_terminal
[0m07:46:46.533808 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_transaction
[0m07:46:46.534414 [info ] [Thread-1 (]: 5 of 10 START sql incremental model `bank_dwh`.`raw_transaction` ............... [RUN]
[0m07:46:46.534848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m07:46:46.535167 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_transaction
[0m07:46:46.537899 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m07:46:46.538941 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_transaction
[0m07:46:46.542398 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m07:46:46.543823 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.545042 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

            

    
        create table `bank_dwh`.`raw_transaction__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

          )
        
        ...
[0m07:46:46.549596 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.552395 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.554518 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.555559 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_transaction__dbt_new_data`
        ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

  
      ...
[0m07:46:46.561308 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.562052 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m07:46:46.562813 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

          create table `bank_dwh`.`raw_transaction__dbt_tmp` 
   as `bank_dwh`.`raw_transaction__dbt_new_data`
      ...
[0m07:46:46.566236 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.567944 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.569595 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.570541 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction`
          where (txn_id) not in (
            select txn_id
            from `bank_dwh`.`raw_transaction__dbt_new_data`
          )
       
    ...
[0m07:46:46.573768 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.574541 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

     insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction__dbt_new_data`
      
    ...
[0m07:46:46.576750 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.579900 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m07:46:46.580752 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.582526 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m07:46:46.583256 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.583911 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    rename table `bank_dwh`.`raw_transaction__dbt_tmp` to `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m07:46:46.584677 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.585330 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
EXCHANGE TABLES `bank_dwh`.`raw_transaction__dbt_backup` AND `bank_dwh`.`raw_transaction` 
  
  ...
[0m07:46:46.586612 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.588769 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  ...
[0m07:46:46.589601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.590478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90199310>]}
[0m07:46:46.590922 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model `bank_dwh`.`raw_transaction` .......... [[32mOK[0m in 0.06s]
[0m07:46:46.591358 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_transaction
[0m07:46:46.591663 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_account
[0m07:46:46.592165 [info ] [Thread-1 (]: 6 of 10 START sql table model `bank_dwh`.`ods_dim_account` ..................... [RUN]
[0m07:46:46.592489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_transaction, now model.bank_dwh.ods_dim_account)
[0m07:46:46.592736 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_account
[0m07:46:46.594639 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_account"
[0m07:46:46.595656 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_account
[0m07:46:46.604275 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

            

    
        create table `bank_dwh`.`ods_dim_account__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
          )
        
        ...
[0m07:46:46.608617 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.610405 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

    select name, type from system.columns where table = 'ods_dim_account__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.612290 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.613554 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_account"
[0m07:46:46.614526 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_account__dbt_backup`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "is_deleted", "loaded_at")

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
  ...
[0m07:46:46.618281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.619013 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_account__dbt_backup` AND `bank_dwh`.`ods_dim_account` 
  
  ...
[0m07:46:46.619911 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.623536 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
drop table if exists `bank_dwh`.`ods_dim_account__dbt_backup` 
  ...
[0m07:46:46.624354 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.625278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90184810>]}
[0m07:46:46.626419 [info ] [Thread-1 (]: 6 of 10 OK created sql table model `bank_dwh`.`ods_dim_account` ................ [[32mOK[0m in 0.03s]
[0m07:46:46.626883 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_account
[0m07:46:46.627239 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_card
[0m07:46:46.627657 [info ] [Thread-1 (]: 7 of 10 START sql table model `bank_dwh`.`ods_dim_card` ........................ [RUN]
[0m07:46:46.628027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_account, now model.bank_dwh.ods_dim_card)
[0m07:46:46.628393 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_card
[0m07:46:46.630397 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_card"
[0m07:46:46.631104 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_card
[0m07:46:46.633362 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

            

    
        create table `bank_dwh`.`ods_dim_card__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
          )
        
        ...
[0m07:46:46.637313 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.640259 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

    select name, type from system.columns where table = 'ods_dim_card__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.641864 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.643078 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_card"
[0m07:46:46.643925 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_card__dbt_backup`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "is_deleted", "loaded_at")

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
  ...
[0m07:46:46.646895 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.647614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_card__dbt_backup` AND `bank_dwh`.`ods_dim_card` 
  
  ...
[0m07:46:46.648457 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.650677 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
drop table if exists `bank_dwh`.`ods_dim_card__dbt_backup` 
  ...
[0m07:46:46.651435 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.652294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901e3110>]}
[0m07:46:46.652721 [info ] [Thread-1 (]: 7 of 10 OK created sql table model `bank_dwh`.`ods_dim_card` ................... [[32mOK[0m in 0.02s]
[0m07:46:46.653170 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_card
[0m07:46:46.653536 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_customer
[0m07:46:46.653923 [info ] [Thread-1 (]: 8 of 10 START sql table model `bank_dwh`.`ods_dim_customer` .................... [RUN]
[0m07:46:46.654329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_card, now model.bank_dwh.ods_dim_customer)
[0m07:46:46.654645 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_customer
[0m07:46:46.656834 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_customer"
[0m07:46:46.657619 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_customer
[0m07:46:46.659821 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

            

    
        create table `bank_dwh`.`ods_dim_customer__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
          )
        
        ...
[0m07:46:46.664078 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.665843 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

    select name, type from system.columns where table = 'ods_dim_customer__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.667438 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.668546 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_customer"
[0m07:46:46.669596 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_customer__dbt_backup`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "is_deleted", "loaded_at")

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
  ...
[0m07:46:46.672714 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.673455 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_customer__dbt_backup` AND `bank_dwh`.`ods_dim_customer` 
  
  ...
[0m07:46:46.674522 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.676794 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
drop table if exists `bank_dwh`.`ods_dim_customer__dbt_backup` 
  ...
[0m07:46:46.677611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.678455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90152a50>]}
[0m07:46:46.678900 [info ] [Thread-1 (]: 8 of 10 OK created sql table model `bank_dwh`.`ods_dim_customer` ............... [[32mOK[0m in 0.02s]
[0m07:46:46.679325 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_customer
[0m07:46:46.679617 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_terminal
[0m07:46:46.679987 [info ] [Thread-1 (]: 9 of 10 START sql table model `bank_dwh`.`ods_dim_terminal` .................... [RUN]
[0m07:46:46.680436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_customer, now model.bank_dwh.ods_dim_terminal)
[0m07:46:46.680769 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_terminal
[0m07:46:46.682719 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_terminal"
[0m07:46:46.683502 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_terminal
[0m07:46:46.685742 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

            

    
        create table `bank_dwh`.`ods_dim_terminal__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
          )
        
        ...
[0m07:46:46.689607 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.691338 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

    select name, type from system.columns where table = 'ods_dim_terminal__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.692943 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.694074 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_terminal"
[0m07:46:46.695051 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_terminal__dbt_backup`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "is_working", "is_deleted", "loaded_at")

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
  ...
[0m07:46:46.699145 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.699878 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_terminal__dbt_backup` AND `bank_dwh`.`ods_dim_terminal` 
  
  ...
[0m07:46:46.700787 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.704427 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
drop table if exists `bank_dwh`.`ods_dim_terminal__dbt_backup` 
  ...
[0m07:46:46.705311 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.706206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90051f10>]}
[0m07:46:46.706781 [info ] [Thread-1 (]: 9 of 10 OK created sql table model `bank_dwh`.`ods_dim_terminal` ............... [[32mOK[0m in 0.03s]
[0m07:46:46.707277 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_terminal
[0m07:46:46.707642 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_fact_atm_transaction
[0m07:46:46.707988 [info ] [Thread-1 (]: 10 of 10 START sql table model `bank_dwh`.`ods_fact_atm_transaction` ........... [RUN]
[0m07:46:46.708421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_terminal, now model.bank_dwh.ods_fact_atm_transaction)
[0m07:46:46.708756 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_fact_atm_transaction
[0m07:46:46.711326 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_fact_atm_transaction"
[0m07:46:46.712159 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_fact_atm_transaction
[0m07:46:46.714276 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

            

    
        create table `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
          )
        
        ...
[0m07:46:46.723204 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.725086 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

    select name, type from system.columns where table = 'ods_fact_atm_transaction__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m07:46:46.726914 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.728526 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_fact_atm_transaction"
[0m07:46:46.729355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        ("txn_id", "txn_ts", "amount", "tx.currency_code", "card_dim.card_id", "card_number", "acc_dim.account_id", "account_number", "cust_dim.customer_id", "customer_city", "term_dim.terminal_id", "terminal_city", "txn_type", "tx.status", "loaded_at")

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
  ...
[0m07:46:46.737572 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:46:46.738366 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
EXCHANGE TABLES `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` AND `bank_dwh`.`ods_fact_atm_transaction` 
  
  ...
[0m07:46:46.739317 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.741651 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
drop table if exists `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` 
  ...
[0m07:46:46.742463 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:46:46.743299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0bdb30-8699-40ff-be51-db2a50434e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90050790>]}
[0m07:46:46.743835 [info ] [Thread-1 (]: 10 of 10 OK created sql table model `bank_dwh`.`ods_fact_atm_transaction` ...... [[32mOK[0m in 0.03s]
[0m07:46:46.744326 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_fact_atm_transaction
[0m07:46:46.745256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:46:46.745553 [debug] [MainThread]: Connection 'model.bank_dwh.ods_fact_atm_transaction' was left open.
[0m07:46:46.745828 [debug] [MainThread]: On model.bank_dwh.ods_fact_atm_transaction: Close
[0m07:46:46.746213 [info ] [MainThread]: 
[0m07:46:46.746481 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m07:46:46.747545 [debug] [MainThread]: Command end result
[0m07:46:46.771869 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m07:46:46.773981 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m07:46:46.779473 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m07:46:46.779847 [info ] [MainThread]: 
[0m07:46:46.780325 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:46:46.780696 [info ] [MainThread]: 
[0m07:46:46.781157 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m07:46:46.782054 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2017895, "process_in_blocks": "1496", "process_kernel_time": 0.215767, "process_mem_max_rss": "145832", "process_out_blocks": "2448", "process_user_time": 1.959891}
[0m07:46:46.782537 [debug] [MainThread]: Command `dbt run` succeeded at 07:46:46.782467 after 1.20 seconds
[0m07:46:46.782888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92b387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9784d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9799b510>]}
[0m07:46:46.783292 [debug] [MainThread]: Flushing usage events
[0m07:46:47.504012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:00:08.313089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f25d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f25c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f238f50>]}


============================== 08:00:08.319272 | d887a335-10ac-4801-8c68-5b6390e5c2f2 ==============================
[0m08:00:08.319272 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:00:08.319887 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ls', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True'}
[0m08:00:08.430619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd887a335-10ac-4801-8c68-5b6390e5c2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1826d0>]}
[0m08:00:08.472649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd887a335-10ac-4801-8c68-5b6390e5c2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff5d750>]}
[0m08:00:08.473592 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m08:00:08.519865 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:00:08.591088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:08.591532 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:08.613780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd887a335-10ac-4801-8c68-5b6390e5c2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2fda10>]}
[0m08:00:08.665956 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:00:08.667508 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:00:08.681516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd887a335-10ac-4801-8c68-5b6390e5c2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef86d50>]}
[0m08:00:08.681975 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m08:00:08.682592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd887a335-10ac-4801-8c68-5b6390e5c2f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b91490>]}
[0m08:00:08.683317 [info ] [MainThread]: bank_dwh.ods.ods_dim_account
[0m08:00:08.683770 [info ] [MainThread]: bank_dwh.ods.ods_dim_card
[0m08:00:08.684135 [info ] [MainThread]: bank_dwh.ods.ods_dim_customer
[0m08:00:08.684468 [info ] [MainThread]: bank_dwh.ods.ods_dim_terminal
[0m08:00:08.684825 [info ] [MainThread]: bank_dwh.ods.ods_fact_atm_transaction
[0m08:00:08.685162 [info ] [MainThread]: bank_dwh.raw.raw_account
[0m08:00:08.685505 [info ] [MainThread]: bank_dwh.raw.raw_card
[0m08:00:08.685830 [info ] [MainThread]: bank_dwh.raw.raw_customer
[0m08:00:08.686201 [info ] [MainThread]: bank_dwh.raw.raw_terminal
[0m08:00:08.686572 [info ] [MainThread]: bank_dwh.raw.raw_transaction
[0m08:00:08.686938 [info ] [MainThread]: bank_dwh.stg.stg_account
[0m08:00:08.687337 [info ] [MainThread]: bank_dwh.stg.stg_card
[0m08:00:08.687730 [info ] [MainThread]: bank_dwh.stg.stg_customer
[0m08:00:08.688164 [info ] [MainThread]: bank_dwh.stg.stg_terminal
[0m08:00:08.688598 [info ] [MainThread]: bank_dwh.stg.stg_transaction
[0m08:00:08.689003 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_account
[0m08:00:08.689405 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_card
[0m08:00:08.689786 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_customer
[0m08:00:08.690108 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_terminal
[0m08:00:08.690486 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_transaction
[0m08:00:08.691408 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4163847, "process_in_blocks": "0", "process_kernel_time": 0.203558, "process_mem_max_rss": "114684", "process_out_blocks": "1155", "process_user_time": 1.543651}
[0m08:00:08.692001 [debug] [MainThread]: Command `dbt ls` succeeded at 08:00:08.691883 after 0.42 seconds
[0m08:00:08.692379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940369d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940473d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fa4550>]}
[0m08:00:08.692800 [debug] [MainThread]: Flushing usage events
[0m08:00:09.298471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:00:10.849343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80103650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8303d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80157c50>]}


============================== 08:00:10.854270 | b8c0b7ec-6c33-4081-b7ab-58db924c589d ==============================
[0m08:00:10.854270 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:00:10.854812 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'partial_parse': 'True', 'invocation_command': 'dbt run --select path:models/raw path:models/ods', 'printer_width': '80', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True'}
[0m08:00:10.957699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8008b590>]}
[0m08:00:10.991670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80eed910>]}
[0m08:00:10.992478 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m08:00:11.035736 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:00:11.097759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:11.098182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:11.119718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800a0f50>]}
[0m08:00:11.170403 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:00:11.171901 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:00:11.184834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80092350>]}
[0m08:00:11.185308 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m08:00:11.185831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8002c690>]}
[0m08:00:11.187585 [info ] [MainThread]: 
[0m08:00:11.188106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:00:11.188497 [info ] [MainThread]: 
[0m08:00:11.189048 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:00:11.193082 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:00:11.200657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:11.300686 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:00:11.302243 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.352478 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bank_dwh)
[0m08:00:11.356466 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bank_dwh: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list__bank_dwh"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bank_dwh'
      

  ...
[0m08:00:11.359912 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.362349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fb42c10>]}
[0m08:00:11.365299 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m08:00:11.365768 [info ] [Thread-1 (]: 1 of 10 START sql incremental model `bank_dwh`.`raw_account` ................... [RUN]
[0m08:00:11.366208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__bank_dwh, now model.bank_dwh.raw_account)
[0m08:00:11.366537 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m08:00:11.374999 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m08:00:11.376666 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m08:00:11.415965 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m08:00:11.417404 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.438374 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

            

    
        create table `bank_dwh`.`raw_account__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

          )
        
        ...
[0m08:00:11.445014 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.456192 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.458515 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.460660 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_account__dbt_new_data`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

  
      ...
[0m08:00:11.466640 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.467525 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m08:00:11.468566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

          create table `bank_dwh`.`raw_account__dbt_tmp` 
   as `bank_dwh`.`raw_account__dbt_new_data`
      ...
[0m08:00:11.472711 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.474540 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.476297 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.477347 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account`
          where (account_id) not in (
            select account_id
            from `bank_dwh`.`raw_account__dbt_new_data`
          )
       
    ...
[0m08:00:11.482478 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.483183 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

     insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account__dbt_new_data`
      
    ...
[0m08:00:11.484909 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.486682 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m08:00:11.487497 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.491479 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m08:00:11.492162 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.492771 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    rename table `bank_dwh`.`raw_account__dbt_tmp` to `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m08:00:11.493748 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.496282 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
EXCHANGE TABLES `bank_dwh`.`raw_account__dbt_backup` AND `bank_dwh`.`raw_account` 
  
  ...
[0m08:00:11.497078 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.509724 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  ...
[0m08:00:11.510905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.513113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d779710>]}
[0m08:00:11.513662 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model `bank_dwh`.`raw_account` .............. [[32mOK[0m in 0.15s]
[0m08:00:11.514115 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m08:00:11.514499 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_card
[0m08:00:11.515003 [info ] [Thread-1 (]: 2 of 10 START sql incremental model `bank_dwh`.`raw_card` ...................... [RUN]
[0m08:00:11.515506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.raw_card)
[0m08:00:11.515803 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_card
[0m08:00:11.518056 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m08:00:11.519088 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_card
[0m08:00:11.522140 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m08:00:11.522913 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.524220 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

            

    
        create table `bank_dwh`.`raw_card__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

          )
        
        ...
[0m08:00:11.529284 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.531725 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.533733 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.534786 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_card__dbt_new_data`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

  
      ...
[0m08:00:11.540787 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.541668 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m08:00:11.542452 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

          create table `bank_dwh`.`raw_card__dbt_tmp` 
   as `bank_dwh`.`raw_card__dbt_new_data`
      ...
[0m08:00:11.546199 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.547959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.549581 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.550545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card`
          where (card_id) not in (
            select card_id
            from `bank_dwh`.`raw_card__dbt_new_data`
          )
       
    ...
[0m08:00:11.554803 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.555614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

     insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card__dbt_new_data`
      
    ...
[0m08:00:11.557541 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.559545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m08:00:11.560394 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.562256 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m08:00:11.562929 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.563566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    rename table `bank_dwh`.`raw_card__dbt_tmp` to `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m08:00:11.564477 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.565124 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
EXCHANGE TABLES `bank_dwh`.`raw_card__dbt_backup` AND `bank_dwh`.`raw_card` 
  
  ...
[0m08:00:11.566572 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.569422 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  ...
[0m08:00:11.570729 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.571999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d6fd10>]}
[0m08:00:11.572617 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model `bank_dwh`.`raw_card` ................. [[32mOK[0m in 0.06s]
[0m08:00:11.573464 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_card
[0m08:00:11.573795 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_customer
[0m08:00:11.574305 [info ] [Thread-1 (]: 3 of 10 START sql incremental model `bank_dwh`.`raw_customer` .................. [RUN]
[0m08:00:11.574827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.raw_customer)
[0m08:00:11.575097 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_customer
[0m08:00:11.578085 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m08:00:11.579006 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_customer
[0m08:00:11.584506 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m08:00:11.585428 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.586669 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

            

    
        create table `bank_dwh`.`raw_customer__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

          )
        
        ...
[0m08:00:11.594970 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.597744 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.600053 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.601131 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_customer__dbt_new_data`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

  
      ...
[0m08:00:11.606860 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.607740 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m08:00:11.608531 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

          create table `bank_dwh`.`raw_customer__dbt_tmp` 
   as `bank_dwh`.`raw_customer__dbt_new_data`
      ...
[0m08:00:11.612383 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.614292 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.616235 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.617199 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer`
          where (customer_id) not in (
            select customer_id
            from `bank_dwh`.`raw_customer__dbt_new_data`
          )
       
    ...
[0m08:00:11.621873 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.622704 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

     insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer__dbt_new_data`
      
    ...
[0m08:00:11.624484 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.626409 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m08:00:11.627386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.629109 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m08:00:11.629701 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.630405 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    rename table `bank_dwh`.`raw_customer__dbt_tmp` to `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m08:00:11.631501 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.632155 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
EXCHANGE TABLES `bank_dwh`.`raw_customer__dbt_backup` AND `bank_dwh`.`raw_customer` 
  
  ...
[0m08:00:11.633028 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.635067 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  ...
[0m08:00:11.636043 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.636960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d86a750>]}
[0m08:00:11.637522 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model `bank_dwh`.`raw_customer` ............. [[32mOK[0m in 0.06s]
[0m08:00:11.638513 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_customer
[0m08:00:11.638820 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_terminal
[0m08:00:11.639345 [info ] [Thread-1 (]: 4 of 10 START sql incremental model `bank_dwh`.`raw_terminal` .................. [RUN]
[0m08:00:11.639851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.raw_terminal)
[0m08:00:11.640109 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_terminal
[0m08:00:11.642335 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m08:00:11.643219 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_terminal
[0m08:00:11.646520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m08:00:11.647285 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.648553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

            

    
        create table `bank_dwh`.`raw_terminal__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

          )
        
        ...
[0m08:00:11.653753 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.657929 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.659797 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.660831 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_terminal__dbt_new_data`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

  
      ...
[0m08:00:11.665229 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.666011 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m08:00:11.666887 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

          create table `bank_dwh`.`raw_terminal__dbt_tmp` 
   as `bank_dwh`.`raw_terminal__dbt_new_data`
      ...
[0m08:00:11.670766 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.672661 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.674424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.675381 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal`
          where (terminal_id) not in (
            select terminal_id
            from `bank_dwh`.`raw_terminal__dbt_new_data`
          )
       
    ...
[0m08:00:11.679761 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.680591 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

     insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal__dbt_new_data`
      
    ...
[0m08:00:11.682088 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.683920 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m08:00:11.684751 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.686623 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m08:00:11.687275 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.687943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    rename table `bank_dwh`.`raw_terminal__dbt_tmp` to `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m08:00:11.688644 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.689274 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
EXCHANGE TABLES `bank_dwh`.`raw_terminal__dbt_backup` AND `bank_dwh`.`raw_terminal` 
  
  ...
[0m08:00:11.690348 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.692437 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  ...
[0m08:00:11.693230 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.694115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7d2d10>]}
[0m08:00:11.694555 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model `bank_dwh`.`raw_terminal` ............. [[32mOK[0m in 0.05s]
[0m08:00:11.695210 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_terminal
[0m08:00:11.695531 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_transaction
[0m08:00:11.695999 [info ] [Thread-1 (]: 5 of 10 START sql incremental model `bank_dwh`.`raw_transaction` ............... [RUN]
[0m08:00:11.696611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m08:00:11.696902 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_transaction
[0m08:00:11.699210 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m08:00:11.699869 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_transaction
[0m08:00:11.702964 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m08:00:11.704392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.705614 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

            

    
        create table `bank_dwh`.`raw_transaction__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

          )
        
        ...
[0m08:00:11.710776 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.713273 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.715048 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.716019 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_transaction__dbt_new_data`
        ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

  
      ...
[0m08:00:11.719624 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.720337 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m08:00:11.721228 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

          create table `bank_dwh`.`raw_transaction__dbt_tmp` 
   as `bank_dwh`.`raw_transaction__dbt_new_data`
      ...
[0m08:00:11.724392 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.726085 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.727661 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.728596 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction`
          where (txn_id) not in (
            select txn_id
            from `bank_dwh`.`raw_transaction__dbt_new_data`
          )
       
    ...
[0m08:00:11.732443 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.733104 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

     insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction__dbt_new_data`
      
    ...
[0m08:00:11.734900 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.738125 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m08:00:11.739114 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.740950 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m08:00:11.741610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.742250 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    rename table `bank_dwh`.`raw_transaction__dbt_tmp` to `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m08:00:11.743362 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.744119 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
EXCHANGE TABLES `bank_dwh`.`raw_transaction__dbt_backup` AND `bank_dwh`.`raw_transaction` 
  
  ...
[0m08:00:11.745244 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.747317 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  ...
[0m08:00:11.748098 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.748959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7b44d0>]}
[0m08:00:11.749415 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model `bank_dwh`.`raw_transaction` .......... [[32mOK[0m in 0.05s]
[0m08:00:11.750140 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_transaction
[0m08:00:11.750526 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_account
[0m08:00:11.751004 [info ] [Thread-1 (]: 6 of 10 START sql table model `bank_dwh`.`ods_dim_account` ..................... [RUN]
[0m08:00:11.751566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_transaction, now model.bank_dwh.ods_dim_account)
[0m08:00:11.751846 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_account
[0m08:00:11.753706 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_account"
[0m08:00:11.754430 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_account
[0m08:00:11.762963 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

            

    
        create table `bank_dwh`.`ods_dim_account__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
          )
        
        ...
[0m08:00:11.767947 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.769845 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

    select name, type from system.columns where table = 'ods_dim_account__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.771805 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.773075 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_account"
[0m08:00:11.773917 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_account__dbt_backup`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "is_deleted", "loaded_at")

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
  ...
[0m08:00:11.776952 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.777661 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_account__dbt_backup` AND `bank_dwh`.`ods_dim_account` 
  
  ...
[0m08:00:11.778509 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.781908 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
drop table if exists `bank_dwh`.`ods_dim_account__dbt_backup` 
  ...
[0m08:00:11.782736 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.783585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d83ff90>]}
[0m08:00:11.784098 [info ] [Thread-1 (]: 6 of 10 OK created sql table model `bank_dwh`.`ods_dim_account` ................ [[32mOK[0m in 0.03s]
[0m08:00:11.784815 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_account
[0m08:00:11.785128 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_card
[0m08:00:11.785613 [info ] [Thread-1 (]: 7 of 10 START sql table model `bank_dwh`.`ods_dim_card` ........................ [RUN]
[0m08:00:11.786348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_account, now model.bank_dwh.ods_dim_card)
[0m08:00:11.786714 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_card
[0m08:00:11.788538 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_card"
[0m08:00:11.789315 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_card
[0m08:00:11.791529 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

            

    
        create table `bank_dwh`.`ods_dim_card__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
          )
        
        ...
[0m08:00:11.795655 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.798709 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

    select name, type from system.columns where table = 'ods_dim_card__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.800454 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.801833 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_card"
[0m08:00:11.802630 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_card__dbt_backup`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "is_deleted", "loaded_at")

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
  ...
[0m08:00:11.805882 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.806696 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_card__dbt_backup` AND `bank_dwh`.`ods_dim_card` 
  
  ...
[0m08:00:11.807705 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.809991 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
drop table if exists `bank_dwh`.`ods_dim_card__dbt_backup` 
  ...
[0m08:00:11.810846 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.811725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d705e10>]}
[0m08:00:11.812179 [info ] [Thread-1 (]: 7 of 10 OK created sql table model `bank_dwh`.`ods_dim_card` ................... [[32mOK[0m in 0.03s]
[0m08:00:11.812817 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_card
[0m08:00:11.813117 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_customer
[0m08:00:11.813510 [info ] [Thread-1 (]: 8 of 10 START sql table model `bank_dwh`.`ods_dim_customer` .................... [RUN]
[0m08:00:11.813974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_card, now model.bank_dwh.ods_dim_customer)
[0m08:00:11.816276 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_customer
[0m08:00:11.818367 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_customer"
[0m08:00:11.819257 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_customer
[0m08:00:11.821566 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

            

    
        create table `bank_dwh`.`ods_dim_customer__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
          )
        
        ...
[0m08:00:11.826162 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.828013 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

    select name, type from system.columns where table = 'ods_dim_customer__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.829675 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.830800 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_customer"
[0m08:00:11.831600 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_customer__dbt_backup`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "is_deleted", "loaded_at")

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
  ...
[0m08:00:11.837070 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.838431 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_customer__dbt_backup` AND `bank_dwh`.`ods_dim_customer` 
  
  ...
[0m08:00:11.840695 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.843924 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
drop table if exists `bank_dwh`.`ods_dim_customer__dbt_backup` 
  ...
[0m08:00:11.844840 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.845817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d755710>]}
[0m08:00:11.846283 [info ] [Thread-1 (]: 8 of 10 OK created sql table model `bank_dwh`.`ods_dim_customer` ............... [[32mOK[0m in 0.03s]
[0m08:00:11.846998 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_customer
[0m08:00:11.847294 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_terminal
[0m08:00:11.847704 [info ] [Thread-1 (]: 9 of 10 START sql table model `bank_dwh`.`ods_dim_terminal` .................... [RUN]
[0m08:00:11.848182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_customer, now model.bank_dwh.ods_dim_terminal)
[0m08:00:11.848586 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_terminal
[0m08:00:11.850734 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_terminal"
[0m08:00:11.851889 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_terminal
[0m08:00:11.854596 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

            

    
        create table `bank_dwh`.`ods_dim_terminal__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
          )
        
        ...
[0m08:00:11.859468 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.861258 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

    select name, type from system.columns where table = 'ods_dim_terminal__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.863281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.864558 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_terminal"
[0m08:00:11.865197 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_terminal__dbt_backup`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "is_working", "is_deleted", "loaded_at")

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
  ...
[0m08:00:11.868302 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.869118 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_terminal__dbt_backup` AND `bank_dwh`.`ods_dim_terminal` 
  
  ...
[0m08:00:11.870542 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.874277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
drop table if exists `bank_dwh`.`ods_dim_terminal__dbt_backup` 
  ...
[0m08:00:11.875493 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.876411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cd54910>]}
[0m08:00:11.876852 [info ] [Thread-1 (]: 9 of 10 OK created sql table model `bank_dwh`.`ods_dim_terminal` ............... [[32mOK[0m in 0.03s]
[0m08:00:11.877565 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_terminal
[0m08:00:11.877857 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_fact_atm_transaction
[0m08:00:11.878283 [info ] [Thread-1 (]: 10 of 10 START sql table model `bank_dwh`.`ods_fact_atm_transaction` ........... [RUN]
[0m08:00:11.878778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_terminal, now model.bank_dwh.ods_fact_atm_transaction)
[0m08:00:11.879067 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_fact_atm_transaction
[0m08:00:11.881625 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_fact_atm_transaction"
[0m08:00:11.882345 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_fact_atm_transaction
[0m08:00:11.884437 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

            

    
        create table `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
          )
        
        ...
[0m08:00:11.891785 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.895198 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

    select name, type from system.columns where table = 'ods_fact_atm_transaction__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:00:11.900273 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.902722 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_fact_atm_transaction"
[0m08:00:11.904259 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        ("txn_id", "txn_ts", "amount", "tx.currency_code", "card_dim.card_id", "card_number", "acc_dim.account_id", "account_number", "cust_dim.customer_id", "customer_city", "term_dim.terminal_id", "terminal_city", "txn_type", "tx.status", "loaded_at")

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
  ...
[0m08:00:11.914904 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:11.916007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
EXCHANGE TABLES `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` AND `bank_dwh`.`ods_fact_atm_transaction` 
  
  ...
[0m08:00:11.917625 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.921267 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
drop table if exists `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` 
  ...
[0m08:00:11.922342 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:11.923412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8c0b7ec-6c33-4081-b7ab-58db924c589d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d7e05d0>]}
[0m08:00:11.923903 [info ] [Thread-1 (]: 10 of 10 OK created sql table model `bank_dwh`.`ods_fact_atm_transaction` ...... [[32mOK[0m in 0.04s]
[0m08:00:11.924680 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_fact_atm_transaction
[0m08:00:11.925864 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:11.926197 [debug] [MainThread]: Connection 'model.bank_dwh.ods_fact_atm_transaction' was left open.
[0m08:00:11.926529 [debug] [MainThread]: On model.bank_dwh.ods_fact_atm_transaction: Close
[0m08:00:11.926979 [info ] [MainThread]: 
[0m08:00:11.927352 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m08:00:11.928564 [debug] [MainThread]: Command end result
[0m08:00:11.952350 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:00:11.953953 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:00:11.958669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:00:11.958950 [info ] [MainThread]: 
[0m08:00:11.959494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:11.959879 [info ] [MainThread]: 
[0m08:00:11.960246 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:00:11.961142 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1480472, "process_in_blocks": "0", "process_kernel_time": 0.178046, "process_mem_max_rss": "145880", "process_out_blocks": "2448", "process_user_time": 2.046528}
[0m08:00:11.961547 [debug] [MainThread]: Command `dbt run` succeeded at 08:00:11.961488 after 1.15 seconds
[0m08:00:11.961845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8521a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84fee910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8507f390>]}
[0m08:00:11.962127 [debug] [MainThread]: Flushing usage events
[0m08:00:12.711664 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:20:08.854635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa354d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf61850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa354a10>]}


============================== 08:20:08.862845 | 7c00ae1a-3dd0-40b3-8dc0-c01deb761c21 ==============================
[0m08:20:08.862845 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:20:08.863976 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'target_path': 'None', 'invocation_command': 'dbt ls', 'partial_parse': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'empty': 'None', 'static_parser': 'True'}
[0m08:20:09.000415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c00ae1a-3dd0-40b3-8dc0-c01deb761c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa147850>]}
[0m08:20:09.042255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c00ae1a-3dd0-40b3-8dc0-c01deb761c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab8ea2d0>]}
[0m08:20:09.043064 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m08:20:09.094222 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:20:09.178366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:09.178868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:09.201117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c00ae1a-3dd0-40b3-8dc0-c01deb761c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ff7c10>]}
[0m08:20:09.257251 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:20:09.260011 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:20:09.278577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c00ae1a-3dd0-40b3-8dc0-c01deb761c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9dbc150>]}
[0m08:20:09.279106 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m08:20:09.279476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c00ae1a-3dd0-40b3-8dc0-c01deb761c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9f960d0>]}
[0m08:20:09.280237 [info ] [MainThread]: bank_dwh.ods.ods_dim_account
[0m08:20:09.280662 [info ] [MainThread]: bank_dwh.ods.ods_dim_card
[0m08:20:09.281077 [info ] [MainThread]: bank_dwh.ods.ods_dim_customer
[0m08:20:09.281412 [info ] [MainThread]: bank_dwh.ods.ods_dim_terminal
[0m08:20:09.281740 [info ] [MainThread]: bank_dwh.ods.ods_fact_atm_transaction
[0m08:20:09.282165 [info ] [MainThread]: bank_dwh.raw.raw_account
[0m08:20:09.282513 [info ] [MainThread]: bank_dwh.raw.raw_card
[0m08:20:09.282847 [info ] [MainThread]: bank_dwh.raw.raw_customer
[0m08:20:09.283221 [info ] [MainThread]: bank_dwh.raw.raw_terminal
[0m08:20:09.283714 [info ] [MainThread]: bank_dwh.raw.raw_transaction
[0m08:20:09.284084 [info ] [MainThread]: bank_dwh.stg.stg_account
[0m08:20:09.284432 [info ] [MainThread]: bank_dwh.stg.stg_card
[0m08:20:09.284826 [info ] [MainThread]: bank_dwh.stg.stg_customer
[0m08:20:09.285120 [info ] [MainThread]: bank_dwh.stg.stg_terminal
[0m08:20:09.285431 [info ] [MainThread]: bank_dwh.stg.stg_transaction
[0m08:20:09.285795 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_account
[0m08:20:09.286290 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_card
[0m08:20:09.286693 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_customer
[0m08:20:09.287013 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_terminal
[0m08:20:09.287391 [info ] [MainThread]: source:bank_dwh.bank_dwh.stg_transaction
[0m08:20:09.288252 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.46739122, "process_in_blocks": "0", "process_kernel_time": 0.571931, "process_mem_max_rss": "114736", "process_out_blocks": "1155", "process_user_time": 1.745842}
[0m08:20:09.288941 [debug] [MainThread]: Command `dbt ls` succeeded at 08:20:09.288869 after 0.47 seconds
[0m08:20:09.289313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf0e5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa522b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf22f350>]}
[0m08:20:09.289778 [debug] [MainThread]: Flushing usage events
[0m08:20:09.921677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:20:11.676914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c24110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c73fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83c25250>]}


============================== 08:20:11.681697 | a530fb06-ba26-4d62-b7a5-e5609254106a ==============================
[0m08:20:11.681697 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:20:11.683269 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'empty': 'False', 'static_parser': 'True', 'warn_error': 'None', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/logs', 'quiet': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run --select path:models/raw path:models/ods', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80'}
[0m08:20:11.793853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ba7dd0>]}
[0m08:20:11.829357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ab7cd0>]}
[0m08:20:11.830119 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m08:20:11.880752 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:20:11.960721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:11.961199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:11.983120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837408d0>]}
[0m08:20:12.037709 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:20:12.039371 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:20:12.053320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a72650>]}
[0m08:20:12.053833 [info ] [MainThread]: Found 15 models, 5 sources, 486 macros
[0m08:20:12.054356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85ac74d0>]}
[0m08:20:12.056108 [info ] [MainThread]: 
[0m08:20:12.056570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:12.057022 [info ] [MainThread]: 
[0m08:20:12.057583 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:20:12.061773 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:20:12.073071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:12.189894 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:20:12.191872 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.248500 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__bank_dwh)
[0m08:20:12.252906 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__bank_dwh: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "connection_name": "list__bank_dwh"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'bank_dwh'
      

  ...
[0m08:20:12.257916 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.260366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836cbcd0>]}
[0m08:20:12.263385 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_account
[0m08:20:12.263964 [info ] [Thread-1 (]: 1 of 10 START sql incremental model `bank_dwh`.`raw_account` ................... [RUN]
[0m08:20:12.264620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__bank_dwh, now model.bank_dwh.raw_account)
[0m08:20:12.264981 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_account
[0m08:20:12.273576 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_account"
[0m08:20:12.275551 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_account
[0m08:20:12.314945 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m08:20:12.316088 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.336161 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

            

    
        create table `bank_dwh`.`raw_account__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

          )
        
        ...
[0m08:20:12.343169 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.354812 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.357526 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.359764 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_account__dbt_new_data`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        account_id,
        account_number,
        customer_id,
        currency_code,
        opened_at,
        closed_at,
        status,
        daily_transfer_limit,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_account`
)

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_account`)

  
      ...
[0m08:20:12.366513 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.367505 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_account"
[0m08:20:12.368545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

          create table `bank_dwh`.`raw_account__dbt_tmp` 
   as `bank_dwh`.`raw_account__dbt_new_data`
      ...
[0m08:20:12.372539 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.374414 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    select name, type from system.columns where table = 'raw_account'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.376400 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.377535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

        insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account`
          where (account_id) not in (
            select account_id
            from `bank_dwh`.`raw_account__dbt_new_data`
          )
       
    ...
[0m08:20:12.382167 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.382985 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

     insert into `bank_dwh`.`raw_account__dbt_tmp` ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_account__dbt_new_data`
      
    ...
[0m08:20:12.385123 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.387272 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_new_data` 
  ...
[0m08:20:12.388325 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.392493 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m08:20:12.393263 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.393959 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */

    rename table `bank_dwh`.`raw_account__dbt_tmp` to `bank_dwh`.`raw_account__dbt_backup` 
  
  ...
[0m08:20:12.394882 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.397641 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
EXCHANGE TABLES `bank_dwh`.`raw_account__dbt_backup` AND `bank_dwh`.`raw_account` 
  
  ...
[0m08:20:12.398674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.413001 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_account"} */
drop table if exists `bank_dwh`.`raw_account__dbt_backup` 
  ...
[0m08:20:12.414072 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.416112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a70910>]}
[0m08:20:12.416718 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model `bank_dwh`.`raw_account` .............. [[32mOK[0m in 0.15s]
[0m08:20:12.417247 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_account
[0m08:20:12.417628 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_card
[0m08:20:12.418173 [info ] [Thread-1 (]: 2 of 10 START sql incremental model `bank_dwh`.`raw_card` ...................... [RUN]
[0m08:20:12.418630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_account, now model.bank_dwh.raw_card)
[0m08:20:12.418959 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_card
[0m08:20:12.421519 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_card"
[0m08:20:12.422846 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_card
[0m08:20:12.426098 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m08:20:12.427044 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.428462 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

            

    
        create table `bank_dwh`.`raw_card__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

          )
        
        ...
[0m08:20:12.434928 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.437573 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.439757 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.441188 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_card__dbt_new_data`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        card_id,
        card_number,
        account_id,
        status,
        opened_at,
        closed_at,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_card`
)

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_card`)

  
      ...
[0m08:20:12.446656 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.447373 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_card"
[0m08:20:12.448519 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

          create table `bank_dwh`.`raw_card__dbt_tmp` 
   as `bank_dwh`.`raw_card__dbt_new_data`
      ...
[0m08:20:12.452984 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.454874 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    select name, type from system.columns where table = 'raw_card'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.456686 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.457634 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

        insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card`
          where (card_id) not in (
            select card_id
            from `bank_dwh`.`raw_card__dbt_new_data`
          )
       
    ...
[0m08:20:12.461559 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.462363 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

     insert into `bank_dwh`.`raw_card__dbt_tmp` ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_card__dbt_new_data`
      
    ...
[0m08:20:12.464659 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.466671 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_new_data` 
  ...
[0m08:20:12.467591 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.469422 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m08:20:12.470138 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.470869 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */

    rename table `bank_dwh`.`raw_card__dbt_tmp` to `bank_dwh`.`raw_card__dbt_backup` 
  
  ...
[0m08:20:12.471654 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.472341 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
EXCHANGE TABLES `bank_dwh`.`raw_card__dbt_backup` AND `bank_dwh`.`raw_card` 
  
  ...
[0m08:20:12.473310 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.475600 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_card"} */
drop table if exists `bank_dwh`.`raw_card__dbt_backup` 
  ...
[0m08:20:12.476497 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.477411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81263f90>]}
[0m08:20:12.477932 [info ] [Thread-1 (]: 2 of 10 OK created sql incremental model `bank_dwh`.`raw_card` ................. [[32mOK[0m in 0.06s]
[0m08:20:12.478423 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_card
[0m08:20:12.478800 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_customer
[0m08:20:12.479256 [info ] [Thread-1 (]: 3 of 10 START sql incremental model `bank_dwh`.`raw_customer` .................. [RUN]
[0m08:20:12.479760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_card, now model.bank_dwh.raw_customer)
[0m08:20:12.480091 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_customer
[0m08:20:12.482423 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_customer"
[0m08:20:12.483353 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_customer
[0m08:20:12.488279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m08:20:12.489197 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.490430 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

            

    
        create table `bank_dwh`.`raw_customer__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

          )
        
        ...
[0m08:20:12.495566 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.498364 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.500424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.501428 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_customer__dbt_new_data`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        customer_id,
        customer_uuid,
        full_name,
        birth_date,
        email,
        phone,
        city,
        created_at,
        updated_at,
        is_deleted
    FROM `bank_dwh`.`stg_customer`
)

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    created_at,
    updated_at,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_customer`)

  
      ...
[0m08:20:12.505911 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.506679 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_customer"
[0m08:20:12.507624 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

          create table `bank_dwh`.`raw_customer__dbt_tmp` 
   as `bank_dwh`.`raw_customer__dbt_new_data`
      ...
[0m08:20:12.510668 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.512336 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    select name, type from system.columns where table = 'raw_customer'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.513898 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.514862 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

        insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer`
          where (customer_id) not in (
            select customer_id
            from `bank_dwh`.`raw_customer__dbt_new_data`
          )
       
    ...
[0m08:20:12.518768 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.519772 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

     insert into `bank_dwh`.`raw_customer__dbt_tmp` ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at")
        select "customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "created_at", "updated_at", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_customer__dbt_new_data`
      
    ...
[0m08:20:12.521833 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.523726 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_new_data` 
  ...
[0m08:20:12.524625 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.526355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m08:20:12.527231 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.527927 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */

    rename table `bank_dwh`.`raw_customer__dbt_tmp` to `bank_dwh`.`raw_customer__dbt_backup` 
  
  ...
[0m08:20:12.528883 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.529741 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
EXCHANGE TABLES `bank_dwh`.`raw_customer__dbt_backup` AND `bank_dwh`.`raw_customer` 
  
  ...
[0m08:20:12.530713 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.532943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_customer"} */
drop table if exists `bank_dwh`.`raw_customer__dbt_backup` 
  ...
[0m08:20:12.533794 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.534716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81279f10>]}
[0m08:20:12.535224 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model `bank_dwh`.`raw_customer` ............. [[32mOK[0m in 0.05s]
[0m08:20:12.535726 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_customer
[0m08:20:12.536085 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_terminal
[0m08:20:12.536601 [info ] [Thread-1 (]: 4 of 10 START sql incremental model `bank_dwh`.`raw_terminal` .................. [RUN]
[0m08:20:12.537051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_customer, now model.bank_dwh.raw_terminal)
[0m08:20:12.537383 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_terminal
[0m08:20:12.539721 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_terminal"
[0m08:20:12.540650 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_terminal
[0m08:20:12.543903 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m08:20:12.544666 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.545884 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

            

    
        create table `bank_dwh`.`raw_terminal__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

          )
        
        ...
[0m08:20:12.550884 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.555483 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.557418 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.558400 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_terminal__dbt_new_data`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")

WITH src AS (
    SELECT
        terminal_id,
        terminal_code,
        city,
        country,
        latitude,
        longitude,
        created_at,
        updated_at,
        is_working,
        is_deleted
    FROM `bank_dwh`.`stg_terminal`
)

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    created_at,
    updated_at,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM src


WHERE updated_at > (SELECT max(updated_at) FROM `bank_dwh`.`raw_terminal`)

  
      ...
[0m08:20:12.569432 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.570621 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_terminal"
[0m08:20:12.571855 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

          create table `bank_dwh`.`raw_terminal__dbt_tmp` 
   as `bank_dwh`.`raw_terminal__dbt_new_data`
      ...
[0m08:20:12.575606 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.577481 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    select name, type from system.columns where table = 'raw_terminal'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.579259 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.580209 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

        insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal`
          where (terminal_id) not in (
            select terminal_id
            from `bank_dwh`.`raw_terminal__dbt_new_data`
          )
       
    ...
[0m08:20:12.584367 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.585475 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

     insert into `bank_dwh`.`raw_terminal__dbt_tmp` ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at")
        select "terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "created_at", "updated_at", "is_working", "is_deleted", "loaded_at"
        from `bank_dwh`.`raw_terminal__dbt_new_data`
      
    ...
[0m08:20:12.587319 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.589279 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_new_data` 
  ...
[0m08:20:12.590211 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.592063 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m08:20:12.592749 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.593406 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */

    rename table `bank_dwh`.`raw_terminal__dbt_tmp` to `bank_dwh`.`raw_terminal__dbt_backup` 
  
  ...
[0m08:20:12.594378 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.595207 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
EXCHANGE TABLES `bank_dwh`.`raw_terminal__dbt_backup` AND `bank_dwh`.`raw_terminal` 
  
  ...
[0m08:20:12.596403 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.598713 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_terminal"} */
drop table if exists `bank_dwh`.`raw_terminal__dbt_backup` 
  ...
[0m08:20:12.599610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.600557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81363750>]}
[0m08:20:12.601070 [info ] [Thread-1 (]: 4 of 10 OK created sql incremental model `bank_dwh`.`raw_terminal` ............. [[32mOK[0m in 0.06s]
[0m08:20:12.601581 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_terminal
[0m08:20:12.601939 [debug] [Thread-1 (]: Began running node model.bank_dwh.raw_transaction
[0m08:20:12.602396 [info ] [Thread-1 (]: 5 of 10 START sql incremental model `bank_dwh`.`raw_transaction` ............... [RUN]
[0m08:20:12.602862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_terminal, now model.bank_dwh.raw_transaction)
[0m08:20:12.603188 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.raw_transaction
[0m08:20:12.605624 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.raw_transaction"
[0m08:20:12.606606 [debug] [Thread-1 (]: Began executing node model.bank_dwh.raw_transaction
[0m08:20:12.609777 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m08:20:12.611265 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.612556 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

            

    
        create table `bank_dwh`.`raw_transaction__dbt_new_data`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

          )
        
        ...
[0m08:20:12.617942 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.620906 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction__dbt_new_data'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.623217 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.624520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        
  
    
    
    
        
         


        insert into `bank_dwh`.`raw_transaction__dbt_new_data`
        ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")

WITH src AS (
    SELECT
        txn_id,
        card_id,
        terminal_id,
        txn_ts,
        amount,
        currency_code,
        txn_type,
        status
    FROM `bank_dwh`.`stg_transaction`
)

SELECT
    txn_id,
    card_id,
    terminal_id,
    txn_ts,
    amount,
    currency_code,
    txn_type,
    status,
    now() AS loaded_at
FROM src


WHERE txn_id > (SELECT max(txn_id) FROM `bank_dwh`.`raw_transaction`)

  
      ...
[0m08:20:12.628456 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.629385 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.raw_transaction"
[0m08:20:12.630636 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

          create table `bank_dwh`.`raw_transaction__dbt_tmp` 
   as `bank_dwh`.`raw_transaction__dbt_new_data`
      ...
[0m08:20:12.634959 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.636770 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    select name, type from system.columns where table = 'raw_transaction'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.638566 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.639535 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

        insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction`
          where (txn_id) not in (
            select txn_id
            from `bank_dwh`.`raw_transaction__dbt_new_data`
          )
       
    ...
[0m08:20:12.643130 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.643830 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

     insert into `bank_dwh`.`raw_transaction__dbt_tmp` ("txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at")
        select "txn_id", "card_id", "terminal_id", "txn_ts", "amount", "currency_code", "txn_type", "status", "loaded_at"
        from `bank_dwh`.`raw_transaction__dbt_new_data`
      
    ...
[0m08:20:12.645240 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.648500 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_new_data` 
  ...
[0m08:20:12.649480 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.651612 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m08:20:12.652854 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.653674 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */

    rename table `bank_dwh`.`raw_transaction__dbt_tmp` to `bank_dwh`.`raw_transaction__dbt_backup` 
  
  ...
[0m08:20:12.654642 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.655360 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
EXCHANGE TABLES `bank_dwh`.`raw_transaction__dbt_backup` AND `bank_dwh`.`raw_transaction` 
  
  ...
[0m08:20:12.656222 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.658284 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.raw_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.raw_transaction"} */
drop table if exists `bank_dwh`.`raw_transaction__dbt_backup` 
  ...
[0m08:20:12.659176 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.660204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812a0e90>]}
[0m08:20:12.660758 [info ] [Thread-1 (]: 5 of 10 OK created sql incremental model `bank_dwh`.`raw_transaction` .......... [[32mOK[0m in 0.06s]
[0m08:20:12.661241 [debug] [Thread-1 (]: Finished running node model.bank_dwh.raw_transaction
[0m08:20:12.661612 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_account
[0m08:20:12.662224 [info ] [Thread-1 (]: 6 of 10 START sql table model `bank_dwh`.`ods_dim_account` ..................... [RUN]
[0m08:20:12.662767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.raw_transaction, now model.bank_dwh.ods_dim_account)
[0m08:20:12.663131 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_account
[0m08:20:12.665153 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_account"
[0m08:20:12.666147 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_account
[0m08:20:12.675286 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

            

    
        create table `bank_dwh`.`ods_dim_account__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
          )
        
        ...
[0m08:20:12.680214 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.682183 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

    select name, type from system.columns where table = 'ods_dim_account__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.684145 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.685608 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_account"
[0m08:20:12.686600 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_account__dbt_backup`
        ("account_id", "account_number", "customer_id", "currency_code", "opened_at", "closed_at", "status", "daily_transfer_limit", "is_deleted", "loaded_at")

SELECT
    account_id,
    account_number,
    customer_id,
    currency_code,
    opened_at,
    closed_at,
    status,
    daily_transfer_limit,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_account`
  ...
[0m08:20:12.690098 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.691076 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_account__dbt_backup` AND `bank_dwh`.`ods_dim_account` 
  
  ...
[0m08:20:12.692269 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.696502 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_account: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_account"} */
drop table if exists `bank_dwh`.`ods_dim_account__dbt_backup` 
  ...
[0m08:20:12.697905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.699047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81210c10>]}
[0m08:20:12.699988 [info ] [Thread-1 (]: 6 of 10 OK created sql table model `bank_dwh`.`ods_dim_account` ................ [[32mOK[0m in 0.04s]
[0m08:20:12.700587 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_account
[0m08:20:12.700975 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_card
[0m08:20:12.701501 [info ] [Thread-1 (]: 7 of 10 START sql table model `bank_dwh`.`ods_dim_card` ........................ [RUN]
[0m08:20:12.701980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_account, now model.bank_dwh.ods_dim_card)
[0m08:20:12.702340 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_card
[0m08:20:12.704655 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_card"
[0m08:20:12.705824 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_card
[0m08:20:12.708486 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

            

    
        create table `bank_dwh`.`ods_dim_card__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
          )
        
        ...
[0m08:20:12.713684 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.717241 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

    select name, type from system.columns where table = 'ods_dim_card__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.719646 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.720913 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_card"
[0m08:20:12.721813 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_card__dbt_backup`
        ("card_id", "card_number", "account_id", "status", "opened_at", "closed_at", "is_deleted", "loaded_at")

SELECT
    card_id,
    card_number,
    account_id,
    status,
    opened_at,
    closed_at,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_card`
  ...
[0m08:20:12.725674 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.726551 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_card__dbt_backup` AND `bank_dwh`.`ods_dim_card` 
  
  ...
[0m08:20:12.727636 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.730234 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_card: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_card"} */
drop table if exists `bank_dwh`.`ods_dim_card__dbt_backup` 
  ...
[0m08:20:12.731305 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.732272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8114bc50>]}
[0m08:20:12.732821 [info ] [Thread-1 (]: 7 of 10 OK created sql table model `bank_dwh`.`ods_dim_card` ................... [[32mOK[0m in 0.03s]
[0m08:20:12.733682 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_card
[0m08:20:12.734077 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_customer
[0m08:20:12.734630 [info ] [Thread-1 (]: 8 of 10 START sql table model `bank_dwh`.`ods_dim_customer` .................... [RUN]
[0m08:20:12.735149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_card, now model.bank_dwh.ods_dim_customer)
[0m08:20:12.735600 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_customer
[0m08:20:12.737787 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_customer"
[0m08:20:12.738848 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_customer
[0m08:20:12.741168 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

            

    
        create table `bank_dwh`.`ods_dim_customer__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
          )
        
        ...
[0m08:20:12.745379 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.747366 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

    select name, type from system.columns where table = 'ods_dim_customer__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.749124 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.750508 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_customer"
[0m08:20:12.751666 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_customer__dbt_backup`
        ("customer_id", "customer_uuid", "full_name", "birth_date", "email", "phone", "city", "is_deleted", "loaded_at")

SELECT
    customer_id,
    customer_uuid,
    full_name,
    birth_date,
    email,
    phone,
    city,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_customer`
  ...
[0m08:20:12.755145 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.756007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_customer__dbt_backup` AND `bank_dwh`.`ods_dim_customer` 
  
  ...
[0m08:20:12.756949 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.759293 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_customer: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_customer"} */
drop table if exists `bank_dwh`.`ods_dim_customer__dbt_backup` 
  ...
[0m08:20:12.760369 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.761403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81360510>]}
[0m08:20:12.761948 [info ] [Thread-1 (]: 8 of 10 OK created sql table model `bank_dwh`.`ods_dim_customer` ............... [[32mOK[0m in 0.03s]
[0m08:20:12.762584 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_customer
[0m08:20:12.763097 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_dim_terminal
[0m08:20:12.763548 [info ] [Thread-1 (]: 9 of 10 START sql table model `bank_dwh`.`ods_dim_terminal` .................... [RUN]
[0m08:20:12.763999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_customer, now model.bank_dwh.ods_dim_terminal)
[0m08:20:12.764325 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_dim_terminal
[0m08:20:12.766382 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_dim_terminal"
[0m08:20:12.767267 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_dim_terminal
[0m08:20:12.770254 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

            

    
        create table `bank_dwh`.`ods_dim_terminal__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
          )
        
        ...
[0m08:20:12.776476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.779649 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

    select name, type from system.columns where table = 'ods_dim_terminal__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.782897 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.785390 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_dim_terminal"
[0m08:20:12.786466 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_dim_terminal__dbt_backup`
        ("terminal_id", "terminal_code", "city", "country", "latitude", "longitude", "is_working", "is_deleted", "loaded_at")

SELECT
    terminal_id,
    terminal_code,
    city,
    country,
    latitude,
    longitude,
    is_working,
    is_deleted,
    now() AS loaded_at
FROM `bank_dwh`.`raw_terminal`
  ...
[0m08:20:12.790480 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.791507 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
EXCHANGE TABLES `bank_dwh`.`ods_dim_terminal__dbt_backup` AND `bank_dwh`.`ods_dim_terminal` 
  
  ...
[0m08:20:12.792815 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.797640 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_dim_terminal: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_dim_terminal"} */
drop table if exists `bank_dwh`.`ods_dim_terminal__dbt_backup` 
  ...
[0m08:20:12.799348 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.800597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81177350>]}
[0m08:20:12.801339 [info ] [Thread-1 (]: 9 of 10 OK created sql table model `bank_dwh`.`ods_dim_terminal` ............... [[32mOK[0m in 0.04s]
[0m08:20:12.802028 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_dim_terminal
[0m08:20:12.802399 [debug] [Thread-1 (]: Began running node model.bank_dwh.ods_fact_atm_transaction
[0m08:20:12.802890 [info ] [Thread-1 (]: 10 of 10 START sql table model `bank_dwh`.`ods_fact_atm_transaction` ........... [RUN]
[0m08:20:12.803483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.bank_dwh.ods_dim_terminal, now model.bank_dwh.ods_fact_atm_transaction)
[0m08:20:12.803844 [debug] [Thread-1 (]: Began compiling node model.bank_dwh.ods_fact_atm_transaction
[0m08:20:12.806603 [debug] [Thread-1 (]: Writing injected SQL for node "model.bank_dwh.ods_fact_atm_transaction"
[0m08:20:12.807476 [debug] [Thread-1 (]: Began executing node model.bank_dwh.ods_fact_atm_transaction
[0m08:20:12.809713 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

            

    
        create table `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS replicated_deduplication_window='0'

                    
            empty
          as (
            

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
          )
        
        ...
[0m08:20:12.816055 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.818230 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

    select name, type from system.columns where table = 'ods_fact_atm_transaction__dbt_backup'
    
      
        and database = 'bank_dwh'
      
    
    order by position
  ...
[0m08:20:12.820810 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.822757 [debug] [Thread-1 (]: Writing runtime sql for node "model.bank_dwh.ods_fact_atm_transaction"
[0m08:20:12.823791 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */

  
    
    
    
        
         


        insert into `bank_dwh`.`ods_fact_atm_transaction__dbt_backup`
        ("txn_id", "txn_ts", "amount", "tx.currency_code", "card_dim.card_id", "card_number", "acc_dim.account_id", "account_number", "cust_dim.customer_id", "customer_city", "term_dim.terminal_id", "terminal_city", "txn_type", "tx.status", "loaded_at")

WITH tx AS (
    SELECT *
    FROM `bank_dwh`.`raw_transaction`
),

card_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_card`
),

acc_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_account`
),

cust_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_customer`
),

term_dim AS (
    SELECT *
    FROM `bank_dwh`.`raw_terminal`
)

SELECT
    tx.txn_id,
    tx.txn_ts,
    toFloat64(tx.amount)           AS amount,
    tx.currency_code,

    card_dim.card_id,
    card_dim.card_number,

    acc_dim.account_id,
    acc_dim.account_number,
    cust_dim.customer_id,
    cust_dim.city                  AS customer_city,

    term_dim.terminal_id,
    term_dim.city                  AS terminal_city,

    tx.txn_type,
    tx.status,

    now() AS loaded_at
FROM tx
LEFT JOIN card_dim
    ON card_dim.card_id = tx.card_id
LEFT JOIN acc_dim
    ON acc_dim.account_id = card_dim.account_id
LEFT JOIN cust_dim
    ON cust_dim.customer_id = acc_dim.customer_id
LEFT JOIN term_dim
    ON term_dim.terminal_id = tx.terminal_id
  ...
[0m08:20:12.830981 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:20:12.831943 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
EXCHANGE TABLES `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` AND `bank_dwh`.`ods_fact_atm_transaction` 
  
  ...
[0m08:20:12.833069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.835819 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.bank_dwh.ods_fact_atm_transaction: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "bank_clickhouse", "target_name": "dev", "node_id": "model.bank_dwh.ods_fact_atm_transaction"} */
drop table if exists `bank_dwh`.`ods_fact_atm_transaction__dbt_backup` 
  ...
[0m08:20:12.836957 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:20:12.838033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a530fb06-ba26-4d62-b7a5-e5609254106a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81177cd0>]}
[0m08:20:12.838556 [info ] [Thread-1 (]: 10 of 10 OK created sql table model `bank_dwh`.`ods_fact_atm_transaction` ...... [[32mOK[0m in 0.03s]
[0m08:20:12.839020 [debug] [Thread-1 (]: Finished running node model.bank_dwh.ods_fact_atm_transaction
[0m08:20:12.840134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:12.840437 [debug] [MainThread]: Connection 'model.bank_dwh.ods_fact_atm_transaction' was left open.
[0m08:20:12.840752 [debug] [MainThread]: On model.bank_dwh.ods_fact_atm_transaction: Close
[0m08:20:12.841215 [info ] [MainThread]: 
[0m08:20:12.841655 [info ] [MainThread]: Finished running 5 incremental models, 5 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m08:20:12.842802 [debug] [MainThread]: Command end result
[0m08:20:12.869174 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/target/manifest.json
[0m08:20:12.870910 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/target/semantic_manifest.json
[0m08:20:12.875425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/target/run_results.json
[0m08:20:12.875784 [info ] [MainThread]: 
[0m08:20:12.876237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:20:12.876765 [info ] [MainThread]: 
[0m08:20:12.877232 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m08:20:12.878281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2398434, "process_in_blocks": "0", "process_kernel_time": 0.275673, "process_mem_max_rss": "145864", "process_out_blocks": "2448", "process_user_time": 2.209414}
[0m08:20:12.878743 [debug] [MainThread]: Command `dbt run` succeeded at 08:20:12.878677 after 1.24 seconds
[0m08:20:12.879085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d76110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88aed810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b7b590>]}
[0m08:20:12.879418 [debug] [MainThread]: Flushing usage events
[0m08:20:13.603177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:40:08.263380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3ac5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0eb3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c5cd50>]}


============================== 08:40:08.268461 | 28eb1d74-ace0-4bda-9659-184d993efe74 ==============================
[0m08:40:08.268461 [info ] [MainThread]: Running with dbt=1.10.15
[0m08:40:08.269269 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt ls', 'no_print': 'None'}
[0m08:40:08.381492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28eb1d74-ace0-4bda-9659-184d993efe74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ee2bd0>]}
[0m08:40:08.416184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28eb1d74-ace0-4bda-9659-184d993efe74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cc7e50>]}
[0m08:40:08.416954 [info ] [MainThread]: Registered adapter: clickhouse=1.9.7
[0m08:40:08.459999 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m08:40:08.544654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m08:40:08.545305 [debug] [MainThread]: Partial parsing: added file: bank_dwh://models/raw/raw_transaction_cdc.sql
[0m08:40:08.545668 [debug] [MainThread]: Partial parsing: added file: bank_dwh://models/ods/ods_dim_card_scd2.sql
[0m08:40:08.546539 [debug] [MainThread]: Partial parsing: updated file: bank_dwh://models/sources.yml
[0m08:40:08.804645 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.bank_dwh.raw_transaction_cdc' (models/raw/raw_transaction_cdc.sql) depends on a source named 'bank_dwh.stg_cdc_transaction' which was not found
[0m08:40:08.805786 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": false, "command_wall_clock_time": 0.5765881, "process_in_blocks": "0", "process_kernel_time": 0.278679, "process_mem_max_rss": "116276", "process_out_blocks": "5", "process_user_time": 1.704152}
[0m08:40:08.807159 [debug] [MainThread]: Command `dbt ls` failed at 08:40:08.807057 after 0.58 seconds
[0m08:40:08.807566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5a369d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c7a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10bcbd0>]}
[0m08:40:08.807946 [debug] [MainThread]: Flushing usage events
[0m08:40:09.525796 [debug] [MainThread]: An error was encountered while trying to flush usage events
